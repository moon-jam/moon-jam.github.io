/**
* hexo-oembed
* https://github.com/hinastory/hexo-tag-slideshare.git
* Copyright (c) 2019, hinastory
* Licensed under the MIT license.
* Syntax:
* {% slideshare permlink %}
**/

'use strict';
const util = require('hexo-util');
const oembed = require('oembed');
const url = require('url');

hexo.extend.tag.register('slideShare', function(args) {
    return getSlideShareEmbed({url: args[0], maxwidth: args[1], maxheight: args[2]});
}, {async: true});


function getSlideShareEmbed(options) {
    return new Promise(function(resolve, reject) {
        oembed.fetch(options.url, { maxwidth: options.maxwidth }, function(error, result) {
            if (error) {
                console.error(error);
                resolve("");
            } else {
                console.log("oEmbed result", result);
                resolve(result.html);
            }
        });
    });
}

